<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>make sadservers happy again | Smiecjçš„å°çª</title><meta name="keywords" content="linux,æ“ä½œç³»ç»Ÿ,life"><meta name="author" content="smiecj,xxx@gmail.com"><meta name="copyright" content="smiecj"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="sadserver åˆ·é¢˜è®°å½•">
<meta property="og:type" content="article">
<meta property="og:title" content="make sadservers happy again">
<meta property="og:url" content="http://smiecj.github.io/2024/01/17/sadserver-intro/index.html">
<meta property="og:site_name" content="Smiecjçš„å°çª">
<meta property="og:description" content="sadserver åˆ·é¢˜è®°å½•">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://smiecj.github.io/2024/01/17/sadserver-intro/cover.png">
<meta property="article:published_time" content="2024-01-16T16:00:00.000Z">
<meta property="article:modified_time" content="2024-07-15T16:00:00.000Z">
<meta property="article:author" content="smiecj">
<meta property="article:tag" content="linux">
<meta property="article:tag" content="æ“ä½œç³»ç»Ÿ">
<meta property="article:tag" content="life">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://smiecj.github.io/2024/01/17/sadserver-intro/cover.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://smiecj.github.io/2024/01/17/sadserver-intro/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹ï¼š${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'make sadservers happy again',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-07-16 00:00:00'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
    const detectApple = () => {
      if (GLOBAL_CONFIG_SITE.isHome && /iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="Smiecjçš„å°çª" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://avatars.githubusercontent.com/u/14009307" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">44</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">40</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">28</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> æ–‡ç« </span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> åˆ†ç±»</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/2024/01/17/sadserver-intro/cover.png')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Smiecjçš„å°çª</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> æœç´¢</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> æ–‡ç« </span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> åˆ†ç±»</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">make sadservers happy again</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2024-01-16T16:00:00.000Z" title="å‘è¡¨äº 2024-01-17 00:00:00">2024-01-17</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2024-07-15T16:00:00.000Z" title="æ›´æ–°äº 2024-07-16 00:00:00">2024-07-16</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/">æ“ä½œç³»ç»Ÿ</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="make sadservers happy again"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»é‡:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/smiecj/p/18306958">æœ¬æ–‡ cnblog åšå®¢åœ°å€</a></p>
<h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h2><p>ä» <a target="_blank" rel="noopener" href="https://www.ruanyifeng.com/blog/2022/11/weekly-issue-230.html">é˜®ä¸€å³°è€å¸ˆçš„åšå®¢</a> äº†è§£åˆ° <a target="_blank" rel="noopener" href="https://sadservers.com/">sadserver</a> è¿™æ ·ä¸€ä¸ªå¯ä»¥æä¾› linux æœåŠ¡å™¨ï¼Œå¹¶å°è¯•è§£å†³ç³»ç»Ÿå’ŒæœåŠ¡ç›¸å…³é—®é¢˜çš„åœ¨çº¿æµ‹è¯•å¹³å°ã€‚éå¸¸éš¾å¾—çš„æ˜¯å®ƒå¯ä»¥ç›´æ¥æä¾›ä¸€ä¸ªå…¬ç½‘çš„linuxæœåŠ¡å™¨ï¼ˆä¸€èˆ¬40-60åˆ†é’Ÿåä¼šè‡ªåŠ¨é”€æ¯ï¼‰ï¼Œä½ å¯ä»¥åœ¨ä¸Šé¢åšä»»ä½•æ¢ç´¢ã€‚å¯¹äºæƒ³è¦å­¦ä¹ å¸¸ç”¨ linux æŒ‡ä»¤çš„åŒå­¦ï¼Œæ˜¯ä¸€ä¸ªéå¸¸ä¸é”™çš„ç»ƒæ‰‹å¹³å°</p>
<p>sadserver å¤§éƒ¨åˆ†é¢˜ç›®éƒ½æ˜¯å…è´¹çš„ï¼Œ46é“é¢˜ä¸­11é“éœ€è¦ä¼šå‘˜ï¼Œä¼šå‘˜ä¸€ä¸ªæœˆ5ç¾å…ƒã€‚å¯ä»¥åœ¨å®Œæˆå…¶ä»–é¢˜ç›®ä¹‹åå†å°å°æ°ªğŸ’°ä¸€ä¸‹æŒ‘æˆ˜å‰©ä¸‹çš„é¢˜ç›®</p>
<p>æœ¬æ–‡æ•´ç†äº†ç›®å‰sadserveræ‰€æœ‰é¢˜ç›®çš„åˆ†ç±»å’Œè§£é¢˜ç›¸å…³æŒ‡ä»¤ï¼Œå¸¦éƒ¨åˆ†â€œå‰§é€â€ï¼Œå»ºè®®å¯¹é¢˜ç›®æœ¬èº«æœ‰å¼ºçƒˆå…´è¶£çš„åŒå­¦ç›´æ¥åŠ¨æ‰‹å°è¯•</p>
<p>*æ¨è: æ ‡æ³¨æ¨èçš„ä¸»è¦æ˜¯å’Œ linux å¸¸ç”¨æŒ‡ä»¤ç›¸å…³çš„é¢˜ç›®ï¼Œå…¶ä»–å¼€æºæœåŠ¡ç›¸å…³çš„é¢˜ç›®å¯ä»¥é€‰æ‹©æ€§äº†è§£</p>
<p>*æé†’: éƒ¨åˆ†é¢˜ç›®éœ€è¦rootç”¨æˆ·æƒé™ï¼Œä»¥æ‰§è¡Œç³»ç»Ÿé…ç½®ä¿®æ”¹ç­‰ç›¸å…³æŒ‡ä»¤ï¼Œå¯é€šè¿‡<code>sudo su</code>æŒ‡ä»¤ææƒ</p>
<h2 id="é¢˜ç›®åˆ†ç±»"><a href="#é¢˜ç›®åˆ†ç±»" class="headerlink" title="é¢˜ç›®åˆ†ç±»"></a>é¢˜ç›®åˆ†ç±»</h2><table>
<thead>
<tr>
<th>é¢˜ç›®</th>
<th>ç±»å‹/ç›¸å…³æœåŠ¡</th>
<th>é¢˜ç›®/é—®é¢˜æ¦‚è¿°</th>
<th>ç›¸å…³æŒ‡ä»¤</th>
</tr>
</thead>
<tbody><tr>
<td>â€œSaint Johnâ€: what is writing to this log file?</td>
<td>linux</td>
<td>æŸ¥æ‰¾æ–‡ä»¶å ç”¨çš„è¿›ç¨‹</td>
<td>lsof, find</td>
</tr>
<tr>
<td><strong>â€œSaskatoonâ€: counting IPs. (æ¨è)</strong></td>
<td>linux</td>
<td>å­—ç¬¦ä¸²è®¡æ•°</td>
<td>awk, uniq, sort</td>
</tr>
<tr>
<td>â€œSantiagoâ€: Find the secret combination (æ¨è)</td>
<td>linux</td>
<td>æ–‡æœ¬å†…å®¹è¿‡æ»¤</td>
<td>grep</td>
</tr>
<tr>
<td><strong>â€œTaipeiâ€: Come a-knocking (æ¨è)</strong></td>
<td>linux</td>
<td>knock ç«¯å£å¼€æ”¾</td>
<td>knocked</td>
</tr>
<tr>
<td><strong>â€œLhasaâ€: Easy Math (æ¨è)</strong></td>
<td>linux</td>
<td>æ•°å€¼è®¡ç®—</td>
<td>bc</td>
</tr>
<tr>
<td>â€œBucharestâ€: Connecting to Postgres</td>
<td>postgresql</td>
<td>pgsqlé…ç½®ä¿®å¤</td>
<td></td>
</tr>
<tr>
<td>â€œBilbaoâ€: Basic Kubernetes Problems</td>
<td>kubernetes</td>
<td>æœåŠ¡é…ç½®ä¿®å¤</td>
<td>kubectl</td>
</tr>
<tr>
<td>â€œApiaâ€: Needle in a Haystack</td>
<td>linux</td>
<td>æ–‡æœ¬æ¯”è¾ƒ</td>
<td>diff</td>
</tr>
<tr>
<td>â€œManhattanâ€: canâ€™t write data into database.</td>
<td>postgresql</td>
<td>pgsql é…ç½®ä¿®å¤</td>
<td></td>
</tr>
<tr>
<td><strong>â€œTokyoâ€: canâ€™t serve web file (æ¨è)</strong></td>
<td>httpd, linux</td>
<td>httpd é…ç½®ä¿®å¤</td>
<td>iptables</td>
</tr>
<tr>
<td>â€œCape Townâ€: Borked Nginx</td>
<td>nginx</td>
<td>nginx é…ç½®ä¿®å¤</td>
<td>systemctl</td>
</tr>
<tr>
<td>â€œSaltaâ€: Docker container wonâ€™t start</td>
<td>Docker</td>
<td>å®¹å™¨å†…æœåŠ¡å¯åŠ¨é—®é¢˜</td>
<td>docker, netstat</td>
</tr>
<tr>
<td>â€œOaxacaâ€: Close an Open File</td>
<td>linux</td>
<td>æŸ¥æ‰¾æ–‡ä»¶å ç”¨çš„è¿›ç¨‹</td>
<td>lsof, exec</td>
</tr>
<tr>
<td>â€œMelbourneâ€: WSGI with Gunicorn</td>
<td>gunicorn</td>
<td>gunicorn é…ç½®ä¿®å¤</td>
<td></td>
</tr>
<tr>
<td>â€œLisbonâ€: etcd SSL cert troubles</td>
<td>etcd è®¿é—®ä¸é€š</td>
<td>etcd, iptables</td>
<td></td>
</tr>
<tr>
<td>â€œKiheiâ€: Surely Not Another Disk Space Scenario (æ¨è)</td>
<td>linux</td>
<td>æŒ‚ç›˜</td>
<td>pvcreate, vgcreate, lvcreate, mount</td>
</tr>
<tr>
<td>â€œUnimak Islandâ€: Fun with Mr Jason</td>
<td>linux</td>
<td>æ–‡æœ¬è§£æ</td>
<td>jq</td>
</tr>
<tr>
<td>â€œIvujivikâ€: Parlez-vous FranÃ§ais?</td>
<td>python</td>
<td>excel è§£æ</td>
<td>python</td>
</tr>
<tr>
<td>â€œParisâ€: Where is my webserver?</td>
<td>linux</td>
<td>http æ¥å£è°ƒç”¨å’Œå‚æ•°</td>
<td>curl</td>
</tr>
<tr>
<td>â€œBuenos Airesâ€: Kubernetes Pod Crashing</td>
<td>kubernetes</td>
<td>kubernetes æƒé™ä½“ç³»</td>
<td>kubectl</td>
</tr>
<tr>
<td>â€œTarifaâ€: Between Two Seas</td>
<td>nginx</td>
<td>nginx é…ç½®ä¿®å¤</td>
<td>docker</td>
</tr>
<tr>
<td><strong>â€œMarrakechâ€: Word Histogram (æ¨è)</strong></td>
<td>sqlite</td>
<td>æ–‡æœ¬è§£æ</td>
<td>sqlite</td>
</tr>
<tr>
<td>â€œRosarioâ€: Restore a MySQL database</td>
<td>mysql</td>
<td>mysql æ•…éšœæ¢å¤</td>
<td>mysql</td>
</tr>
<tr>
<td>â€œAbaokoroâ€: Restore MySQL Databases Spooked by a Ghost</td>
<td>mysql</td>
<td>mysql æ•°æ®å¯¼å…¥</td>
<td>mysql</td>
</tr>
<tr>
<td>â€œPoznaÅ„â€: Helm Chart Issue in Kubernetes</td>
<td>kubernetes</td>
<td>helm åŸºæœ¬ä½¿ç”¨</td>
<td>helm</td>
</tr>
<tr>
<td>â€œManadoâ€: How much do you press?</td>
<td>linux</td>
<td>è§£å‹ç¼©å¸¸ç”¨æŒ‡ä»¤çš„ä½¿ç”¨</td>
<td>zip, tar, xz</td>
</tr>
<tr>
<td>â€œWarsawâ€: Prometheus canâ€™t scrape the webserver</td>
<td>linux</td>
<td>go æœåŠ¡é—®é¢˜ä¿®å¤</td>
<td>docker</td>
</tr>
<tr>
<td>â€œMoyogalpaâ€: Security Snag. The Trials of Mary and John</td>
<td>linux</td>
<td>æœåŠ¡æ–‡ä»¶æƒé™å’Œé˜²ç«å¢™è®¾ç½®</td>
<td>apparmor, systemctl, update-ca-certificates</td>
</tr>
<tr>
<td>â€œHelsingÃ¸râ€: The first walls of postgres physical replication</td>
<td>postgresql</td>
<td>postgresql åŒæ­¥ä¸»åº“ç›¸å…³é…ç½®ä¿®å¤</td>
<td>docker</td>
</tr>
<tr>
<td>â€œBekasiâ€: Supervisor is still around</td>
<td>wsgi</td>
<td>wsgi å¯åŠ¨é…ç½®ä¿®å¤</td>
<td>curl, supervisorctl</td>
</tr>
<tr>
<td>â€œDepokâ€: Nginx with Brotli</td>
<td>nginx</td>
<td>nginx æ’ä»¶å®‰è£…</td>
<td>cmake, make, systemctl</td>
</tr>
<tr>
<td>â€œTukaaniâ€: XZ LZMA Library Compromised</td>
<td>linux</td>
<td>preload åº“é—®é¢˜ä¿®å¤</td>
<td>lsof</td>
</tr>
<tr>
<td>â€œJakartaâ€: itâ€™s always DNS.</td>
<td>linux</td>
<td>DNS è§£æé…ç½®ä¿®å¤</td>
<td></td>
</tr>
<tr>
<td>â€œBernâ€: Docker web container canâ€™t connect to db container.</td>
<td>wordpress</td>
<td>é€šè¿‡ docker å¯åŠ¨ wordpress</td>
<td>docker</td>
</tr>
<tr>
<td><strong>â€œKarakorumâ€: WTFIT â€“ What The Fun Is This? (æ¨è)</strong></td>
<td>linux</td>
<td>å®šä½ç³»ç»Ÿå’Œè¿›ç¨‹å¯åŠ¨é—®é¢˜</td>
<td>perl, strace, python</td>
</tr>
<tr>
<td>â€œSingaraâ€: Docker and Kubernetes web app not working.</td>
<td>kubernetes</td>
<td>é•œåƒé‡å»ºå’Œæäº¤</td>
<td>docker, kubectl</td>
</tr>
<tr>
<td>â€œHong-Kongâ€: canâ€™t write data into database.</td>
<td>postgresql</td>
<td>postgresql é…ç½®é—®é¢˜ä¿®å¤</td>
<td>postgres, systemctl</td>
</tr>
<tr>
<td><strong>â€œPokharaâ€: SSH and other sshenanigans (æ¨è)</strong></td>
<td>linux</td>
<td>ssh å’Œ su é—®é¢˜è§£å†³</td>
<td>ssh, su, chage, ssh-keygen</td>
</tr>
<tr>
<td>â€œRoseauâ€: Hack a Web Server</td>
<td>linux</td>
<td>john æš´åŠ›ç ´è§£å·¥å…·çš„ä½¿ç”¨</td>
<td>john</td>
</tr>
<tr>
<td>â€œBelo-Horizonteâ€: A Java Enigma</td>
<td>linux</td>
<td>java ç¨‹åºæ‰§è¡Œé—®é¢˜è§£å†³</td>
<td>java, javap, free, fallocate, mkswap, swapon</td>
</tr>
<tr>
<td>â€œChennaiâ€: Pull a Rabbit from a Hat</td>
<td>rabbitmq</td>
<td>rabbitmq æµ‹è¯•ç”Ÿäº§æ¶ˆè´¹</td>
<td>docker, python</td>
</tr>
<tr>
<td>â€œMonacoâ€: Disappearing Trick</td>
<td>linux</td>
<td>gitå’Œè¿›ç¨‹ç¯å¢ƒå˜é‡</td>
<td>git</td>
</tr>
<tr>
<td>â€œFlorenceâ€: Database Migration Hell</td>
<td>å¾®æœåŠ¡</td>
<td>js+webåå°+pgsqlé—®é¢˜è§£å†³</td>
<td>docker, sed</td>
</tr>
</tbody></table>
<h2 id="å¦‚ä½•è§£é¢˜"><a href="#å¦‚ä½•è§£é¢˜" class="headerlink" title="å¦‚ä½•è§£é¢˜"></a>å¦‚ä½•è§£é¢˜</h2><p><img src="/2024/01/17/sadserver-intro/01.png" alt="æ‰“å¼€é¢˜ç›®"></p>
<p><img src="/2024/01/17/sadserver-intro/02.png" alt="é¢˜ç›®ç¤ºä¾‹"></p>
<p><img src="/2024/01/17/sadserver-intro/03.png" alt="æ£€æŸ¥æˆåŠŸç»“æœ"></p>
<h2 id="Level-ç®€å•"><a href="#Level-ç®€å•" class="headerlink" title="Level: ç®€å•"></a>Level: ç®€å•</h2><h3 id="ã€linuxã€‘â€œSaint-Johnâ€-what-is-writing-to-this-log-file"><a href="#ã€linuxã€‘â€œSaint-Johnâ€-what-is-writing-to-this-log-file" class="headerlink" title="ã€linuxã€‘â€œSaint Johnâ€: what is writing to this log file?"></a>ã€linuxã€‘<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/saint-john">â€œSaint Johnâ€: what is writing to this log file?</a></h3><p><img src="/2024/01/17/sadserver-intro/04.png" alt="é¢˜ç›®"></p>
<h4 id="é¢˜æ„"><a href="#é¢˜æ„" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h4><p>æœåŠ¡å™¨ä¸Šæœ‰ä¸€ä¸ªæ—¥å¿—æ–‡ä»¶åœ¨è¢«ä¸€ä¸ªè¿›ç¨‹å ç”¨ï¼Œéœ€è¦æ‰¾åˆ°è¿™ä¸ªè¿›ç¨‹å¹¶åœæ­¢</p>
<h4 id="ç›¸å…³æŒ‡ä»¤"><a href="#ç›¸å…³æŒ‡ä»¤" class="headerlink" title="ç›¸å…³æŒ‡ä»¤"></a>ç›¸å…³æŒ‡ä»¤</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹æ–‡ä»¶å ç”¨è¿›ç¨‹ id</span></span><br><span class="line">lsof /var/log/bad.log</span><br><span class="line">ls -l /proc/*/fd/* | grep bad.log</span><br><span class="line">fuser /var/log/bad.log</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> ç¡®è®¤æ–‡ä»¶æ˜¯å¦æœ€è¿‘æœªæ›´æ–°</span></span><br><span class="line">find /var/log/bad.log -mmin -0.1</span><br></pre></td></tr></table></figure>

<h3 id="ã€æ¨èã€‘ã€linuxã€‘â€œSaskatoonâ€-counting-IPs"><a href="#ã€æ¨èã€‘ã€linuxã€‘â€œSaskatoonâ€-counting-IPs" class="headerlink" title="ã€æ¨èã€‘ã€linuxã€‘â€œSaskatoonâ€: counting IPs."></a>ã€æ¨èã€‘ã€linuxã€‘<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/saskatoon">â€œSaskatoonâ€: counting IPs.</a></h3><p><img src="/2024/01/17/sadserver-intro/05.png" alt="é¢˜ç›®"></p>
<h4 id="é¢˜æ„-1"><a href="#é¢˜æ„-1" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h4><p>/home/admin/access.log æ˜¯ä¸€ä¸ª web æœåŠ¡çš„è®¿é—®è®°å½•æ—¥å¿—ï¼ˆå¦‚ nginx çš„è®¿é—®æ—¥å¿—å°±åœ¨ access.log ä¸­ï¼‰ï¼Œä»ä¸­ç»Ÿè®¡å‡ºè®¿é—®æ¬¡æ•°æœ€å¤šçš„æºip</p>
<h4 id="ç›¸å…³æŒ‡ä»¤-1"><a href="#ç›¸å…³æŒ‡ä»¤-1" class="headerlink" title="ç›¸å…³æŒ‡ä»¤"></a>ç›¸å…³æŒ‡ä»¤</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> æˆªå–ip</span></span><br><span class="line">cat /home/admin/access.log | awk &#x27;&#123;print $1&#125;&#x27; &gt; /tmp/access_ips.log</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æ’åº</span></span><br><span class="line">cat /tmp/access_ips.log | sort &gt; /tmp/sort_ips.log</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> è®¡æ•° &amp; å†æ’åº</span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># uniq: ç»Ÿè®¡å‡ºç°æ¬¡æ•°</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># sort: -n: æŒ‰æ•°å€¼æ’åºè€Œä¸æ˜¯å­—ç¬¦ä¸²åº; -r: é€†åº</span></span></span><br><span class="line">cat /tmp/sort_ips.log | uniq -c | sort -nr &gt; /tmp/count_ips.log</span><br></pre></td></tr></table></figure>

<h3 id="ã€æ¨èã€‘ã€linuxã€‘â€œSantiagoâ€-Find-the-secret-combination"><a href="#ã€æ¨èã€‘ã€linuxã€‘â€œSantiagoâ€-Find-the-secret-combination" class="headerlink" title="ã€æ¨èã€‘ã€linuxã€‘â€œSantiagoâ€: Find the secret combination"></a>ã€æ¨èã€‘ã€linuxã€‘<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/santiago">â€œSantiagoâ€: Find the secret combination</a></h3><p><img src="/2024/01/17/sadserver-intro/06.png" alt="é¢˜ç›®"></p>
<h4 id="é¢˜æ„-2"><a href="#é¢˜æ„-2" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h4><p>ç»Ÿè®¡ç‰¹å®šå­—ç¬¦ä¸²åœ¨æ¯ä¸ªæ–‡ä»¶ä¸­çš„å‡ºç°æ¬¡æ•°ï¼Œå¹¶å¯¼å‡ºåªå‡ºç°ä¸€æ¬¡çš„æ–‡ä»¶ï¼Œå‡ºç°ä½ç½®çš„ä¸‹ä¸€è¡Œå†…å®¹</p>
<h4 id="ç›¸å…³æŒ‡ä»¤-2"><a href="#ç›¸å…³æŒ‡ä»¤-2" class="headerlink" title="ç›¸å…³æŒ‡ä»¤"></a>ç›¸å…³æŒ‡ä»¤</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥æ‰¾æ–‡ä»¶å†…å®¹ &amp; ç»Ÿè®¡æ•°é‡</span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># æ³¨æ„: é¢˜ç›®è¦æ±‚æ˜¯å­—ç¬¦ä¸²å‡ºç°æ¬¡æ•°ï¼Œå¦‚æœæ˜¯ç»Ÿè®¡è¯è¯­å¯åœ¨ grep ä¹‹ååŠ ä¸Š -w å‚æ•°</span></span></span><br><span class="line">find /home/admin -name &quot;*.txt&quot; | xargs grep -c &#x27;Alice&#x27;</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> è¾“å‡ºä¹‹åä¸€è¡Œï¼ˆå‰ä¸€è¡Œæ˜¯-Bï¼‰ï¼Œä¸”è¿‡æ»¤å‡ºæ•°å­—éƒ¨åˆ†</span></span><br><span class="line">grep &quot;Alice&quot; -A1 /home/admin/1342-0.txt | grep -oE &quot;[0-9]+&quot;</span><br></pre></td></tr></table></figure>

<h3 id="The-Command-Line-Murders"><a href="#The-Command-Line-Murders" class="headerlink" title="The Command Line Murders"></a><a target="_blank" rel="noopener" href="https://sadservers.com/scenario/command-line-murders">The Command Line Murders</a></h3><p>æœ¬é¢˜æ›´åƒæ˜¯è§£å¯†æ¸¸æˆï¼Œè€Œä¸æ˜¯è§£å†³æœåŠ¡å™¨é—®é¢˜ï¼Œå› æ­¤ç¬”è€…é€‰æ‹©ï¼ˆå·æ‡’ï¼‰è·³è¿‡äº†è¿™é¢˜ï¼Œå–œæ¬¢è¯»è§£å¯†ç±»å°è¯´çš„å¯ä»¥è¯•ä¸€ä¸‹</p>
<h3 id="ã€æ¨èã€‘ã€linuxã€‘â€œTaipeiâ€-Come-a-knocking"><a href="#ã€æ¨èã€‘ã€linuxã€‘â€œTaipeiâ€-Come-a-knocking" class="headerlink" title="ã€æ¨èã€‘ã€linuxã€‘â€œTaipeiâ€: Come a-knocking"></a>ã€æ¨èã€‘ã€linuxã€‘<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/taipei">â€œTaipeiâ€: Come a-knocking</a></h3><p><img src="/2024/01/17/sadserver-intro/07.png" alt="é¢˜ç›®"></p>
<h4 id="é¢˜æ„-3"><a href="#é¢˜æ„-3" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h4><p>æœ¬æœº 80 ç«¯å£å¯åŠ¨äº† http æœåŠ¡ï¼Œä½†ç«¯å£è¢« knockd è¿›ç¨‹é™åˆ¶è®¿é—®ï¼Œæ— æ³•ç›´æ¥è®¿é—®</p>
<p>éœ€è¦é€šè¿‡ knock å¯¹æ‰€æœ‰ç«¯å£è¿›è¡Œâ€œå¼€é—¨â€ï¼Œä½¿å¾— 80 ç«¯å£æ”¾å¼€</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/f-carey/p/16066178.html">å‚è€ƒ-knockï¼šç«¯å£æ•²é—¨æœåŠ¡</a></p>
<h4 id="ç›¸å…³æŒ‡ä»¤-3"><a href="#ç›¸å…³æŒ‡ä»¤-3" class="headerlink" title="ç›¸å…³æŒ‡ä»¤"></a>ç›¸å…³æŒ‡ä»¤</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> å¯¹ 1000 åˆ° 65535 çš„æ‰€æœ‰ç«¯å£å‘é€ knock è¯·æ±‚ï¼ˆ å‘é€ SYN ï¼‰</span></span><br><span class="line">for port in &#123;1000..65535&#125;</span><br><span class="line">do</span><br><span class="line">	knock localhost $&#123;port&#125;</span><br><span class="line">done</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æ‰«ææœ¬åœ°å¸¸è§æœåŠ¡ç«¯å£ï¼ˆ å‘é€ SYN ï¼‰</span></span><br><span class="line">nmap -p- localhost</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹ nmap æ‰«æçš„ç«¯å£èŒƒå›´</span></span><br><span class="line">nmap -v -oG - | grep &quot;Ports scanned&quot;</span><br></pre></td></tr></table></figure>

<h3 id="ã€æ¨èã€‘ã€linuxã€‘â€œLhasaâ€-Easy-Math"><a href="#ã€æ¨èã€‘ã€linuxã€‘â€œLhasaâ€-Easy-Math" class="headerlink" title="ã€æ¨èã€‘ã€linuxã€‘â€œLhasaâ€: Easy Math"></a>ã€æ¨èã€‘ã€linuxã€‘<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/lhasa">â€œLhasaâ€: Easy Math</a></h3><p><img src="/2024/01/17/sadserver-intro/08.png" alt="é¢˜ç›®"></p>
<h4 id="é¢˜æ„-4"><a href="#é¢˜æ„-4" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h4><p>å°†ä¸€ä¸ªæ–‡æœ¬ä¸­çš„ç¬¬äºŒåˆ—æ•°å­—æ±‚å’Œä»¥åŠæ±‚å¹³å‡</p>
<p>linux æœ¬èº«çš„è¿ç®—ç¬¦æ”¯æŒæ•´æ•°è¿ç®—ï¼Œå› æ­¤èŠ‚ç‚¹è¿˜æä¾›äº† python3 å’Œ bc</p>
<h4 id="ç›¸å…³æŒ‡ä»¤-4"><a href="#ç›¸å…³æŒ‡ä»¤-4" class="headerlink" title="ç›¸å…³æŒ‡ä»¤"></a>ç›¸å…³æŒ‡ä»¤</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> è·å–ç¬¬äºŒåˆ—</span></span><br><span class="line">sum_expr=`awk &#x27;&#123;print $2&#125;&#x27; /home/admin/scores.txt </span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> å°†æ–‡æœ¬çš„æ¯ä¸€è¡Œæ‹¼æ¥åˆ°åŒä¸€è¡Œï¼Œå¹¶ç”¨åŠ å·åˆ†éš”</span></span><br><span class="line">paste -sd+ test.txt</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> è®¡ç®—æ•°å­¦è¡¨è¾¾å¼</span></span><br><span class="line">sum=`echo $&#123;expr&#125; | bc`</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æ–‡æœ¬è¡Œæ•°</span></span><br><span class="line">count=`cat scores.txt | wc -l`</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> ä¿ç•™ä¸¤ä½å°æ•°ï¼Œè®¡ç®—ä¸¤æ•°ç›¸é™¤</span></span><br><span class="line">echo &quot;scale=2; $&#123;sum&#125; / $&#123;count&#125;&quot; | bc</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># python3 test.py</span></span><br><span class="line"><span class="built_in">sum</span> = <span class="number">0</span></span><br><span class="line">num = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">score_file = <span class="string">&#x27;/home/admin/scores.txt&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(score_file, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> scores_file:</span><br><span class="line">    lines = data = scores_file.read().splitlines()</span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> lines:</span><br><span class="line">        score = line.split(<span class="string">&quot; &quot;</span>)[<span class="number">1</span>]</span><br><span class="line">        <span class="built_in">sum</span> += <span class="built_in">float</span>(score)</span><br><span class="line">        num += <span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;%.2f&quot;</span> % (<span class="built_in">sum</span> / num))</span><br></pre></td></tr></table></figure>

<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// go run test.go</span></span><br><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;bufio&quot;</span></span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;os&quot;</span></span><br><span class="line">	<span class="string">&quot;strconv&quot;</span></span><br><span class="line">	<span class="string">&quot;strings&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	scoreFile, _ := os.Open(<span class="string">&quot;/root/scores.txt&quot;</span>)</span><br><span class="line">	<span class="keyword">defer</span> scoreFile.Close()</span><br><span class="line"></span><br><span class="line">	scanner := bufio.NewScanner(scoreFile)</span><br><span class="line">	scoreCount := <span class="number">0</span></span><br><span class="line">	scoreSum := <span class="number">0.0</span></span><br><span class="line">	<span class="keyword">for</span> scanner.Scan() &#123;</span><br><span class="line">		scoreStr := strings.Split(scanner.Text(), <span class="string">&quot; &quot;</span>)[<span class="number">1</span>]</span><br><span class="line">		scoreFloat, _ := strconv.ParseFloat(scoreStr, <span class="number">32</span>)</span><br><span class="line">		scoreSum += scoreFloat</span><br><span class="line">		scoreCount++</span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Printf(<span class="string">&quot;%.2f\n&quot;</span>, <span class="keyword">float32</span>(scoreSum)/<span class="keyword">float32</span>(scoreCount))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ã€postgresqlã€‘â€œBucharestâ€-Connecting-to-Postgres"><a href="#ã€postgresqlã€‘â€œBucharestâ€-Connecting-to-Postgres" class="headerlink" title="ã€postgresqlã€‘â€œBucharestâ€: Connecting to Postgres"></a>ã€postgresqlã€‘<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/bucharest">â€œBucharestâ€: Connecting to Postgres</a></h3><p><img src="/2024/01/17/sadserver-intro/09.png" alt="é¢˜ç›®"></p>
<h4 id="é¢˜æ„-5"><a href="#é¢˜æ„-5" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h4><p>æœ¬æœºå¯åŠ¨äº† postgresql æœåŠ¡ï¼Œä½†å› ä¸ºé…ç½®é—®é¢˜è¿æ¥å¤±è´¥ã€‚éœ€è¦ä¿®å¤ pgsql é…ç½®å¹¶é‡å¯</p>
<h4 id="ç›¸å…³æŒ‡ä»¤-5"><a href="#ç›¸å…³æŒ‡ä»¤-5" class="headerlink" title="ç›¸å…³æŒ‡ä»¤"></a>ç›¸å…³æŒ‡ä»¤</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> æŒ‡å®šå¯†ç ã€ç”¨æˆ·å’Œ db è¿æ¥ pgsql</span></span><br><span class="line">PGPASSWORD=app1user psql -h 127.0.0.1 -d app1 -U app1user -c &#x27;\q&#x27;</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹ pgsql è¿›ç¨‹å’Œå¯åŠ¨å‚æ•° (-e: æŸ¥çœ‹æ‰€æœ‰è¿›ç¨‹ï¼Œ-f: åˆ—ä¸¾æ‰€æœ‰è¿›ç¨‹ä¿¡æ¯)</span></span><br><span class="line">ps -ef | grep pgsql</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹ pgsql æœåŠ¡åŸºç¡€é…ç½®æ–‡ä»¶</span></span><br><span class="line">vim /etc/postgresql/13/main/postgresql.conf</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹ pgsql ç™»å½•èº«ä»½å’Œå…è®¸è®¿é—®æºåœ°å€çš„é…ç½®æ–‡ä»¶</span></span><br><span class="line">vim /etc/postgresql/13/main/pg_hba.conf</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> é‡å¯ pgsql</span></span><br><span class="line">systemctl restart postgresql</span><br></pre></td></tr></table></figure>

<h3 id="ã€kubernetesã€‘â€œBilbaoâ€-Basic-Kubernetes-Problems"><a href="#ã€kubernetesã€‘â€œBilbaoâ€-Basic-Kubernetes-Problems" class="headerlink" title="ã€kubernetesã€‘â€œBilbaoâ€: Basic Kubernetes Problems"></a>ã€kubernetesã€‘<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/bilbao">â€œBilbaoâ€: Basic Kubernetes Problems</a></h3><p><img src="/2024/01/17/sadserver-intro/10.png" alt="é¢˜ç›®"></p>
<h4 id="é¢˜æ„-6"><a href="#é¢˜æ„-6" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h4><p>manifest.yaml ä¸­å®šä¹‰äº† nginx serviceï¼Œä½†å¯åŠ¨å¤±è´¥äº†ï¼Œéœ€è¦é€šè¿‡ pod çš„å¯åŠ¨ä¿¡æ¯å»è§£å†³</p>
<h4 id="ç›¸å…³æŒ‡ä»¤-6"><a href="#ç›¸å…³æŒ‡ä»¤-6" class="headerlink" title="ç›¸å…³æŒ‡ä»¤"></a>ç›¸å…³æŒ‡ä»¤</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> æ£€æŸ¥æŒ‡ä»¤:</span> </span><br><span class="line">curl 10.43.216.196</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹ nginx pod çŠ¶æ€</span></span><br><span class="line">kubectl get pods</span><br><span class="line">kubectl describe pod nginx-deployment-67699598cc-zrj6f</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> è§£å†³ 1 node(s) didn<span class="string">&#x27;t match Pod&#x27;</span>s node affinity/selector ...</span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># node æ·»åŠ  label</span></span></span><br><span class="line">kubectl label nodes node1 disk=ssd</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># åˆ é™¤ pod ï¼ˆè§¦å‘é‡å»ºï¼‰</span></span></span><br><span class="line">kubectl delete pod nginx-deployment-67699598cc-zrj6f</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> è§£å†³ 1 Insufficient memory</span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># å‡å°‘ nginx ç”³è¯·çš„å†…å­˜èµ„æº</span></span></span><br><span class="line">sed -i &quot;s/memory:.*/memory: 500Mi/g&quot; manifest.yml</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># é‡è½½ manifest.yml</span></span></span><br><span class="line">kubectl apply -f manifest.yml</span><br></pre></td></tr></table></figure>

<!--
## æŸ¥çœ‹
kubectl get nodes -o json | jq '.items[].spec'

## ç§»é™¤
kubectl taint nodes --all node.kubernetes.io/unreachable:NoSchedule-

kubectl taint nodes i-02f8e6680f7d5e616 node.kubernetes.io/unreachable:NoSchedule-

kubectl taint nodes i-02f8e6680f7d5e616 node.kubernetes.io/unreachable:NoExecute-
-->

<h3 id="ã€linuxã€‘â€œApiaâ€-Needle-in-a-Haystack"><a href="#ã€linuxã€‘â€œApiaâ€-Needle-in-a-Haystack" class="headerlink" title="ã€linuxã€‘â€œApiaâ€: Needle in a Haystack"></a>ã€linuxã€‘<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/apia">â€œApiaâ€: Needle in a Haystack</a></h3><p><img src="/2024/01/17/sadserver-intro/11.png" alt="é¢˜ç›®"></p>
<h4 id="é¢˜æ„-7"><a href="#é¢˜æ„-7" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h4><p>åœ¨ /home/admin/data ç›®å½•ä¸‹æœ‰å¾ˆå¤š txt æ–‡ä»¶ï¼Œå…¶ä¸­ä¸€ä¸ªå’Œå…¶ä»–æ–‡ä»¶å†…å®¹ä¸ä¸€æ ·ï¼Œè€Œä¸”åªæ˜¯åœ¨ä¸€ä¸ªæ®µè½ä¸­å¤šäº†ä¸€ä¸ªå•è¯ï¼Œæ‰¾åˆ°è¿™ä¸ªå•è¯</p>
<h4 id="ç›¸å…³æŒ‡ä»¤-7"><a href="#ç›¸å…³æŒ‡ä»¤-7" class="headerlink" title="ç›¸å…³æŒ‡ä»¤"></a>ç›¸å…³æŒ‡ä»¤</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> è¾“å‡ºæ–‡æœ¬çš„ md5 å€¼</span></span><br><span class="line">md5sum  /home/admin/data/file1.txt</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> å¯¹æ¯”ä¸¤ä¸ªæ–‡æœ¬å·®å¼‚ï¼ˆæ®µè½çº§åˆ«ï¼‰</span></span><br><span class="line">diff /home/admin/data/file1.txt /home/admin/data/file2.txt</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> å¯¹æ¯”ä¸¤ä¸ªæ–‡æœ¬å·®å¼‚ï¼ˆå•è¯çº§åˆ«ï¼‰</span></span><br><span class="line">wdiff /home/admin/data/file1.txt /home/admin/data/file2.txt</span><br></pre></td></tr></table></figure>

<h2 id="ä¸­ç­‰"><a href="#ä¸­ç­‰" class="headerlink" title="ä¸­ç­‰"></a>ä¸­ç­‰</h2><h3 id="ã€postgresqlã€‘â€œManhattanâ€-canâ€™t-write-data-into-database"><a href="#ã€postgresqlã€‘â€œManhattanâ€-canâ€™t-write-data-into-database" class="headerlink" title="ã€postgresqlã€‘â€œManhattanâ€: canâ€™t write data into database."></a>ã€postgresqlã€‘<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/manhattan">â€œManhattanâ€: canâ€™t write data into database.</a></h3><p><img src="/2024/01/17/sadserver-intro/12.png" alt="é¢˜ç›®"></p>
<h4 id="é¢˜æ„-8"><a href="#é¢˜æ„-8" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h4><p>æœ¬æœºå¯åŠ¨äº† postgresql æœåŠ¡ï¼Œä½†æ‰§è¡Œ insert ä¼šå¤±è´¥ï¼Œæ‰¾åˆ°åŸå› å¹¶è§£å†³</p>
<h4 id="ç›¸å…³æŒ‡ä»¤-8"><a href="#ç›¸å…³æŒ‡ä»¤-8" class="headerlink" title="ç›¸å…³æŒ‡ä»¤"></a>ç›¸å…³æŒ‡ä»¤</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹ postgresql æ—¥å¿—</span></span><br><span class="line">tail -f /var/log/postgresql/postgresql-14-main.log</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> é‡å¯ postgresql</span></span><br><span class="line">systemctl restart postgresql</span><br></pre></td></tr></table></figure>

<h3 id="ã€æ¨èã€‘ã€httpdã€linuxã€‘â€œTokyoâ€-canâ€™t-serve-web-file"><a href="#ã€æ¨èã€‘ã€httpdã€linuxã€‘â€œTokyoâ€-canâ€™t-serve-web-file" class="headerlink" title="ã€æ¨èã€‘ã€httpdã€linuxã€‘â€œTokyoâ€: canâ€™t serve web file"></a>ã€æ¨èã€‘ã€httpdã€linuxã€‘<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/tokyo">â€œTokyoâ€: canâ€™t serve web file</a></h3><p><img src="/2024/01/17/sadserver-intro/13.png" alt="é¢˜ç›®"></p>
<h4 id="é¢˜æ„-9"><a href="#é¢˜æ„-9" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h4><p>æœ¬æœºå¯åŠ¨äº† apache2ï¼ˆå³ <a target="_blank" rel="noopener" href="https://askubuntu.com/a/248412">httpd</a>ï¼‰ æœåŠ¡ï¼Œä½†æ‰§è¡Œ curl 127.0.0.1:80 æ²¡æœ‰ä»»ä½•è¿”å›ï¼Œç¡®è®¤å…·ä½“åŸå› </p>
<h4 id="ç›¸å…³æŒ‡ä»¤-9"><a href="#ç›¸å…³æŒ‡ä»¤-9" class="headerlink" title="ç›¸å…³æŒ‡ä»¤"></a>ç›¸å…³æŒ‡ä»¤</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹é˜²ç«å¢™è§„åˆ™åˆ—è¡¨</span></span><br><span class="line">iptables -L --line-numbers</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> åˆ é™¤æŒ‡å®šè§„åˆ™</span></span><br><span class="line">iptables -t filter --delete INPUT 1</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æ¸…ç©ºæ‰€æœ‰é˜²ç«å¢™è§„åˆ™</span></span><br><span class="line">iptables -F</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> ç»™æ–‡ä»¶æ·»åŠ æ‰€æœ‰ç”¨æˆ·å¯è¯»æƒé™</span></span><br><span class="line">chmod +r /var/www/html/index.html</span><br></pre></td></tr></table></figure>

<h3 id="ã€nginxã€‘â€œCape-Townâ€-Borked-Nginx"><a href="#ã€nginxã€‘â€œCape-Townâ€-Borked-Nginx" class="headerlink" title="ã€nginxã€‘â€œCape Townâ€: Borked Nginx"></a>ã€nginxã€‘<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/capetown">â€œCape Townâ€: Borked Nginx</a></h3><p><img src="/2024/01/17/sadserver-intro/14.png" alt="é¢˜ç›®"></p>
<h4 id="é¢˜æ„-10"><a href="#é¢˜æ„-10" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h4><p>æœ¬æœºå®‰è£…äº† nginx ä½†æ— æ³•å¯åŠ¨ï¼Œæ£€æŸ¥å¯åŠ¨å¤±è´¥åŸå› ï¼Œä¿®å¤å¹¶å¯åŠ¨</p>
<h4 id="ç›¸å…³æŒ‡ä»¤-10"><a href="#ç›¸å…³æŒ‡ä»¤-10" class="headerlink" title="ç›¸å…³æŒ‡ä»¤"></a>ç›¸å…³æŒ‡ä»¤</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> é‡å¯ nginx æœåŠ¡</span></span><br><span class="line">systemctl restart nginx</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹ nginx å¯åŠ¨æ—¥å¿—</span></span><br><span class="line">journalctl -u nginx</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹ nginx å¯åŠ¨é”™è¯¯æ—¥å¿—</span></span><br><span class="line">tail -f /var/log/nginx/error.log</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹ nginx é…ç½®</span></span><br><span class="line">/etc/nginx/nginx.conf</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹ nginx systemd æœåŠ¡ç®¡ç†é…ç½®</span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># å…³é”®é…ç½®: LimitNOFILE</span></span></span><br><span class="line">vim /etc/systemd/system/nginx.service</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> é‡æ–°åŠ è½½é…ç½®å¹¶é‡å¯ nginx</span></span><br><span class="line">systemctl daemon-reload</span><br><span class="line">systemctl restart nginx</span><br></pre></td></tr></table></figure>

<h3 id="ã€dockerã€‘â€œSaltaâ€-Docker-container-wonâ€™t-start"><a href="#ã€dockerã€‘â€œSaltaâ€-Docker-container-wonâ€™t-start" class="headerlink" title="ã€dockerã€‘â€œSaltaâ€: Docker container wonâ€™t start."></a>ã€dockerã€‘<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/salta">â€œSaltaâ€: Docker container wonâ€™t start.</a></h3><p><img src="/2024/01/17/sadserver-intro/15.png" alt="é¢˜ç›®"></p>
<h4 id="é¢˜æ„-11"><a href="#é¢˜æ„-11" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h4><p>æœ¬æœº /home/admin/app ç›®å½•ä¸‹æœ‰ä¸€ä¸ªæ”¯æŒå®¹å™¨åŒ–çš„ node åº”ç”¨ï¼Œå¹¶æä¾› Dockerfile å¯ä»¥ç›´æ¥æ„å»º<br>æœåŠ¡ä¸»é€»è¾‘åœ¨ server.js ä¸­<br>éœ€è¦æ„å»ºé•œåƒåï¼Œå¯åŠ¨è¯¥æœåŠ¡ï¼Œå¹¶è§£å†³è°ƒç”¨è¯¥æœåŠ¡æ¥å£é‡åˆ°çš„é—®é¢˜</p>
<h4 id="ç›¸å…³æŒ‡ä»¤-11"><a href="#ç›¸å…³æŒ‡ä»¤-11" class="headerlink" title="ç›¸å…³æŒ‡ä»¤"></a>ç›¸å…³æŒ‡ä»¤</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> æ„å»ºé•œåƒ</span></span><br><span class="line">docker build -t app .</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> å¯åŠ¨</span></span><br><span class="line">docker run -d --name app -p 8888:8888 app</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æ£€æŸ¥ç«¯å£å ç”¨</span></span><br><span class="line">netstat -tunlp | grep 8888</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹å®¹å™¨æ—¥å¿—</span></span><br><span class="line">docker logs dd231758183e</span><br></pre></td></tr></table></figure>

<h3 id="ã€linuxã€‘â€œOaxacaâ€-Close-an-Open-File"><a href="#ã€linuxã€‘â€œOaxacaâ€-Close-an-Open-File" class="headerlink" title="ã€linuxã€‘â€œOaxacaâ€: Close an Open File"></a>ã€linuxã€‘<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/oaxaca">â€œOaxacaâ€: Close an Open File</a></h3><p><img src="/2024/01/17/sadserver-intro/16.png" alt="é¢˜ç›®"></p>
<h4 id="é¢˜æ„-12"><a href="#é¢˜æ„-12" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h4><p>/home/admin/somefile æ­£åœ¨è¢«ä¸€ä¸ªè¿›ç¨‹å ç”¨ï¼Œæ‰¾åˆ°å ç”¨åŸå› ï¼Œå¹¶ä½¿å¾—ä¸‹æ¬¡ç™»å½•ç»ˆç«¯åï¼Œè¯¥æ–‡ä»¶ä¸ä¼šå†è¢«è¿›ç¨‹å ç”¨</p>
<p>ç›¸å…³çŸ¥è¯†ç‚¹: <a target="_blank" rel="noopener" href="https://www.geeksforgeeks.org/exec-command-in-linux-with-examples/">exec æŒ‡ä»¤</a></p>
<h4 id="ç›¸å…³æŒ‡ä»¤-12"><a href="#ç›¸å…³æŒ‡ä»¤-12" class="headerlink" title="ç›¸å…³æŒ‡ä»¤"></a>ç›¸å…³æŒ‡ä»¤</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> æ‰¾åˆ°å ç”¨æ–‡ä»¶çš„è¿›ç¨‹ ï¼Œå¹¶ç›´æ¥ <span class="built_in">kill</span></span></span><br><span class="line">lsof /home/admin/somefile | tail -2 | awk &#x27;&#123;print $2&#125;&#x27; | xargs kill -9</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> ä¸€ä¸ªä¼šå¯¼è‡´ /tmp/test.txt è¢«bashè¿›ç¨‹å ç”¨çš„æŒ‡ä»¤</span></span><br><span class="line">exec 77&gt; /tmp/test.txt</span><br></pre></td></tr></table></figure>

<h3 id="ã€nginxã€gunicornã€‘â€œMelbourneâ€-WSGI-with-Gunicorn"><a href="#ã€nginxã€gunicornã€‘â€œMelbourneâ€-WSGI-with-Gunicorn" class="headerlink" title="ã€nginxã€gunicornã€‘â€œMelbourneâ€: WSGI with Gunicorn"></a>ã€nginxã€gunicornã€‘<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/melbourne">â€œMelbourneâ€: WSGI with Gunicorn</a></h3><p><img src="/2024/01/17/sadserver-intro/17.png" alt="é¢˜ç›®"></p>
<h4 id="é¢˜æ„-13"><a href="#é¢˜æ„-13" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h4><p>æœ¬æœºè¿è¡Œäº† nginx å’Œ <a target="_blank" rel="noopener" href="https://docs.gunicorn.org/en/latest/install.html">gunicorn</a>ï¼ˆå®ç°äº† WSGI åè®®çš„ HTTP æœåŠ¡å™¨ï¼Œmaster-worker æ¶æ„ï¼‰</p>
<p>æ­£å¸¸æƒ…å†µä¸‹ï¼Œé€šè¿‡ curl è°ƒç”¨æœåŠ¡çš„è°ƒç”¨é“¾: curl -&gt; nginx -&gt; gunicorn -&gt; wesi.pyï¼Œå…¶ä¸­ /home/admin/wesi.py ä¸­å®šä¹‰äº†æ¥å£çš„å“åº”æ–¹å¼ä¸ºè¿”å›200çŠ¶æ€ç å’Œå­—ç¬¦ä¸²â€Hello Worldâ€</p>
<p>ä½†æ˜¯é€šè¿‡ curl -i <a target="_blank" rel="noopener" href="http://localhost/">http://localhost</a> è°ƒç”¨æ¥å£å¤±è´¥äº†ï¼Œæ‰¾åˆ°åŸå› å¹¶é€šè¿‡ä¿®æ”¹é…ç½®è§£å†³</p>
<p>ç›¸å…³æ•™ç¨‹: <a target="_blank" rel="noopener" href="https://docs.gunicorn.org/en/latest/deploy.html">Deploying Gunicorn</a><br>ç›¸å…³çŸ¥è¯†ç‚¹: <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Length">http header: content-length</a></p>
<h4 id="ç›¸å…³æŒ‡ä»¤-13"><a href="#ç›¸å…³æŒ‡ä»¤-13" class="headerlink" title="ç›¸å…³æŒ‡ä»¤"></a>ç›¸å…³æŒ‡ä»¤</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹ nginx é”™è¯¯æ—¥å¿—</span></span><br><span class="line">tail -f /var/log/nginx/error.log</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥æ‰¾ nginx é…ç½®ç›®å½•ä¸‹å¸¦æœ‰æŒ‡å®šå…³é”®å­—çš„é…ç½®æ–‡ä»¶</span></span><br><span class="line">find /etc/nginx -name &#x27;*&#x27; -type f | xargs grep &quot;gunicorn&quot;</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> é‡å¯ nginx</span></span><br><span class="line">systemctl restart nginx</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹ gunicorn é…ç½®</span></span><br><span class="line">vim /etc/systemd/system/gunicorn.service</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹ wsgi æœåŠ¡é…ç½®</span></span><br><span class="line">vim /home/admin/wsgi.py</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> é‡å¯ gunicorn</span></span><br><span class="line">systemctl restart gunicorn</span><br></pre></td></tr></table></figure>

<!--
[WSGI](https://zh.wikipedia.org/zh-cn/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BD%91%E5%85%B3%E6%8E%A5%E5%8F%A3): Web Server Gateway Interface, ä¸ºPythonè¯­è¨€å®šä¹‰çš„WebæœåŠ¡å™¨å’ŒWebåº”ç”¨ç¨‹åºæˆ–æ¡†æ¶ä¹‹é—´çš„ä¸€ç§ç®€å•è€Œé€šç”¨çš„æ¥å£

[gunicorn](https://docs.gunicorn.org/en/stable/): åŸºäº WSGI å®ç°çš„httpæœåŠ¡å™¨ï¼Œç±»ä¼¼ httpd
-->

<h3 id="ã€etcdã€linuxã€‘â€œLisbonâ€-etcd-SSL-cert-troubles"><a href="#ã€etcdã€linuxã€‘â€œLisbonâ€-etcd-SSL-cert-troubles" class="headerlink" title="ã€etcdã€linuxã€‘â€œLisbonâ€: etcd SSL cert troubles"></a>ã€etcdã€linuxã€‘<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/lisbon">â€œLisbonâ€: etcd SSL cert troubles</a></h3><p><img src="/2024/01/17/sadserver-intro/18.png" alt="é¢˜ç›®"></p>
<h4 id="é¢˜æ„-14"><a href="#é¢˜æ„-14" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h4><p>æœ¬æœºéƒ¨ç½²äº† etcd æœåŠ¡ï¼Œæ­£å¸¸æƒ…å†µä¸‹å¯é€šè¿‡ <code>etcdctl get foo</code> æˆ– <code>curl -i https://localhost:2379/v2/keys/foo</code> è·å–é…ç½®ï¼Œä½†ç›®å‰è®¿é—®å¤±è´¥ï¼Œéœ€è¦è§£å†³</p>
<h4 id="ç›¸å…³æŒ‡ä»¤-14"><a href="#ç›¸å…³æŒ‡ä»¤-14" class="headerlink" title="ç›¸å…³æŒ‡ä»¤"></a>ç›¸å…³æŒ‡ä»¤</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> é€šè¿‡ etcdctl è·å–é…ç½®</span></span><br><span class="line">etcdctl get foo</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> è®¾ç½®ç³»ç»Ÿæ—¶é—´</span></span><br><span class="line">date -s &#x27;2023-01-29 00:00:00&#x27;</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> è°ƒç”¨etcdæ¥å£</span></span><br><span class="line">curl -ik https://localhost:2379/v2/keys/foo</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹é˜²ç«å¢™NATç±»å‹çš„é…ç½®</span></span><br><span class="line">iptables -t nat -L</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æ¸…ç©ºNATç±»å‹é˜²ç«å¢™è§„åˆ™</span></span><br><span class="line">iptables -t nat -F</span><br></pre></td></tr></table></figure>

<h3 id="ã€æ¨èã€‘ã€linuxã€‘â€œKiheiâ€-Surely-Not-Another-Disk-Space-Scenario"><a href="#ã€æ¨èã€‘ã€linuxã€‘â€œKiheiâ€-Surely-Not-Another-Disk-Space-Scenario" class="headerlink" title="ã€æ¨èã€‘ã€linuxã€‘â€œKiheiâ€: Surely Not Another Disk Space Scenario"></a>ã€æ¨èã€‘ã€linuxã€‘<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/kihei">â€œKiheiâ€: Surely Not Another Disk Space Scenario</a></h3><p><img src="/2024/01/17/sadserver-intro/19.png" alt="é¢˜ç›®"></p>
<h4 id="é¢˜æ„-15"><a href="#é¢˜æ„-15" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h4><p>å½“å‰è·¯å¾„çš„ kihei ç¨‹åºä¼šåœ¨ /home/admin/data ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ª 1.5Gå¤§å°çš„æ–‡ä»¶ï¼Œä½†å› ä¸ºç£ç›˜ç©ºé—´ä¸è¶³ï¼Œæ‰§è¡Œå¤±è´¥äº†ï¼Œéœ€è¦åœ¨ä¸åˆ é™¤å…¶ä»–æ–‡ä»¶çš„æƒ…å†µä¸‹ä½¿å¾— kihei èƒ½å¤Ÿæ­£å¸¸æ‰§è¡Œ</p>
<h4 id="ç›¸å…³æŒ‡ä»¤-15"><a href="#ç›¸å…³æŒ‡ä»¤-15" class="headerlink" title="ç›¸å…³æŒ‡ä»¤"></a>ç›¸å…³æŒ‡ä»¤</h4><p>æœ¬é¢˜æ˜¯éå¸¸å®Œæ•´çš„ç£ç›˜æŒ‚è½½ç»ƒæ‰‹å¥½é¢˜ï¼Œå¯ä»¥ç»“åˆæŒ‚ç›˜ç›¸å…³çš„æŒ‡ä»¤ä¸€èµ·ç†è§£</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/MssGuo/article/details/120473476">å‚è€ƒ: lvcreate åˆ›å»ºé€»è¾‘å·ã€vgcreate åˆ›å»ºå·ç»„ã€pvcreate åˆ›å»ºç‰©ç†å·ã€vgextend æ‰©å®¹å·ç»„ã€lvç¼©å®¹</a></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹ kihei è¿›ç¨‹çš„è¯¦ç»†æ—¥å¿—</span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># æ³¨æ„: è¿™é‡Œçš„ kihei å¯æ‰§è¡Œæ–‡ä»¶å¹¶ä¸æ˜¯æ¥è‡ªå¼€æºé¡¹ç›®...</span></span></span><br><span class="line">./kihei -v</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹æœ¬åœ°ç£ç›˜ä½¿ç”¨æƒ…å†µå’Œå‰©ä½™ç©ºé—´</span></span><br><span class="line">df -h</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹æ‰€æœ‰ç£ç›˜</span></span><br><span class="line">lsblk</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> åˆ›å»ºç‰©ç†å·</span></span><br><span class="line">pvcreate /dev/nvme1n1</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹æ‰€æœ‰ç‰©ç†å·</span></span><br><span class="line">pvs</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> åˆ›å»ºå·ç»„</span></span><br><span class="line">vgcreate vg1 /dev/nvme1n1 /dev/nvme2n1</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹æ‰€æœ‰å·ç»„</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> åˆ›å»ºé€»è¾‘å·</span></span><br><span class="line">lvcreate -n lv1 -l 100%FREE vg1</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹é€»è¾‘å·</span></span><br><span class="line">lvs</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æ ¼å¼åŒ–å·ï¼Œåˆå§‹åŒ–æ–‡ä»¶ç³»ç»Ÿ</span></span><br><span class="line">mkfs -t ext4 /dev/vg1/lv1</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> å·æŒ‚è½½ï¼Œå¹¶è®¾ç½®ç›®å½•æƒé™</span></span><br><span class="line">mount /dev/vg1/lv1 /home/admin/data</span><br><span class="line">chown -R admin:root /home/admin/data</span><br></pre></td></tr></table></figure>

<h3 id="ã€linuxã€‘â€œUnimak-Islandâ€-Fun-with-Mr-Jason"><a href="#ã€linuxã€‘â€œUnimak-Islandâ€-Fun-with-Mr-Jason" class="headerlink" title="ã€linuxã€‘â€œUnimak Islandâ€: Fun with Mr Jason"></a>ã€linuxã€‘<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/unimak">â€œUnimak Islandâ€: Fun with Mr Jason</a></h3><p><img src="/2024/01/17/sadserver-intro/20.png" alt="é¢˜ç›®"></p>
<h4 id="é¢˜æ„-16"><a href="#é¢˜æ„-16" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h4><p>station_information.json ä¸­åŒ…å«è‹¥å¹²ä¸ªå•è½¦ç§Ÿèµç«™çš„ä¿¡æ¯ï¼Œç­›é€‰å…¶ä¸­ æ²¡æœ‰è‡ªåŠ¨æœåŠ¡æœºï¼ˆhas_kiosk=falseï¼‰ä¸”å‰©ä½™å•è½¦è¶…è¿‡30è¾†ï¼ˆcapacity&gt;30ï¼‰çš„ç§Ÿèµç«™ï¼Œå°†å®ƒçš„idï¼ˆstation_idï¼‰å†™å…¥ç­”æ¡ˆæ–‡ä»¶ä¸­</p>
<h4 id="ç›¸å…³æŒ‡ä»¤-16"><a href="#ç›¸å…³æŒ‡ä»¤-16" class="headerlink" title="ç›¸å…³æŒ‡ä»¤"></a>ç›¸å…³æŒ‡ä»¤</h4><p>è™½ç„¶é¢˜ç›®æç¤ºæœ¬æœºæœ‰ <a target="_blank" rel="noopener" href="https://github.com/jqlang/jq">jq</a> ã€ <a target="_blank" rel="noopener" href="https://github.com/tomnomnom/gron">gron</a> å’Œ <a target="_blank" rel="noopener" href="https://github.com/simeji/jid">jid</a> ç­‰å·¥å…·ï¼Œä½†åä¸¤è€…æ“ä½œèµ·æ¥éƒ½ä¸å¦‚åŒæ—¶åŒ…å«è§£æå’Œç­›é€‰å™¨çš„ jq æ–¹ä¾¿ï¼Œè¿™é‡Œç›´æ¥å±•ç¤º jq çš„å‡ ä¸ªåŸºæœ¬æŒ‡ä»¤ï¼Œç»„åˆå‡ ä¸ª filter ï¼Œå°±å¯ä»¥è§£ç­”æœ¬é¢˜äº†</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> è·å–æ•°ç»„é•¿åº¦</span></span><br><span class="line">echo &quot;[1,2,3,4,5]&quot; | jq length</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> è¿‡æ»¤å™¨</span></span><br><span class="line">echo &#x27;&#123;&quot;dates&quot;:[&#123;&quot;day&quot;:&quot;monday&quot;,&quot;emotion&quot;:&quot;happy&quot;&#125;,&#123;&quot;day&quot;:&quot;tuesday&quot;,&quot;emotion&quot;:&quot;crazy&quot;&#125;]&#125;&#x27; | jq -r &#x27;.dates[] | select(.emotion==&quot;happy&quot;)&#x27;</span><br></pre></td></tr></table></figure>

<h3 id="ã€pythonã€goã€‘â€œIvujivikâ€-Parlez-vous-Francais"><a href="#ã€pythonã€goã€‘â€œIvujivikâ€-Parlez-vous-Francais" class="headerlink" title="ã€pythonã€goã€‘â€œIvujivikâ€: Parlez-vous FranÃ§ais?"></a>ã€pythonã€goã€‘<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/ivujivik">â€œIvujivikâ€: Parlez-vous FranÃ§ais?</a></h3><p><img src="/2024/01/17/sadserver-intro/21.png" alt="é¢˜ç›®"></p>
<h4 id="é¢˜æ„-17"><a href="#é¢˜æ„-17" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h4><p>table_tableau11.csv æ–‡ä»¶ä¸­è®°å½•äº†æ€»ç»Ÿé€‰ä¸¾ä¸­ï¼Œå„ä¸ªé€‰åŒºçš„æŠ•ç¥¨æƒ…å†µä¿¡æ¯ï¼Œéœ€è¦æŒ‰é¢˜ç›®çš„ç­›é€‰æ¡ä»¶å¾—åˆ°å¯¹åº”çš„é€‰åŒºåç§°</p>
<p>çœä»½,é€‰åŒºåç§°,é€‰åŒºç¼–å·,äººå£,é€‰æ°‘,æŠ•ç¥¨ç«™,æœ‰æ•ˆé€‰ç¥¨,æœ‰æ•ˆé€‰ç¥¨ç™¾åˆ†æ¯”,è¢«æ‹’ç»çš„é€‰ç¥¨ è¢«æ‹’ç»çš„é€‰ç¥¨,è¢«æ‹’ç»çš„é€‰ç¥¨ç™¾åˆ†æ¯”,æ€»æŠ•ç¥¨æ•°,é€‰æ°‘æŠ•ç¥¨ç‡,å½“é€‰å€™é€‰äºº</p>
<h4 id="ç›¸å…³æŒ‡ä»¤-17"><a href="#ç›¸å…³æŒ‡ä»¤-17" class="headerlink" title="ç›¸å…³æŒ‡ä»¤"></a>ç›¸å…³æŒ‡ä»¤</h4><p>æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿé€šè¿‡å„ä¸ªè¯­è¨€/å·¥å…·è§£æ csv çš„æ–¹æ³•ï¼Œè¿™é‡Œå±•ç¤º python å’Œ go çš„è§£ç­”æ–¹å¼</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># pandas</span></span><br><span class="line"><span class="keyword">import</span> csv</span><br><span class="line">max_reject = <span class="number">0</span></span><br><span class="line">answer = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;table_tableau11.csv&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    reader = csv.reader(f)</span><br><span class="line">    <span class="built_in">next</span>(reader) <span class="comment"># skip first line</span></span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> reader:</span><br><span class="line">        current_reject = <span class="built_in">int</span>(<span class="built_in">float</span>(row[<span class="number">8</span>]))</span><br><span class="line">        current_population = <span class="built_in">int</span>(row[<span class="number">3</span>])</span><br><span class="line">        <span class="keyword">if</span> current_reject &gt; max_reject:</span><br><span class="line">            max_reject = current_reject</span><br><span class="line">            <span class="keyword">if</span> current_population &lt; <span class="number">100000</span>:</span><br><span class="line">                answer = row[<span class="number">1</span>]</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;mysolution&#x27;</span>, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(<span class="string">f&quot;<span class="subst">&#123;answer&#125;</span>\n&quot;</span>)</span><br><span class="line">    f.close()</span><br></pre></td></tr></table></figure>


<figure class="highlight golang"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;encoding/csv&quot;</span></span><br><span class="line">	<span class="string">&quot;os&quot;</span></span><br><span class="line">	<span class="string">&quot;io/ioutil&quot;</span></span><br><span class="line">	<span class="string">&quot;strconv&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	f, _ := os.Open(<span class="string">&quot;table_tableau11.csv&quot;</span>)</span><br><span class="line"></span><br><span class="line">	csvReader := csv.NewReader(f)</span><br><span class="line">	csvReader.FieldsPerRecord = <span class="number">-1</span> <span class="comment">// ignore fields per record</span></span><br><span class="line">	records, _ := csvReader.ReadAll()</span><br><span class="line"></span><br><span class="line">	answer := <span class="string">&quot;&quot;</span></span><br><span class="line">	maxReject := <span class="number">0</span></span><br><span class="line">	<span class="keyword">for</span> _, currentRecord := <span class="keyword">range</span> records[<span class="number">1</span>:] &#123;</span><br><span class="line">			currentReject, _ := strconv.Atoi(currentRecord[<span class="number">8</span>])</span><br><span class="line">			currentPopulation, _ := strconv.Atoi(currentRecord[<span class="number">3</span>])</span><br><span class="line">			<span class="keyword">if</span> currentReject &gt; maxReject &#123;</span><br><span class="line">					maxReject = currentReject</span><br><span class="line">					<span class="keyword">if</span> currentPopulation &lt; <span class="number">100000</span> &#123;</span><br><span class="line">							answer = currentRecord[<span class="number">1</span>]</span><br><span class="line">					&#125;</span><br><span class="line">			&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	ioutil.WriteFile(<span class="string">&quot;mysolution&quot;</span>, []<span class="keyword">byte</span>(answer + <span class="string">&quot;\n&quot;</span>), <span class="number">0644</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ã€linuxã€‘â€œParisâ€-Where-is-my-webserver"><a href="#ã€linuxã€‘â€œParisâ€-Where-is-my-webserver" class="headerlink" title="ã€linuxã€‘â€œParisâ€: Where is my webserver?"></a>ã€linuxã€‘<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/paris">â€œParisâ€: Where is my webserver?</a></h3><p><img src="/2024/01/17/sadserver-intro/22.png" alt="é¢˜ç›®"></p>
<h4 id="é¢˜æ„-18"><a href="#é¢˜æ„-18" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h4><p>æœ¬é¢˜æ²¡æœ‰æç¤ºåº”è¯¥æ¯”è¾ƒéš¾åšå‡ºæ¥ï¼Œå› ä¸ºé—®é¢˜ç›¸å…³çš„ä»£ç ç”šè‡³éƒ½çœ‹ä¸åˆ°ï¼Œæ‰€ä»¥ä¸æ˜¯å¾ˆæ¨èï¼Œä¸»è¦è€ƒå¯Ÿå¯¹ user-agent header çš„äº†è§£</p>
<p><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/User-Agent">user-agent</a>: è¡¨ç¤ºå®¢æˆ·ç«¯ç±»å‹ï¼Œé»˜è®¤ä¸ºç©ºï¼Œæµè§ˆå™¨è®¿é—®æ—¶å°†ä¼šè‡ªåŠ¨å¡«å……</p>
<p>è¿™é‡Œè®¿é—® 5000 ç«¯å£å¯åŠ¨çš„æœåŠ¡ç«¯ä¼šå¯¹ user-agent è¿›è¡Œæ ¡éªŒï¼Œå¦‚æœä¸ºç©ºå°†ä¸ä¼šè¿”å›æ•°æ®ï¼Œéœ€è¦æŒ‡å®šä»»æ„çš„ user-agent å†è°ƒç”¨ 5000 ç«¯å£ï¼Œæ‹¿åˆ°ç­”æ¡ˆéœ€è¦çš„å¯†ç </p>
<h4 id="ç›¸å…³æŒ‡ä»¤-18"><a href="#ç›¸å…³æŒ‡ä»¤-18" class="headerlink" title="ç›¸å…³æŒ‡ä»¤"></a>ç›¸å…³æŒ‡ä»¤</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> æ·»åŠ  user-agent è°ƒç”¨æ¥å£</span></span><br><span class="line">curl --user-agent &quot;hhh&quot; http://localhost:5000</span><br><span class="line">curl -H &#x27;User-Agent: hhh&#x27; http://localhost:5000</span><br><span class="line">curl -A &#x27;hhh&#x27; http://localhost:5000</span><br></pre></td></tr></table></figure>


<h3 id="ã€kubernetesã€‘â€œBuenos-Airesâ€-Kubernetes-Pod-Crashing"><a href="#ã€kubernetesã€‘â€œBuenos-Airesâ€-Kubernetes-Pod-Crashing" class="headerlink" title="ã€kubernetesã€‘â€œBuenos Airesâ€: Kubernetes Pod Crashing"></a>ã€kubernetesã€‘<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/buenos-aires">â€œBuenos Airesâ€: Kubernetes Pod Crashing</a></h3><p><img src="/2024/01/17/sadserver-intro/23.png" alt="é¢˜ç›®"></p>
<h4 id="é¢˜æ„-19"><a href="#é¢˜æ„-19" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h4><p>æœ¬æœºéƒ¨ç½²äº† k8s ï¼Œå…¶ä¸­åä¸º logshipper çš„ pod å¯åŠ¨å¤±è´¥äº†ï¼Œéœ€è¦ç¡®è®¤å¤±è´¥åŸå› </p>
<p>æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ k8s çš„ clusterrole å¯¹åº”çš„æƒé™ç±»å‹</p>
<h4 id="ç›¸å…³æŒ‡ä»¤-19"><a href="#ç›¸å…³æŒ‡ä»¤-19" class="headerlink" title="ç›¸å…³æŒ‡ä»¤"></a>ç›¸å…³æŒ‡ä»¤</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹æ‰€æœ‰ pod çš„ label</span></span><br><span class="line">kubectl get pod --show-labels</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹æŒ‡å®š label å¯¹åº”çš„ pod ä¿¡æ¯å’ŒçŠ¶æ€</span></span><br><span class="line">kubectl describe pod -l app=logshipper</span><br><span class="line">kubectl describe pod logshipper-597f84bf4f-6ssjq</span><br><span class="line">kubectl describe deployment logshipper</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹ pod æ—¥å¿—ï¼ˆæç¤ºæƒé™ä¸è¶³ï¼‰</span></span><br><span class="line">kubectl logs logshipper-597f84bf4f-6ssjq --follow</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹ logshipper pod ç»‘å®šçš„ serviceAccount å¯¹åº”çš„ rolebinding å’Œ clusterrolebinding</span></span><br><span class="line">kubectl get rolebinding,clusterrolebinding --all-namespaces -o jsonpath=&#x27;&#123;range .items[?(@.subjects[0].name==&quot;logshipper-sa&quot;)]&#125;[&#123;.roleRef.kind&#125;,&#123;.roleRef.name&#125;]&#123;end&#125;&#x27;</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹æŒ‡å®š clusterrole</span></span><br><span class="line">kubectl describe ClusterRole logshipper-cluster-role</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> ç¼–è¾‘ clusterrole æƒé™</span></span><br><span class="line">kubectl edit ClusterRole logshipper-cluster-role</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> åˆ é™¤ï¼ˆè§¦å‘è‡ªåŠ¨æ‹‰èµ·æ–°çš„podï¼‰</span></span><br><span class="line">kubectl delete pod logshipper-597f84bf4f-6ssjq</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> è·å–æœåŠ¡çŠ¶æ€</span></span><br><span class="line">kubectl get pods -l app=logshipper --no-headers -o json | jq -r &#x27;.items[] | &quot;\(.status.containerStatuses[0].ready)&quot;&#x27;</span><br></pre></td></tr></table></figure>

<h3 id="ã€haproxyã€dockerã€‘â€œTarifaâ€-Between-Two-Seas"><a href="#ã€haproxyã€dockerã€‘â€œTarifaâ€-Between-Two-Seas" class="headerlink" title="ã€haproxyã€dockerã€‘â€œTarifaâ€: Between Two Seas"></a>ã€haproxyã€dockerã€‘<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/tarifa">â€œTarifaâ€: Between Two Seas</a></h3><p><img src="/2024/01/17/sadserver-intro/24.png" alt="é¢˜ç›®"></p>
<h4 id="é¢˜æ„-20"><a href="#é¢˜æ„-20" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h4><p>æœ¬æœºé€šè¿‡ docker compose å¯åŠ¨äº†ä¸€ä¸ª haproxy å’Œä¸¤ä¸ª nginxã€‚å› ä¸º haproxy çš„é…ç½®ï¼ˆhaproxy.cfgï¼‰ç­–ç•¥æ˜¯å¯¹ä¸¤ä¸ª nginx èŠ‚ç‚¹è¿›è¡Œè½®è¯¢ï¼ˆroundrobinï¼‰è®¿é—®ï¼Œå› æ­¤æ­£å¸¸æƒ…å†µä¸‹ï¼Œè°ƒç”¨ localhost:5000 ä¼šä¾æ¬¡è¿”å›  â€œnginx_0â€ å’Œ â€œnginx_1â€<br>ä½†ç›®å‰è°ƒç”¨åªè¿”å›äº† â€œnginx_0â€ï¼Œéœ€è¦æ‰¾åˆ°åŸå› </p>
<h4 id="ç›¸å…³æŒ‡ä»¤-20"><a href="#ç›¸å…³æŒ‡ä»¤-20" class="headerlink" title="ç›¸å…³æŒ‡ä»¤"></a>ç›¸å…³æŒ‡ä»¤</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> è°ƒç”¨ haproxy</span></span><br><span class="line">curl localhost:5000</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹ haproxy pod æ—¥å¿—</span></span><br><span class="line">docker logs c79c9eb25143</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹ haproxy é…ç½®</span></span><br><span class="line">vim haproxy.cfg</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹ nginx é…ç½®</span></span><br><span class="line">vim custom-nginx_0.conf</span><br><span class="line">vim custom-nginx_1.conf</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹ docker compose æœåŠ¡å®šä¹‰</span></span><br><span class="line">vim docker-compose.yml</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> é‡å¯ docker-compose æœåŠ¡ç»„</span></span><br><span class="line">docker compose down</span><br><span class="line">docker compose up -d</span><br></pre></td></tr></table></figure>

<h3 id="ã€æ¨èã€‘ã€sqliteã€‘â€œMarrakechâ€-Word-Histogram"><a href="#ã€æ¨èã€‘ã€sqliteã€‘â€œMarrakechâ€-Word-Histogram" class="headerlink" title="ã€æ¨èã€‘ã€sqliteã€‘â€œMarrakechâ€: Word Histogram"></a>ã€æ¨èã€‘ã€sqliteã€‘<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/marrakech">â€œMarrakechâ€: Word Histogram</a></h3><p><img src="/2024/01/17/sadserver-intro/25.png" alt="é¢˜ç›®"></p>
<h4 id="é¢˜æ„-21"><a href="#é¢˜æ„-21" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h4><p>frankestein.txt æ–‡æœ¬ä¸­æœ‰ä¸€æ®µæ–‡ç« ï¼Œæ‰¾åˆ°å…¶ä¸­å‡ºç°æ¬¡æ•°æ’ç¬¬äºŒå¤šçš„å•è¯<br>å¸¸è§çš„å•è¯åˆ†éš”ç¬¦ä¸º: .,:; ï¼Œä¸”å•è¯éœ€å¿½ç•¥å¤§å°å†™</p>
<h4 id="ç›¸å…³æŒ‡ä»¤-21"><a href="#ç›¸å…³æŒ‡ä»¤-21" class="headerlink" title="ç›¸å…³æŒ‡ä»¤"></a>ç›¸å…³æŒ‡ä»¤</h4><p>è¿™é‡Œé€šè¿‡ sqlite3 æ¥è§£å†³æœ¬é¢˜</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> æ‰€æœ‰å•è¯åˆ†éš”åï¼Œè½¬æˆå…¨å¤§å†™å¹¶æŒ‰æ¢è¡Œç¬¦åˆ†éš”å†™å…¥æ–°æ–‡ä»¶</span></span><br><span class="line">cat frankestein.txt | tr &#x27;.&#x27; &#x27;\n&#x27; | tr &#x27;,&#x27; &#x27;\n&#x27; | tr &#x27;:&#x27; &#x27;\n&#x27; | tr &#x27;;&#x27; &#x27;\n&#x27; | tr &#x27; &#x27; &#x27;\n&#x27; | tr &#x27;&quot;&#x27; &#x27;\n&#x27; | sed -r &#x27;/^\s*$/d&#x27; | tr &#x27;a-z&#x27; &#x27;A-Z&#x27; &gt; frankestein_new.txt</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> å†™å…¥æ–‡ä»¶å¤´ï¼ˆä½œä¸º sqlite åŠ è½½çš„åˆ—åï¼‰</span></span><br><span class="line">sed -i &#x27;1iword&#x27; frankestein_new.txt</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> sqlite: å¯¼å…¥æ–‡æœ¬åˆ°wordsè¡¨</span></span><br><span class="line">.import frankestein_new.txt words</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> sql: å‡ºç°æ¬¡æ•°æ’ç¬¬äºŒçš„å•è¯</span></span><br><span class="line">SELECT a.word, a.count_word FROM (SELECT word, count(word) AS count_word FROM words GROUP BY word) AS a ORDER BY a.count_word DESC LIMIT 1 OFFSET 1;</span><br></pre></td></tr></table></figure>
<h3 id="ã€mysqlã€‘â€œRosarioâ€-Restore-a-MySQL-database"><a href="#ã€mysqlã€‘â€œRosarioâ€-Restore-a-MySQL-database" class="headerlink" title="ã€mysqlã€‘â€œRosarioâ€: Restore a MySQL database"></a>ã€mysqlã€‘<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/rosario">â€œRosarioâ€: Restore a MySQL database</a></h3><p><img src="/2024/01/17/sadserver-intro/26.png" alt="é¢˜ç›®"></p>
<p>æœ¬æœºå¯åŠ¨äº† <a target="_blank" rel="noopener" href="https://github.com/MariaDB/server">mariadb</a> ï¼Œéœ€è¦åœ¨ main æ•°æ®åº“ä¸­æ‰§è¡Œ backup.sql ä¸­çš„è¯­å¥ï¼Œä½†é¢˜ç›®æ²¡æœ‰æä¾›æ•°æ®åº“ç™»å½•å¯†ç </p>
<p>æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ mysql/mariadb å¦‚ä½•é€šè¿‡å…å¯†æ¨¡å¼å¯åŠ¨ï¼Œå‚è€ƒ <a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.4/en/resetting-permissions.html">B.3.3.2 How to Reset the Root Password</a></p>
<h4 id="ç›¸å…³æŒ‡ä»¤-22"><a href="#ç›¸å…³æŒ‡ä»¤-22" class="headerlink" title="ç›¸å…³æŒ‡ä»¤"></a>ç›¸å…³æŒ‡ä»¤</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹/ä¿®æ”¹ mariadb å¯åŠ¨é…ç½®</span></span><br><span class="line">vim /usr/lib/systemd/system/mariadb.service</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æ·»åŠ systemctlå¯åŠ¨æœåŠ¡çš„ç¯å¢ƒå˜é‡</span></span><br><span class="line">[Service]</span><br><span class="line">Environment=&quot;MYSQLD_OPTS=&#x27;--skip-grant-tables&#x27;&quot;</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> é‡å¯ mariadb</span></span><br><span class="line">systemctl daemon-reload</span><br><span class="line">service mariadb restart</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> å…å¯†ç™»å½•</span></span><br><span class="line">mysql</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> ä¿®æ­£ backup.sql è¯­æ³•é—®é¢˜</span></span><br><span class="line">sed -i &#x27;s#?$#;#g&#x27; /home/admin/backup.sql</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æ‰§è¡Œ backup.sql</span></span><br><span class="line">use main;</span><br><span class="line">source /home/admin/backup.sql;</span><br><span class="line"></span><br><span class="line">mysql -Dmain &lt; /home/admin/backup.sql</span><br></pre></td></tr></table></figure>

<h3 id="ã€mysqlã€‘â€œAbaokoroâ€-Restore-MySQL-Databases-Spooked-by-a-Ghost"><a href="#ã€mysqlã€‘â€œAbaokoroâ€-Restore-MySQL-Databases-Spooked-by-a-Ghost" class="headerlink" title="ã€mysqlã€‘â€œAbaokoroâ€: Restore MySQL Databases Spooked by a Ghost"></a>ã€mysqlã€‘<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/abaokoro">â€œAbaokoroâ€: Restore MySQL Databases Spooked by a Ghost</a></h3><p><img src="/2024/01/17/sadserver-intro/27.png" alt="é¢˜ç›®"></p>
<h4 id="é¢˜æ„-22"><a href="#é¢˜æ„-22" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h4><p>æœ¬æœºå¯åŠ¨äº† mariadb ï¼Œéœ€è¦å°† dbs_to_restore.zip ä¸­çš„ä¸‰ä¸ª sql æ–‡ä»¶åˆ†åˆ«å¯¼å…¥ first ã€ second å’Œ third ä¸‰ä¸ªæ•°æ®åº“ä¸­</p>
<h4 id="ç›¸å…³æŒ‡ä»¤-23"><a href="#ç›¸å…³æŒ‡ä»¤-23" class="headerlink" title="ç›¸å…³æŒ‡ä»¤"></a>ç›¸å…³æŒ‡ä»¤</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> æ£€æŸ¥ç£ç›˜å ç”¨</span></span><br><span class="line">du -h --max-depth=1 /var</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> è§£å‹</span></span><br><span class="line">tar -xzvf dbs_to_restore.tar.gz </span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> å¯¼å…¥ä¸‰ä¸ªæ•°æ®åº“ï¼ˆæ³¨ï¼šå¯¼å…¥æ—¶é—´è¾ƒé•¿ï¼‰</span></span><br><span class="line">mysql -e &quot;create database first&quot;</span><br><span class="line">mysql -Dfirst &lt; first.sql</span><br><span class="line"></span><br><span class="line">mysql -e &quot;create database second&quot;</span><br><span class="line">mysql -Dsecond &lt; second.sql</span><br><span class="line"></span><br><span class="line">mysql -e &quot;create database third&quot;</span><br><span class="line">mysql -Dthird &lt; third.sql</span><br></pre></td></tr></table></figure>

<h3 id="ã€k8sã€helmã€‘â€œPoznanâ€-Helm-Chart-Issue-in-Kubernetes"><a href="#ã€k8sã€helmã€‘â€œPoznanâ€-Helm-Chart-Issue-in-Kubernetes" class="headerlink" title="ã€k8sã€helmã€‘â€œPoznaÅ„â€: Helm Chart Issue in Kubernetes"></a>ã€k8sã€helmã€‘<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/poznan">â€œPoznaÅ„â€: Helm Chart Issue in Kubernetes</a></h3><p><img src="/2024/01/17/sadserver-intro/28.png" alt="é¢˜ç›®"></p>
<p>æœ¬æœºé€šè¿‡ web_chart ç›®å½•å®šä¹‰çš„ nginx chart å¯åŠ¨äº†ä¸€ä¸ª nginx podï¼ŒæœŸæœ›æ˜¯è°ƒç”¨ä»»ä½•ä¸€ä¸ª nginx çš„ 80 ç«¯å£éƒ½èƒ½è¿”å› configmap.yaml ä¸­å®šä¹‰çš„ â€œWelcome SadServersâ€ é¡µé¢</p>
<p>ä½†ç°åœ¨è°ƒç”¨è¿”å›çš„æ˜¯ nginx é»˜è®¤çš„é¡µé¢ï¼Œconfigmap é…çš„é¡µé¢å¹¶æ²¡æœ‰ç”Ÿæ•ˆã€‚éœ€è¦ä½¿ä¹‹ç”Ÿæ•ˆï¼Œè¿˜éœ€è¦å°† nginx çš„å‰¯æœ¬æ•°ä¿®æ”¹ä¸º 3</p>
<p>æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ helm çš„åŸºæœ¬ä½¿ç”¨ï¼Œä»¥åŠ k8s configmap å¦‚ä½•æ³¨å…¥åˆ° pod ä¸­ï¼Œå‚è€ƒ:<br><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/71058097/how-do-i-attach-a-configmap-to-a-deployment-in-kubernetes/71058264#71058264">How do I attach a configmap to a deployment in Kubernetes?</a></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> è·å– nginx pod å¯¹åº”çš„ ip å¹¶è°ƒç”¨ nginx æœåŠ¡</span></span><br><span class="line">pod_ip=`kubectl get pods -n default -o jsonpath=&#x27;&#123;.items[0].status.podIP&#125;&#x27;`</span><br><span class="line">curl $&#123;pod_ip&#125;</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹ deployment</span></span><br><span class="line">kubectl describe deployment web-chart-nginx</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> ä¿®æ”¹ chart valuesï¼ˆåŒ…å«å‰¯æœ¬æ•°é…ç½®ï¼‰</span></span><br><span class="line">helm get values web-chart --all</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> é‡è£… web-chart</span></span><br><span class="line">helm uninstall web-chart</span><br><span class="line">helm install web-chart web_chart/</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æˆ–: æ›´æ–° chart</span></span><br><span class="line">helm upgrade web-chart ./web_chart --values ./web_chart/values.yaml</span><br></pre></td></tr></table></figure>

<p>ä¿®æ”¹åçš„ deployment:</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">(çœç•¥)</span></span><br><span class="line">    <span class="attr">spec:</span></span><br><span class="line">      <span class="attr">containers:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> &#123;&#123; <span class="string">.Chart.Name</span> &#125;&#125;</span><br><span class="line">          <span class="attr">image:</span> <span class="string">&quot;<span class="template-variable">&#123;&#123; .Values.image.repository &#125;&#125;</span>:<span class="template-variable">&#123;&#123; .Values.image.tag &#125;&#125;</span>&quot;</span></span><br><span class="line">          <span class="attr">imagePullPolicy:</span> &#123;&#123; <span class="string">.Values.image.pullPolicy</span> &#125;&#125;</span><br><span class="line">          <span class="attr">ports:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">http</span></span><br><span class="line">              <span class="attr">containerPort:</span> <span class="number">80</span></span><br><span class="line">              <span class="attr">protocol:</span> <span class="string">TCP</span></span><br><span class="line">          <span class="attr">volumeMounts:</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">mountPath:</span> <span class="string">/usr/share/nginx/html/</span></span><br><span class="line">            <span class="attr">name:</span> <span class="string">nginx-html</span></span><br><span class="line">      <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">nginx-html</span></span><br><span class="line">        <span class="attr">configMap:</span></span><br><span class="line">          <span class="attr">name:</span> &#123;&#123; <span class="string">.Release.Name</span> &#125;&#125;<span class="string">-cm-index-html</span></span><br><span class="line">          <span class="attr">items:</span>              </span><br><span class="line">          <span class="bullet">-</span> <span class="attr">key:</span> <span class="string">index.html</span></span><br><span class="line">            <span class="attr">path:</span> <span class="string">index.html</span></span><br></pre></td></tr></table></figure>

<h3 id="ã€linuxã€‘â€œManadoâ€-How-much-do-you-press"><a href="#ã€linuxã€‘â€œManadoâ€-How-much-do-you-press" class="headerlink" title="ã€linuxã€‘â€œManadoâ€: How much do you press?"></a>ã€linuxã€‘<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/manado">â€œManadoâ€: How much do you press?</a></h3><p><img src="/2024/01/17/sadserver-intro/29.png" alt="é¢˜ç›®"></p>
<h4 id="é¢˜æ„-23"><a href="#é¢˜æ„-23" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h4><p>é€šè¿‡æœ¬æœºæä¾›çš„ gzipã€xzã€lzipã€tar ç­‰å·¥å…·ï¼Œå°† 35147 å­—èŠ‚å¤§å°çš„ names æ–‡ä»¶å‹ç¼©æˆä¸åˆ° 9400 å­—èŠ‚ï¼Œå¹¶å°†å‹ç¼©æ–‡ä»¶æ”¾åˆ° solution ç›®å½•ä¸‹</p>
<p>å¯ä»¥åœ¨<strong>ä¸åˆ é™¤</strong>ä»»ä½•è¡Œçš„å‰æä¸‹å¯¹æ–‡ä»¶è¿›è¡Œä¿®æ”¹</p>
<h4 id="ç›¸å…³æŒ‡ä»¤-24"><a href="#ç›¸å…³æŒ‡ä»¤-24" class="headerlink" title="ç›¸å…³æŒ‡ä»¤"></a>ç›¸å…³æŒ‡ä»¤</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> gzip å‹ç¼©å’Œè§£å‹</span></span><br><span class="line">gzip -v9 names</span><br><span class="line">gunzip names.gz</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> xz</span></span><br><span class="line">xz names</span><br><span class="line">xz -d names.xz</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> lzip</span></span><br><span class="line">tar --use-compress-program=lbzip2 -cvf names.tar.bz2 names</span><br><span class="line">tar --use-compress-program=lbzip2 -xvf names.tar.bz2</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> lz4</span></span><br><span class="line">lz4 names</span><br><span class="line">lz4 -d names.lz4</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> lzip</span></span><br><span class="line">lzip --best names</span><br><span class="line">lzip -d names.lz</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> lzop</span></span><br><span class="line">lzop -9 names</span><br><span class="line">lzop -d names.lz.lzo</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> zstd</span></span><br><span class="line">zstd -19 names</span><br><span class="line">zstd -d names.zst</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æ–‡ä»¶å†…å®¹æ’åº</span></span><br><span class="line">sort names &gt; names_new</span><br></pre></td></tr></table></figure>

<h3 id="ã€dockerã€golangã€‘â€œWarsawâ€-Prometheus-canâ€™t-scrape-the-webserver"><a href="#ã€dockerã€golangã€‘â€œWarsawâ€-Prometheus-canâ€™t-scrape-the-webserver" class="headerlink" title="ã€dockerã€golangã€‘â€œWarsawâ€: Prometheus canâ€™t scrape the webserver"></a>ã€dockerã€golangã€‘<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/warsaw">â€œWarsawâ€: Prometheus canâ€™t scrape the webserver</a></h3><p><img src="/2024/01/17/sadserver-intro/30.png" alt="é¢˜ç›®"></p>
<h4 id="é¢˜æ„-24"><a href="#é¢˜æ„-24" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h4><p>app ç›®å½•ä¸‹æ˜¯ä¸€ä¸ªé€šè¿‡ gorilla/mux æ¡†æ¶æ­å»ºçš„ web æœåŠ¡ï¼Œå¹¶é€šè¿‡ promhttp æš´éœ² /metrics æ¥å£</p>
<p>ä½†æ˜¯ç›®å‰ç›´æ¥è°ƒç”¨ <a target="_blank" rel="noopener" href="http://localhost:9000/metrics">http://localhost:9000/metrics</a> æ¥å£å°†å¤±è´¥ï¼Œéœ€è¦è§£å†³</p>
<h4 id="ç›¸å…³æŒ‡ä»¤-25"><a href="#ç›¸å…³æŒ‡ä»¤-25" class="headerlink" title="ç›¸å…³æŒ‡ä»¤"></a>ç›¸å…³æŒ‡ä»¤</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> è°ƒç”¨ metrics æ¥å£</span></span><br><span class="line">curl http://localhost:9000/metrics</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> é‡å¯ docker compose æœåŠ¡</span></span><br><span class="line">docker compose down --volumes</span><br><span class="line">docker compose up -d</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># é‡æ–°æ„å»ºé•œåƒå†å¯åŠ¨</span></span></span><br><span class="line">docker compose up --build -d</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹ app çš„å¯åŠ¨é€»è¾‘</span></span><br><span class="line">vim app/main.go</span><br></pre></td></tr></table></figure>

<h3 id="â€œMoyogalpaâ€-Security-Snag-The-Trials-of-Mary-and-John"><a href="#â€œMoyogalpaâ€-Security-Snag-The-Trials-of-Mary-and-John" class="headerlink" title="â€œMoyogalpaâ€: Security Snag. The Trials of Mary and John"></a><a target="_blank" rel="noopener" href="https://sadservers.com/scenario/moyogalpa">â€œMoyogalpaâ€: Security Snag. The Trials of Mary and John</a></h3><p><img src="/2024/01/17/sadserver-intro/31.png" alt="é¢˜ç›®"></p>
<h4 id="é¢˜æ„-25"><a href="#é¢˜æ„-25" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h4><p>æœ¬åœ°æœ‰ä¸€ä¸ªé€šè¿‡ systemctl å¯åŠ¨çš„ web æœåŠ¡ï¼Œè™½ç„¶å®ƒå¯ä»¥è¿è¡Œä½†è®¿é—®å…¶æ¥å£ä¼šå¤±è´¥ï¼Œéœ€è¦ä¿®å¤è¯ä¹¦å’Œæƒé™ç›¸å…³çš„é—®é¢˜ï¼Œä»¥åŠé˜²ç«å¢™ apparmor çš„é…ç½®é—®é¢˜</p>
<p><a target="_blank" rel="noopener" href="https://wsxk.github.io/apparmor%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6/">apparmor çš„ä½¿ç”¨æ–¹å¼å‚è€ƒ</a></p>
<h4 id="ç›¸å…³æŒ‡ä»¤-26"><a href="#ç›¸å…³æŒ‡ä»¤-26" class="headerlink" title="ç›¸å…³æŒ‡ä»¤"></a>ç›¸å…³æŒ‡ä»¤</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹æœåŠ¡å®šä¹‰</span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ï¼ŒæŒ‡å®šäº†é™æ€æ–‡ä»¶è·¯å¾„ä¸º /home/webapp/static-files, è¯ä¹¦æ–‡ä»¶ä¸º /home/webapp/pki/server.crt</span></span></span><br><span class="line">cat /etc/systemd/system/webapp.service</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> é‡å¯ webapp</span></span><br><span class="line">systemctl restart webapp</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> è§£å†³ webapp æ— æ³• su çš„é—®é¢˜: æ›¿æ¢ webapp çš„ç™»å½• shell</span></span><br><span class="line">vim /etc/passwd</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æ‰‹åŠ¨å¯åŠ¨ webapp</span></span><br><span class="line">export APP_STATIC_DIR=/home/webapp/static-files</span><br><span class="line">export APP_CERT=/home/webapp/pki/server.crt</span><br><span class="line">export APP_KEY=/home/webapp/pki/server.pem</span><br><span class="line">su webapp -c &quot;/usr/local/bin/webapp&quot;</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> ä¿®å¤è¯ä¹¦æƒé™é—®é¢˜</span></span><br><span class="line">chown -R webapp:webapp /home/webapp/</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æ·»åŠ  hosts</span></span><br><span class="line">echo &quot;127.0.0.1 webapp&quot; &gt;&gt; /etc/hosts</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æ£€æŸ¥æŒ‡ä»¤</span></span><br><span class="line">curl https://webapp:7000/users.html</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> ä¿®å¤ SSL certificate problem: unable to get <span class="built_in">local</span> issuer certificate çš„é—®é¢˜</span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># å‚è€ƒ: https://stackoverflow.com/questions/24611640/curl-60-ssl-certificate-problem-unable-to-get-local-issuer-certificate</span></span></span><br><span class="line">cp /home/webapp/pki/CA.crt /usr/local/share/ca-certificates</span><br><span class="line">chmod 644 /usr/local/share/ca-certificates/CA.crt</span><br><span class="line">update-ca-certificates</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> è§£å†³ open /home/webapp/static-files/users.html: permission denied çš„é—®é¢˜</span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># åœ¨é˜²ç«å¢™é…ç½®ä¸­ï¼Œæ·»åŠ  /home/webapp/static-files/ r å’Œ /home/webapp/static-files/* r</span></span></span><br><span class="line">vim /etc/apparmor.d/usr.local.bin.webapp</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># æ›´æ–°é…ç½®åˆ°å†…æ ¸ä¸­</span></span></span><br><span class="line">apparmor_parser -r /etc/apparmor.d/usr.local.bin.webapp</span><br></pre></td></tr></table></figure>

<!--

[ä½¿ç”¨ AppArmor é™åˆ¶å®¹å™¨å¯¹èµ„æºçš„è®¿é—®](https://kubernetes.io/zh-cn/docs/tutorials/security/apparmor/)

[AppArmorç›¸å…³å„è„šæœ¬å’ŒæœåŠ¡è§£æï¼ˆ2ï¼‰](https://blog.csdn.net/phmatthaus/article/details/130863424)

[How do you add a certificate authority (CA) to Ubuntu?](https://superuser.com/questions/437330/how-do-you-add-a-certificate-authority-ca-to-ubuntu)

-->

<h3 id="ã€postgresqlã€‘â€œHelsingorâ€-The-first-walls-of-postgres-physical-replication"><a href="#ã€postgresqlã€‘â€œHelsingorâ€-The-first-walls-of-postgres-physical-replication" class="headerlink" title="ã€postgresqlã€‘â€œHelsingÃ¸râ€: The first walls of postgres physical replication"></a>ã€postgresqlã€‘<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/helsingor">â€œHelsingÃ¸râ€: The first walls of postgres physical replication</a></h3><p><img src="/2024/01/17/sadserver-intro/32.png" alt="é¢˜ç›®"></p>
<h4 id="é¢˜æ„-26"><a href="#é¢˜æ„-26" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h4><p>æœ¬åœ°é€šè¿‡ docker compose å¯åŠ¨äº† postgresqlï¼Œagent/check.sh ä¹Ÿå°±æ˜¯æ£€æŸ¥ç­”æ¡ˆçš„è„šæœ¬ä¸­ï¼Œå°†ä¼šå…ˆç¡®è®¤å¤‡åº“å’Œä¸»åº“çš„åŒæ­¥æ˜¯å¦æ­£å¸¸ã€‚ä½†æ˜¯ç›®å‰å¤‡åº“å¯åŠ¨å¤±è´¥äº†ï¼Œéœ€è¦æ‰¾åˆ°åŸå› å¹¶è§£å†³</p>
<p>æ‰©å±•: <a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/8466223/reuse-a-hash-in-yaml/9197237#9197237">yaml ä¸­å¤ç”¨å†…å®¹çš„å†™æ³•ï¼ˆ&amp;ï¼‰</a></p>
<h4 id="ç›¸å…³æŒ‡ä»¤-27"><a href="#ç›¸å…³æŒ‡ä»¤-27" class="headerlink" title="ç›¸å…³æŒ‡ä»¤"></a>ç›¸å…³æŒ‡ä»¤</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹èŠ‚ç‚¹çŠ¶æ€</span></span><br><span class="line">docker ps -a</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹æ—¥å¿—</span></span><br><span class="line">docker logs 98e1b8d4a341</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> é‡å¯ compose</span></span><br><span class="line">docker compose down --volumes</span><br><span class="line">docker compose up -d</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># å¼ºåˆ¶é‡å»º</span></span></span><br><span class="line">docker compose up -d --force-recreate</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> ä¿®æ”¹é…ç½®</span></span><br><span class="line">vim postgres/replica/postgres.conf</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># æ‰¹é‡ä¿®å¤é…ç½®</span></span></span><br><span class="line">sed -i &quot;s/max_connections = 80/max_connections = 100/g&quot; postgres/replica/postgres.conf</span><br><span class="line">sed -i &quot;s/max_worker_processes = 4/max_worker_processes = 8/g&quot; postgres/replica/postgres.conf</span><br><span class="line">sed -i &quot;s/max_wal_senders = 5/max_wal_senders = 10/g&quot; postgres/replica/postgres.conf</span><br><span class="line">sed -i &quot;s/max_locks_per_transaction = 32/max_locks_per_transaction = 64/g&quot; postgres/replica/postgres.conf</span><br></pre></td></tr></table></figure>

<!--
# æŸ¥çœ‹ä»åº“æ•°æ®
docker compose exec postgres-db-replica psql -U helsingor -d helsingor -tc "select person_id from users order by person_id desc limit 1;"

# 
docker compose exec postgres-db-master psql -U helsingor -d helsingor -tc "insert into users (first_name, last_name, age, city, os) values ('Will', 'Smith', '55', 'Philadelphia', 'MacOS')"

docker compose exec postgres-db-replica psql -U helsingor -d helsingor -tc "select person_id from users order by person_id desc limit 1;"
-->

<h3 id="ã€WSGIã€‘â€œBekasiâ€-Supervisor-is-still-around"><a href="#ã€WSGIã€‘â€œBekasiâ€-Supervisor-is-still-around" class="headerlink" title="ã€WSGIã€‘â€œBekasiâ€: Supervisor is still around"></a>ã€WSGIã€‘<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/bekasi">â€œBekasiâ€: Supervisor is still around</a></h3><p><img src="/2024/01/17/sadserver-intro/33.png" alt="é¢˜ç›®"></p>
<h4 id="é¢˜æ„-27"><a href="#é¢˜æ„-27" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h4><p>æœ¬åœ°é€šè¿‡ uwsgi å¯åŠ¨äº†ä¸€ä¸ª https æœåŠ¡ï¼Œä½†é€šè¿‡ curl -k <a target="_blank" rel="noopener" href="https://bekasi/">https://bekasi</a> è°ƒç”¨å¤±è´¥</p>
<p>æœ¬é¢˜æ€è·¯æ˜¯å…ˆç¡®è®¤ uwsgi çš„éƒ¨ç½²æ–¹å¼ï¼Œå†ç¡®è®¤å¦‚ä½•ä¿®æ”¹å®ƒçš„éƒ¨ç½²é…ç½®ï¼Œæœ€åé‡å¯</p>
<h4 id="ç›¸å…³æŒ‡ä»¤-28"><a href="#ç›¸å…³æŒ‡ä»¤-28" class="headerlink" title="ç›¸å…³æŒ‡ä»¤"></a>ç›¸å…³æŒ‡ä»¤</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> è°ƒç”¨æœåŠ¡</span></span><br><span class="line">curl -k https://bekasi</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹ uwsgi è¿›ç¨‹</span></span><br><span class="line">ps -ef | grep uwsgi</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹åå°é€»è¾‘</span></span><br><span class="line">cat bekasi/bekasi.py</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># ä¿®æ”¹ supervisor å¯åŠ¨ uwsgi é…ç½®</span></span></span><br><span class="line">vim /etc/supervisor/conf.d/uwsgi.conf</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> é‡è½½é…ç½®å¹¶é‡å¯æœåŠ¡</span></span><br><span class="line">sudo supervisorctl reload</span><br></pre></td></tr></table></figure>

<!--
cat /etc/supervisor/conf.d/uwsgi.conf
cat /usr/lib/systemd/system/supervisor.service
systemctl restart supervisor

# vim bekasi/bekasi.ini
env             = BEKASI_USER=admin
env             = BEKASI_SERVER=bekasi.sadservers.com

# vim /etc/supervisor/conf.d/uwsgi.conf
environment=BEKASI_USER=admin,BEKASI_SERVER=bekasi.sadservers.com

# é‡å¯ supervisor
systemctl restart supervisor

# ä¿®æ”¹ uwsgi åå°æœåŠ¡é…ç½®
vim bekasi/bekasi.ini

# ï¼ˆä¼šè¢« supervisor è‡ªåŠ¨æ‹‰èµ·ï¼‰
ps -ef | grep "uwsgi" | grep -v grep | awk '{print $2}' | xargs kill -9
-->


<h3 id="ã€nginxã€‘â€œDepokâ€-Nginx-with-Brotli"><a href="#ã€nginxã€‘â€œDepokâ€-Nginx-with-Brotli" class="headerlink" title="ã€nginxã€‘â€œDepokâ€: Nginx with Brotli"></a>ã€nginxã€‘<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/depok">â€œDepokâ€: Nginx with Brotli</a></h3><p><img src="/2024/01/17/sadserver-intro/34.png" alt="é¢˜ç›®"></p>
<h4 id="é¢˜æ„-28"><a href="#é¢˜æ„-28" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h4><p><a target="_blank" rel="noopener" href="https://github.com/google/ngx_brotli">brotli</a> æ˜¯ æ˜¯ Google åœ¨ 2015 å¹´ 9 æœˆæ¨å‡ºçš„ä¸€ç§å‹ç¼©ç®—æ³•ï¼Œä½¿ç”¨é€šç”¨çš„ LZ77 æ— æŸå‹ç¼©ç®—æ³•ã€Huffman ç¼–ç å’ŒäºŒé˜¶ä¸Šä¸‹æ–‡å»ºæ¨¡ï¼ˆ2nd order context modellingï¼‰çš„ç‰¹å®šç»„åˆï¼Œæ—¨åœ¨è¿›ä¸€æ­¥æé«˜å‹ç¼©æ¯”</p>
<p>éƒ¨ç½²åœ¨æœ¬åœ°çš„ nginx æœåŠ¡ç›®å‰è¿˜ä¸æ”¯æŒ brotli å‹ç¼©ç®—æ³•ï¼Œéœ€è¦é€šè¿‡ brotli æºç å®‰è£…æ’ä»¶</p>
<p>æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ nginx æ’ä»¶çš„å®‰è£…æ–¹æ³•</p>
<p>å‚è€ƒ: <a target="_blank" rel="noopener" href="https://juejin.cn/post/7031471867609546759">CentOS 8 å®‰è£…å¹¶åŠ è½½ Nginx æ¨¡ç»„ ngx_brotli ç„¶åå¯ç”¨ brotli å‹ç¼©</a></p>
<p><a target="_blank" rel="noopener" href="https://ubuntu.com/server/docs/how-to-use-nginx-modules">How to use nginx modules</a></p>
<h4 id="ç›¸å…³æŒ‡ä»¤-29"><a href="#ç›¸å…³æŒ‡ä»¤-29" class="headerlink" title="ç›¸å…³æŒ‡ä»¤"></a>ç›¸å…³æŒ‡ä»¤</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> è°ƒç”¨ nginx å¹¶æŒ‡å®šç¼–ç ä¸º br</span></span><br><span class="line">curl -H &quot;Accept-Encoding: br&quot; -I http://localhost</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> ç¼–è¯‘ brotli æ’ä»¶</span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># æ­¥éª¤å‚è€ƒå®˜æ–¹ä»“åº“ https://github.com/google/ngx_brotli</span></span></span><br><span class="line">cd /home/admin/ngx_brotli/deps/brotli</span><br><span class="line">mkdir out</span><br><span class="line">cd out</span><br><span class="line">cmake -DCMAKE_BUILD_TYPE=Release -DBUILD_SHARED_LIBS=OFF -DCMAKE_C_FLAGS=&quot;-Ofast -m64 -march=native -mtune=native -flto -funroll-loops -ffunction-sections -fdata-sections -Wl,--gc-sections&quot; -DCMAKE_CXX_FLAGS=&quot;-Ofast -m64 -march=native -mtune=native -flto -funroll-loops -ffunction-sections -fdata-sections -Wl,--gc-sections&quot; -DCMAKE_INSTALL_PREFIX=./installed ..</span><br><span class="line">cmake --build . --config Release --target brotlienc</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> é‡æ–°ç¼–è¯‘ nginx å¹¶é“¾æ¥ brotli</span></span><br><span class="line">cd /home/admin/nginx</span><br><span class="line">./configure --with-compat --add-dynamic-module=../ngx_brotli</span><br><span class="line">make modules</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æ‹·è´ç¼–è¯‘åäº§ç”Ÿçš„é“¾æ¥æ–‡ä»¶</span></span><br><span class="line">cp objs/ngx_http_brotli_filter_module.so /usr/lib/nginx/modules/</span><br><span class="line">cp objs/ngx_http_brotli_static_module.so /usr/lib/nginx/modules/</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æ·»åŠ </span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># vim /etc/nginx/modules-available/50-ngx-http-brotli.conf</span></span></span><br><span class="line">load_module modules/ngx_http_brotli_filter_module.so;</span><br><span class="line">load_module modules/ngx_http_brotli_static_module.so;</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> å¼€å¯ brotli æ’ä»¶</span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># vim /etc/nginx/sites-enabled/default</span></span></span><br><span class="line">server &#123;</span><br><span class="line">	brotli on;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> é‡è½½ nginx é…ç½®</span></span><br><span class="line">sudo systemctl reload nginx</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> é‡å¯ nginx</span></span><br><span class="line">sudo systemctl restart nginx</span><br></pre></td></tr></table></figure>

<!-- å‚è€ƒ:

[httpå“åº”Headerï¼šContent-Encoding=bræ€ä¹ˆåŠï¼Ÿ](https://blog.csdn.net/lrcxl/article/details/128416117)

-->

<h3 id="ã€linuxã€‘â€œTukaaniâ€-XZ-LZMA-Library-Compromised"><a href="#ã€linuxã€‘â€œTukaaniâ€-XZ-LZMA-Library-Compromised" class="headerlink" title="ã€linuxã€‘â€œTukaaniâ€: XZ LZMA Library Compromised"></a>ã€linuxã€‘<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/tukaani">â€œTukaaniâ€: XZ LZMA Library Compromised</a></h3><p><img src="/2024/01/17/sadserver-intro/35.png" alt="é¢˜ç›®"></p>
<h4 id="é¢˜æ„-29"><a href="#é¢˜æ„-29" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h4><p>liblzma æ˜¯ä¸€ä¸ªç”¨äºæ•°æ®å‹ç¼©çš„åº“ï¼Œæä¾›å¯¹ LZMAï¼ˆLempel-Ziv-Markov chain algorithmï¼‰å’Œ XZ å‹ç¼©æ ¼å¼çš„æ”¯æŒ</p>
<p>æ­£å¸¸æƒ…å†µä¸‹æœ¬åœ°æœåŠ¡éœ€è¦åŠ è½½çš„æ˜¯ /usr/lib/x86_64-linux-gnu/liblzma.so.5.2.5ï¼Œä½†é€šè¿‡ sudo lsof | grep liblzma.so.5 å¯ä»¥çœ‹åˆ°å¾ˆå¤šè¿›ç¨‹éƒ½åŠ è½½äº† /opt/.trash/liblzma.so.5ï¼Œéœ€è¦è§£å†³è¿™ä¸ªé—®é¢˜</p>
<p>æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿé¢„åŠ è½½åº“çš„è®¾ç½®ï¼ˆLD_PRELOADï¼‰</p>
<h4 id="ç›¸å…³æŒ‡ä»¤-30"><a href="#ç›¸å…³æŒ‡ä»¤-30" class="headerlink" title="ç›¸å…³æŒ‡ä»¤"></a>ç›¸å…³æŒ‡ä»¤</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹ liblzma ç›¸å…³è¿›ç¨‹</span></span><br><span class="line">lsof | grep liblzma.so.5</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> åˆ é™¤æ— æ•ˆåº“</span></span><br><span class="line">rm /opt/.trash/liblzma.so.5</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹æ‰€æœ‰åŠ¨æ€é“¾æ¥åº“ä¹‹å‰é¢„åŠ è½½çš„åº“é…ç½®</span></span><br><span class="line">vim /etc/ld.so.preload</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> é‡å¯èŠ‚ç‚¹</span></span><br><span class="line">reboot</span><br></pre></td></tr></table></figure>

<h2 id="å›°éš¾"><a href="#å›°éš¾" class="headerlink" title="å›°éš¾"></a>å›°éš¾</h2><p>æé†’: å›°éš¾çš„é¢˜ç›®ä¼¼ä¹ç™»å½•èŠ‚ç‚¹åé»˜è®¤åœ¨æ ¹ç›®å½•ï¼Œéœ€è¦è®°å¾—åˆ‡æ¢åˆ° /home/admin æ‰èƒ½çœ‹åˆ°é¢˜ç›®æä¾›çš„æ–‡ä»¶</p>
<h3 id="ã€linuxã€‘â€œJakartaâ€-itâ€™s-always-DNS"><a href="#ã€linuxã€‘â€œJakartaâ€-itâ€™s-always-DNS" class="headerlink" title="ã€linuxã€‘â€œJakartaâ€: itâ€™s always DNS."></a>ã€linuxã€‘<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/jakarta">â€œJakartaâ€: itâ€™s always DNS.</a></h3><p><img src="/2024/01/17/sadserver-intro/36.png" alt="é¢˜ç›®"></p>
<h4 id="é¢˜æ„-30"><a href="#é¢˜æ„-30" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h4><p>æœ¬æœºæ— æ³• ping é€š google.comï¼Œç›´æ¥ ping è¿”å›çš„æ˜¯ Name or service not knownï¼Œ</p>
<p>æœ¬é¢˜æ˜¯ä»¥å‰ sadserver çš„å®éªŒé¢˜ï¼Œæ‰€ä»¥è™½ç„¶æ”¾åœ¨å›°éš¾éƒ¨åˆ†ï¼Œä½†åªè¦ä¿®å¤ /etc/nsswitch.conf é…ç½®å³å¯è§£å†³</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/emilyyoucan/articles/8118173.html">å‚è€ƒ-Linuxç³»ç»Ÿè§£æåŸŸåçš„å…ˆåé¡ºåºfilesï¼ˆ/etc/hostsï¼‰OR dnsï¼ˆ/etc/resolv.confï¼‰</a></p>
<h4 id="ç›¸å…³æŒ‡ä»¤-31"><a href="#ç›¸å…³æŒ‡ä»¤-31" class="headerlink" title="ç›¸å…³æŒ‡ä»¤"></a>ç›¸å…³æŒ‡ä»¤</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹å¹¶ä¿®å¤åŸŸåè§£æä¼˜å…ˆçº§é…ç½®</span></span><br><span class="line">vim /etc/nsswitch.conf</span><br><span class="line">sed -i &quot;s/hosts:.*/hosts:          files dns/g&quot; /etc/nsswitch.conf</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æ£€æŸ¥æŒ‡ä»¤</span></span><br><span class="line">ping google.com</span><br></pre></td></tr></table></figure>

<h3 id="ã€wordpressã€dockerã€‘â€œBernâ€-Docker-web-container-canâ€™t-connect-to-db-container"><a href="#ã€wordpressã€dockerã€‘â€œBernâ€-Docker-web-container-canâ€™t-connect-to-db-container" class="headerlink" title="ã€wordpressã€dockerã€‘â€œBernâ€: Docker web container canâ€™t connect to db container."></a>ã€wordpressã€dockerã€‘<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/bern">â€œBernâ€: Docker web container canâ€™t connect to db container.</a></h3><p><img src="/2024/01/17/sadserver-intro/37.png" alt="é¢˜ç›®"></p>
<h4 id="é¢˜æ„-31"><a href="#é¢˜æ„-31" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h4><p>æœ¬åœ°é€šè¿‡ docker å¯åŠ¨äº† <a target="_blank" rel="noopener" href="https://wordpress.com/zh-cn">wordpress</a> å’Œ mariadb ä¸¤ä¸ªå®¹å™¨ï¼Œmariadb æ•°æ®åº“çŠ¶æ€æ­£å¸¸ï¼Œä½† wordpress æœåŠ¡æ— æ³•è®¿é—® mariadbï¼Œéœ€è¦è§£å†³è¿™ä¸ªé—®é¢˜</p>
<h4 id="ç›¸å…³æŒ‡ä»¤-32"><a href="#ç›¸å…³æŒ‡ä»¤-32" class="headerlink" title="ç›¸å…³æŒ‡ä»¤"></a>ç›¸å…³æŒ‡ä»¤</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹ wordpress æ¥å£è¿”å›ç»“æœ</span></span><br><span class="line">curl -s localhost:80 |tail -4</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æ£€æŸ¥ wordpress å®¹å™¨è®¿é—®åŸŸå <span class="string">&quot;mysql&quot;</span> çš„ç»“æœ</span></span><br><span class="line">docker exec wordpress mysqladmin -h mysql -u root -ppassword --connect-timeout 2 ping</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹ wordpress å®¹å™¨çš„è¯¦ç»†ä¿¡æ¯ï¼ˆ ä¸»è¦çœ‹ç¯å¢ƒå˜é‡ Env ï¼‰</span></span><br><span class="line">docker inspect 6ffb084b515c</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹ wordpress å®¹å™¨ä¸­è®¾ç½®çš„è¿æ¥æ•°æ®åº“ç›¸å…³çš„ç¯å¢ƒå˜é‡</span></span><br><span class="line">docker exec wordpress env | grep WORDPRESS_DB_</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹ wordpress é…ç½®æ–‡ä»¶ä¸­ï¼Œå’Œè¿æ¥æ•°æ®åº“ç›¸å…³çš„ç¯å¢ƒå˜é‡</span></span><br><span class="line">grep WORDPRESS_DB_ /home/admin/html/wp-config.php</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> åˆ é™¤å®¹å™¨</span></span><br><span class="line">docker rm 6ffb084b515c</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> å¯åŠ¨æ–°çš„ è®¾ç½®äº†åŸŸåæ˜ å°„çš„ wordpress å®¹å™¨</span></span><br><span class="line">docker run -it -p 80:80 -e WORDPRESS_DB_PASSWORD=password -e WORDPRESS_DB_USER=root --add-host mysql:172.17.0.1 --name wordpress -d wordpress:sad</span><br></pre></td></tr></table></figure>

<!--
# æŸ¥çœ‹é‡å¯è„šæœ¬
cat /usr/local/bin/docker-entrypoint.sh

# é‡å¯ wordpress
ps -ef | grep 'apache2' | grep -v grep | awk '{print $2}' | xargs --no-run-if-empty kill -9
/usr/local/bin/docker-entrypoint.sh apache2-foreground

# è®¾ç½® wordpress æ•°æ®åº“é…ç½®ç›¸å…³çš„ç¯å¢ƒå˜é‡
## export WORDPRESS_DB_PASSWORD=password
## export WORDPRESS_DB_USER=root
export WORDPRESS_DB_HOST=172.17.0.1(å®¹å™¨è¿æ¥å®¿ä¸»æœºçš„åœ°å€)

# ä¿®æ”¹ wordpress é…ç½®æ–‡ä»¶
vim ./wp-config.php
## 172.17.0.1: å®¹å™¨è¿æ¥å®¿ä¸»æœºçš„åœ°å€
## sed -i "s/'WORDPRESS_DB_HOST', 'mysql'/'WORDPRESS_DB_HOST', '172.17.0.1'/g" wp-config.php

# hosts ä¸­è®¾ç½®åŸŸåå’Œipæ˜ å°„
echo "172.17.0.1 mysql" >> /etc/hosts

# é‡å¯å®¹å™¨
docker restart 6ffb084b515c
-->

<h3 id="ã€æ¨èã€‘ã€linuxã€‘â€œKarakorumâ€-WTFIT-â€“-What-The-Fun-Is-This"><a href="#ã€æ¨èã€‘ã€linuxã€‘â€œKarakorumâ€-WTFIT-â€“-What-The-Fun-Is-This" class="headerlink" title="ã€æ¨èã€‘ã€linuxã€‘â€œKarakorumâ€: WTFIT â€“ What The Fun Is This?"></a>ã€æ¨èã€‘ã€linuxã€‘<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/karakorum">â€œKarakorumâ€: WTFIT â€“ What The Fun Is This?</a></h3><p><img src="/2024/01/17/sadserver-intro/38.png" alt="é¢˜ç›®"></p>
<h4 id="é¢˜æ„-32"><a href="#é¢˜æ„-32" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h4><p>/home/admin/wtfit æ–‡ä»¶æ˜¯ä¸€ä¸ªéœ€è¦è¿æ¥æŸä¸ªåœ°å€æ‰èƒ½å¯åŠ¨çš„æœåŠ¡ã€‚ä½†é¦–å…ˆå®ƒå› ä¸ºæ²¡æœ‰å¯æ‰§è¡Œæƒé™è€Œæ— æ³•æ‰§è¡Œï¼Œå…¶æ¬¡å®ƒå®é™…æ‰§è¡Œä¹Ÿæœ‰æŠ¥é”™ï¼Œéœ€è¦ç»™å®ƒæ·»åŠ å¯æ‰§è¡Œæƒé™ï¼Œå¹¶è§£å†³è¿è¡Œæ–‡ä»¶ä½¿å¾—å…¶èƒ½å¤Ÿæ­£å¸¸å¯åŠ¨</p>
<h4 id="ç›¸å…³æŒ‡ä»¤-33"><a href="#ç›¸å…³æŒ‡ä»¤-33" class="headerlink" title="ç›¸å…³æŒ‡ä»¤"></a>ç›¸å…³æŒ‡ä»¤</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> chmod æ·»åŠ å¯æ‰§è¡Œæƒé™</span></span><br><span class="line">chmod +x /home/admin/wtfit</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> é€šè¿‡ perl è„šæœ¬è°ƒç”¨ chmod</span></span><br><span class="line">perl -e &#x27;chmod 0755, &quot;/usr/bin/chmod&quot;&#x27;</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> é€šè¿‡ ld-linux ï¼ˆåŠ¨æ€é“¾æ¥å™¨ï¼‰ è°ƒç”¨ chmod</span></span><br><span class="line">/lib64/ld-linux-x86-64.so.2 /usr/bin/chmod +x /usr/bin/chmod</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æ‰§è¡ŒäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¹¶è·Ÿè¸ªè¿›ç¨‹å †æ ˆ</span></span><br><span class="line">strace /home/admin/wtfit</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> é€šè¿‡ python å¿«é€Ÿå¯åŠ¨ä¸€ä¸ªç›‘å¬ç«¯å£ 7777 http æœåŠ¡ç«¯</span></span><br><span class="line">python3 -m http.server 7777 &amp;</span><br></pre></td></tr></table></figure>

<h3 id="ã€kubernetesã€‘â€œSingaraâ€-Docker-and-Kubernetes-web-app-not-working"><a href="#ã€kubernetesã€‘â€œSingaraâ€-Docker-and-Kubernetes-web-app-not-working" class="headerlink" title="ã€kubernetesã€‘â€œSingaraâ€: Docker and Kubernetes web app not working."></a>ã€kubernetesã€‘<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/singara">â€œSingaraâ€: Docker and Kubernetes web app not working.</a></h3><p><img src="/2024/01/17/sadserver-intro/39.png" alt="é¢˜ç›®"></p>
<h4 id="é¢˜æ„-33"><a href="#é¢˜æ„-33" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h4><p>æœ¬åœ°é€šè¿‡ <a target="_blank" rel="noopener" href="https://github.com/k3s-io/k3s">k3s</a> å¯åŠ¨äº†ä¸€ä¸ªè½»é‡çº§ kubernetes é›†ç¾¤ï¼Œå¹¶åœ¨ /home/admin/deployment.yml ä¸­å®šä¹‰äº† webapp è¿™ä¸ª web æœåŠ¡ï¼Œä½†æ˜¯å®¹å™¨å¯åŠ¨æœ‰é—®é¢˜ï¼Œé€šè¿‡ curl -i localhost:8888 æ— æ³•è°ƒé€šï¼Œéœ€è¦è§£å†³</p>
<h4 id="ç›¸å…³æŒ‡ä»¤-34"><a href="#ç›¸å…³æŒ‡ä»¤-34" class="headerlink" title="ç›¸å…³æŒ‡ä»¤"></a>ç›¸å…³æŒ‡ä»¤</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> è·å–æ‰€æœ‰ pod</span></span><br><span class="line">kubectl get pod -A</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> è·å– pod çš„æè¿°ä¿¡æ¯</span></span><br><span class="line">kubectl describe pod webapp-deployment-666b67994b-5sffz -n web</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> å¯åŠ¨ register é•œåƒä»“åº“</span></span><br><span class="line">docker run -d -p 5000:5000 registry:2</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æäº¤é•œåƒ webapp åˆ°æœ¬åœ°é•œåƒä»“åº“</span></span><br><span class="line">docker tag webapp localhost:5000/webapp</span><br><span class="line">docker push localhost:5000/webapp</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> ä¿®æ”¹ deployment å¹¶é‡æ–°å¯åŠ¨</span></span><br><span class="line">kubectl delete deployment webapp-deployment -n web</span><br><span class="line">vim /home/admin/deployment.yml</span><br><span class="line">kubectl apply -f /home/admin/deployment.yml</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> å¼€æ”¾ç«¯å£</span></span><br><span class="line">kubectl port-forward deployments/webapp-deployment 8888 -n web &amp; </span><br></pre></td></tr></table></figure>

<h3 id="ã€postgresqlã€‘â€œHong-Kongâ€-canâ€™t-write-data-into-database"><a href="#ã€postgresqlã€‘â€œHong-Kongâ€-canâ€™t-write-data-into-database" class="headerlink" title="ã€postgresqlã€‘â€œHong-Kongâ€: canâ€™t write data into database."></a>ã€postgresqlã€‘<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/hongkong">â€œHong-Kongâ€: canâ€™t write data into database.</a></h3><p><img src="/2024/01/17/sadserver-intro/40.png" alt="é¢˜ç›®"></p>
<h4 id="é¢˜æ„-34"><a href="#é¢˜æ„-34" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h4><p>æœ¬åœ°å¯åŠ¨äº† postgresql ä½†æ— æ³•æ­£å¸¸è¿æ¥å’Œæ’å…¥æ•°æ®ï¼Œéœ€è¦ä» pg çš„å­˜å‚¨ç›®å½•é…ç½®å»åˆ†æåŸå› </p>
<h4 id="ç›¸å…³æŒ‡ä»¤-35"><a href="#ç›¸å…³æŒ‡ä»¤-35" class="headerlink" title="ç›¸å…³æŒ‡ä»¤"></a>ç›¸å…³æŒ‡ä»¤</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> æ£€æŸ¥æŒ‡ä»¤: å‘ pg ä¸­æ’å…¥ä¸€æ¡æ•°æ®</span></span><br><span class="line">sudo -u postgres psql -c &quot;insert into persons(name) values (&#x27;jane smith&#x27;);&quot; -d dt</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æ‰‹åŠ¨å¯åŠ¨ pg server å¹¶ç¡®è®¤æŠ¥é”™</span></span><br><span class="line">pg_ctlcluster 14 main restart -m fast</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹é…ç½®ä¸­çš„å­˜å‚¨ç›®å½•</span></span><br><span class="line">cat /etc/postgresql/14/main/postgresql.conf | grep data_directory</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> åˆ›å»ºæ•°æ®ç›®å½•å¹¶åˆå§‹åŒ–</span></span><br><span class="line">mkdir -p /opt/pgdata</span><br><span class="line">chown -R postgres:postgres /opt/pgdata</span><br><span class="line">su postgres -c &quot;/usr/lib/postgresql/14/bin/initdb -D /opt/pgdata/main&quot;</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> é‡å¯ pgsql</span></span><br><span class="line">systemctl restart postgresql</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> ä»æ—¥å¿—ç¡®è®¤å¯åŠ¨å¯åŠ¨æ˜¯å¦æ­£å¸¸</span></span><br><span class="line">tail -f /var/log/postgresql/postgresql-14-main.log</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> åˆ›å»ºåº“è¡¨</span></span><br><span class="line">sudo -u postgres psql -c &quot;create database dt&quot;</span><br><span class="line">sudo -u postgres psql -c &quot;CREATE TABLE persons(name varchar(100))&quot; -d dt</span><br></pre></td></tr></table></figure>

<h3 id="ã€æ¨èã€‘ã€linuxã€‘â€œPokharaâ€-SSH-and-other-sshenanigans"><a href="#ã€æ¨èã€‘ã€linuxã€‘â€œPokharaâ€-SSH-and-other-sshenanigans" class="headerlink" title="ã€æ¨èã€‘ã€linuxã€‘â€œPokharaâ€: SSH and other sshenanigans"></a>ã€æ¨èã€‘ã€linuxã€‘<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/pokhara">â€œPokharaâ€: SSH and other sshenanigans</a></h3><p><img src="/2024/01/17/sadserver-intro/41.png" alt="é¢˜ç›®"></p>
<h4 id="é¢˜æ„-35"><a href="#é¢˜æ„-35" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h4><p>æœ¬æœºå¯åŠ¨äº† sshdï¼Œä¸” client ç”¨æˆ·ä¸‹å·²ç»è®¾ç½®äº† ssh key ï¼Œ æœŸæœ›æ˜¯å¯ä»¥é€šè¿‡ ssh client@localhost å…å¯†è®¿é—®æœ¬æœºï¼Œä½†æ˜¯ç›®å‰ä¼šå¤±è´¥ï¼Œæ‰¾åˆ°è´¦å·å’Œ ssh ç›¸å…³çš„é—®é¢˜å¹¶è§£å†³</p>
<p>æ³¨: /home/client/.ssh/authorized_keys ä¸­å·²ç»æ·»åŠ äº†å…¬é’¥</p>
<p>æœ¬é¢˜æ¶‰åŠé¢å¾ˆå¹¿ï¼ŒåŒ…æ‹¬ ssh é…ç½®ã€linux ç”¨æˆ·é…ç½®ã€ç”¨æˆ·å¯ç”¨ç³»ç»Ÿèµ„æºé…ç½®ç­‰ï¼Œä½†æ•´ä½“éƒ½æ˜¯å›´ç»• su client å’Œ ssh client@localhost å¤±è´¥æ¥è§£å†³çš„ï¼Œå»ºè®®å®é™…è§£é¢˜æ—¶ï¼Œé€šè¿‡è¿™ä¸¤ä¸ªæŒ‡ä»¤æ‰§è¡Œçš„æŠ¥é”™ä¸€æ­¥æ­¥è§£å†³</p>
<h4 id="ç›¸å…³æŒ‡ä»¤-36"><a href="#ç›¸å…³æŒ‡ä»¤-36" class="headerlink" title="ç›¸å…³æŒ‡ä»¤"></a>ç›¸å…³æŒ‡ä»¤</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> åˆ‡æ¢ client ç”¨æˆ·</span></span><br><span class="line">su client</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> è§£å†³ <span class="string">&quot;Your account has expired; please contact your system administrator.&quot;</span> é—®é¢˜</span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># æŸ¥çœ‹ client ç”¨æˆ·çš„è¿‡æœŸæ—¶é—´</span></span></span><br><span class="line">chage -l client</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># è®¾ç½® client ç”¨æˆ·è¿‡æœŸæ—¶é—´</span></span></span><br><span class="line">chage -E 2024-12-31 client</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> è§£å†³ <span class="string">&quot;su: failed to execute /usr/sbin/nologin: Resource temporarily unavailable&quot;</span> é—®é¢˜</span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># æŸ¥çœ‹ç”¨æˆ·ç™»å½•ä¿¡æ¯ ï¼ˆç™»å½•è„šæœ¬ï¼‰</span></span></span><br><span class="line">lslogins client</span><br><span class="line"><span class="meta">#</span><span class="bash"> æˆ–: cat /etc/passwd | grep client</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> è®¾ç½®ç”¨æˆ·ç™»å½• shell ä¸º /bin/bash</span></span><br><span class="line">usermod --shell /bin/bash client</span><br><span class="line"><span class="meta">#</span><span class="bash"> æˆ–: sed -i <span class="string">&quot;s#/home/client:/usr/sbin/nologin#/home/client:/bin/bash#g&quot;</span> /etc/passwd</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æ£€æŸ¥æŒ‡ä»¤: ssh åˆ° client ç”¨æˆ·å¹¶æ‰§è¡Œ <span class="built_in">pwd</span></span></span><br><span class="line">ssh -v client@localhost &quot;pwd&quot;</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># è§£å†³ &quot;su: failed to execute /usr/sbin/nologin: Resource temporarily unavailable&quot; é—®é¢˜</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># https://access.redhat.com/solutions/30316</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># æŸ¥çœ‹æ–‡ä»¶æè¿°ç¬¦é…ç½® ï¼ˆéœ€è¦ä¿®æ”¹ï¼‰</span></span></span><br><span class="line">vim /etc/security/limits.conf</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> è§£å†³ ssh client é—®é¢˜</span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># https://askubuntu.com/a/343217</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># root ç”¨æˆ·ä¸‹ç”Ÿæˆsshå¯†é’¥å¯¹ï¼Œå¹¶æŠŠå…¬é’¥å†™å…¥ client çš„ authorized_keys ä¸­</span></span></span><br><span class="line">ssh-keygen</span><br><span class="line">cat ~/.ssh/id_rsa.pub &gt;&gt; /home/client/.ssh/authorized_keys</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># æ¸…ç©º known_hosts</span></span></span><br><span class="line">echo &quot;&quot; &gt; /home/client/.ssh/known_hosts</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> ä¿®æ­£ç§é’¥æ–‡ä»¶æƒé™</span></span><br><span class="line">chmod 600 /home/client/.ssh/*</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> åˆ é™¤ ssh é”™è¯¯é…ç½®å¹¶é‡å¯ sshd</span></span><br><span class="line">rm /etc/ssh/sshd_config.d/sad.conf</span><br><span class="line">systemctl restart sshd</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æœ€åï¼Œåˆ‡å› admin ç”¨æˆ·å¹¶æ‰§è¡Œ sshï¼Œä½¿å¾— known hosts è¢«åˆ·æ–°</span></span><br><span class="line">sudo -u client ssh client@localhost &#x27;pwd&#x27;</span><br></pre></td></tr></table></figure>

<h3 id="ã€linuxã€‘â€œRoseauâ€-Hack-a-Web-Server"><a href="#ã€linuxã€‘â€œRoseauâ€-Hack-a-Web-Server" class="headerlink" title="ã€linuxã€‘â€œRoseauâ€: Hack a Web Server"></a>ã€linuxã€‘<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/roseau">â€œRoseauâ€: Hack a Web Server</a></h3><p><img src="/2024/01/17/sadserver-intro/42.png" alt="é¢˜ç›®"></p>
<h4 id="é¢˜æ„-36"><a href="#é¢˜æ„-36" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h4><p>åœ¨æœ¬æœºçš„ apache web æœåŠ¡å™¨ä¸Šå­˜æœ‰ä¸€ä¸ªå¯†ç æ–‡ä»¶ï¼Œé€šè¿‡ zip æ–¹å¼åŠ å¯†å‹ç¼©ã€‚è¿™ä¸ªå‹ç¼©æ–‡ä»¶é€šè¿‡ admin ç”¨æˆ·æ— æ³•ç›´æ¥è®¿é—®ï¼Œéœ€è¦è°ƒç”¨ apache æ¥å£æ‹¿åˆ°ï¼Œç„¶è€Œ apache æ¥å£ä¹Ÿæ˜¯éœ€è¦å¯†ç ï¼ˆé…ç½®: AuthUserFileï¼‰ã€‚å› æ­¤éœ€è¦é€šè¿‡å¯†ç ç ´è§£å·¥å…· john åˆ†åˆ«ç ´è§£ apache çš„å¯†ç  ä»¥åŠ å‹ç¼©æ–‡ä»¶</p>
<p>æœ¬é¢˜ä¸»è¦æ˜¯ä»‹ç»æš´åŠ›ç ´è§£å·¥å…· <a target="_blank" rel="noopener" href="https://github.com/openwall/john">john</a> çš„ä½¿ç”¨ã€‚å®ƒçš„åŸç†ç®€å•æ¥è¯´æ˜¯é€šè¿‡ é¢„å…ˆå‡†å¤‡çš„è¯å…¸ã€å“ˆå¸Œå­—å…¸ï¼Œå¯¹ç‰¹å®šåŠ å¯†æ–¹å¼è¿›è¡Œç‰¹å®šçš„æš´åŠ›ç ´è§£</p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/395718068">å‚è€ƒ-ä½¿ç”¨John the ripperç ´è§£å¯†ç </a></p>
<h4 id="ç›¸å…³æŒ‡ä»¤-37"><a href="#ç›¸å…³æŒ‡ä»¤-37" class="headerlink" title="ç›¸å…³æŒ‡ä»¤"></a>ç›¸å…³æŒ‡ä»¤</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹ httpd é…ç½®ï¼ŒåŒ…æ‹¬æ ¹è·¯å¾„å’Œè®¤è¯æ–¹å¼</span></span><br><span class="line">cat /etc/apache2/sites-enabled/000-default.conf</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹ apache æ ¹è·¯å¾„ä¸‹çš„å‹ç¼©æ–‡ä»¶</span></span><br><span class="line">ls -l /var/www/html</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> ç ´è§£ httpd å¯†ç </span></span><br><span class="line">/home/admin/john/run/john /etc/apache2/.htpasswd</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> ä¸‹è½½ webfile æ–‡ä»¶</span></span><br><span class="line">curl localhost/webfile -u &quot;carlos:(è¿™é‡Œæ›¿æ¢æˆhttpdå¯†ç )&quot; --output secret</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> è§£å¯† secret ï¼ˆæ ¼å¼: zipï¼‰ å¯†ç </span></span><br><span class="line">/home/admin/john/run/zip2john secret &gt; zip.hash</span><br><span class="line">/home/admin/john/run/john zip.hash</span><br></pre></td></tr></table></figure>

<!--
curl localhost/webfile -u "carlos:chalet" --output secret
unzip -p andes
-->

<h3 id="ã€javaã€linuxã€‘â€œBelo-Horizonteâ€-A-Java-Enigma"><a href="#ã€javaã€linuxã€‘â€œBelo-Horizonteâ€-A-Java-Enigma" class="headerlink" title="ã€javaã€linuxã€‘â€œBelo-Horizonteâ€: A Java Enigma"></a>ã€javaã€linuxã€‘<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/belo-horizonte">â€œBelo-Horizonteâ€: A Java Enigma</a></h3><p><img src="/2024/01/17/sadserver-intro/43.png" alt="é¢˜ç›®"></p>
<h4 id="é¢˜æ„-37"><a href="#é¢˜æ„-37" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h4><p>Sad.class æ˜¯ä¸€æ®µ java ç¨‹åºï¼ŒæˆåŠŸæ‰§è¡Œåï¼Œä¼šæ‰“å°ä¸€æ®µé¢˜ç›®éœ€è¦çš„å¯†ç ï¼Œä½†å®ƒç›®å‰æ˜¯æ— æ³•æ‰§è¡Œçš„ï¼Œéœ€è¦é€šè¿‡åç¼–è¯‘ç­‰æ–¹æ³•è§£å†³</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/yu20190429/article/details/109050769">å‚è€ƒ: ä½¿ç”¨fallocateå‘½ä»¤åˆ›å»ºswapåˆ†åŒº</a></p>
<h4 id="ç›¸å…³æŒ‡ä»¤-38"><a href="#ç›¸å…³æŒ‡ä»¤-38" class="headerlink" title="ç›¸å…³æŒ‡ä»¤"></a>ç›¸å…³æŒ‡ä»¤</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> è¿è¡Œ class</span></span><br><span class="line">java Sad.class</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹ /usr/bin/java æŒ‡å‘çš„å®é™…çš„æ–‡ä»¶</span></span><br><span class="line">readlink -f /usr/bin/java</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹æœ¬æœºå®‰è£…çš„å…¶ä»–ç‰ˆæœ¬ java</span></span><br><span class="line">ls -l /usr/lib/jvm | grep java</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> å°† /usr/bin/java æŒ‡å‘æ–°çš„åœ°å€</span></span><br><span class="line">sudo rm /usr/bin/java</span><br><span class="line">sudo ln -s /usr/lib/jvm/java-1.17.0-openjdk-amd64/bin/java /usr/bin/java</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> åç¼–è¯‘ Sad.class</span></span><br><span class="line">javap -c -l Sad.class</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> é‡å‘½å</span></span><br><span class="line">mv Sad.class VerySad.class</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹æœ¬åœ°å†…å­˜ï¼ˆæ€»å‰©ä½™å†…å­˜åªæœ‰ 200m å·¦å³ï¼Œä¸è¶³ä»¥è¿è¡Œè¿›ç¨‹ï¼‰</span></span><br><span class="line">free -m</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹æœ¬åœ°ç£ç›˜ï¼ˆå¯ä»¥çœ‹åˆ°è‡³å°‘æœ‰4Gç©ºé—´ï¼‰</span></span><br><span class="line">df -h</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> ä»¥æœ¬åœ°ç£ç›˜ç”³è¯·äº¤æ¢ç©ºé—´</span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># ç”³è¯·1Gç©ºé—´</span></span></span><br><span class="line">sudo fallocate -l 1G /swapfile</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># è®¾ç½®æ–‡ä»¶æƒé™ä¸º600</span></span></span><br><span class="line">sudo chmod 600 /swapfile</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># å°†æ–‡ä»¶è®¾ç½®ä¸ºäº¤æ¢ç©ºé—´</span></span></span><br><span class="line">sudo mkswap /swapfile</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># å¯ç”¨äº¤æ¢æ–‡ä»¶</span></span></span><br><span class="line">sudo swapon /swapfile</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># æŸ¥çœ‹äº¤æ¢ç©ºé—´</span></span></span><br><span class="line">sudo swapon --show</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># å†æ¬¡æŸ¥çœ‹å†…å­˜</span></span></span><br><span class="line">free -m</span><br></pre></td></tr></table></figure>

<h3 id="ã€rabbitmqã€dockerã€‘â€œChennaiâ€-Pull-a-Rabbit-from-a-Hat"><a href="#ã€rabbitmqã€dockerã€‘â€œChennaiâ€-Pull-a-Rabbit-from-a-Hat" class="headerlink" title="ã€rabbitmqã€dockerã€‘â€œChennaiâ€: Pull a Rabbit from a Hat"></a>ã€rabbitmqã€dockerã€‘<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/chennai">â€œChennaiâ€: Pull a Rabbit from a Hat</a></h3><p><img src="/2024/01/17/sadserver-intro/44.png" alt="é¢˜ç›®"></p>
<h4 id="é¢˜æ„-38"><a href="#é¢˜æ„-38" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h4><p>åœ¨æœ¬åœ°çš„ rabbitmq-cluster-docker-master ç›®å½•ä¸‹ï¼Œæä¾›äº†å¯åŠ¨ rabbitmq ä¸‰èŠ‚ç‚¹é›†ç¾¤çš„ compose ä»“åº“ï¼ˆå‚è€ƒè¿™ä¸ª <a target="_blank" rel="noopener" href="https://github.com/serkodev/rabbitmq-cluster-docker">serkodev/rabbitmq-cluster-docker</a> ï¼‰ï¼Œéœ€è¦æ­£å¸¸å¯åŠ¨é›†ç¾¤ï¼Œå¹¶å…ˆåè¿è¡Œ <code>python3 ~/producer.py hello-lwc</code> å’Œ <code>python3 ~/consumer.py</code>ï¼Œå®Œæˆä¸€ä¸ªå®Œæ•´çš„ç”Ÿäº§å’Œæ¶ˆè´¹è¿‡ç¨‹</p>
<p>æ³¨æ„: è™½ç„¶ consumer.py å’Œ producer.py ä¸­ç¡®å®æœ‰ä¸€äº›è¿æ¥å‚æ•°ä¸å¤ªä¸€è‡´ï¼Œä½†é¢˜ç›®è¦æ±‚ä¸èƒ½ä¿®æ”¹è¿™ä¸¤ä¸ªä»£ç æ–‡ä»¶ï¼Œå¦åˆ™æ ¡éªŒç­”æ¡ˆä¼šå¤±è´¥ï¼Œå› æ­¤åªèƒ½é€šè¿‡è®¾ç½®ç¯å¢ƒå˜é‡çš„æ–¹å¼æ¥è§£å†³</p>
<h4 id="ç›¸å…³æŒ‡ä»¤-39"><a href="#ç›¸å…³æŒ‡ä»¤-39" class="headerlink" title="ç›¸å…³æŒ‡ä»¤"></a>ç›¸å…³æŒ‡ä»¤</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> é‡å¯ rabbitmq é›†ç¾¤</span></span><br><span class="line">docker compose down --volumes</span><br><span class="line">docker compose up -d</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> ä¿®æ”¹å¯åŠ¨è„šæœ¬æœ€åä¸€æ®µï¼Œtail ä¹‹å‰åˆ›å»ºä¸€ä¸ªç©ºæ—¥å¿—æ–‡ä»¶ï¼Œè§£å†³ tail æ‰§è¡Œå¤±è´¥å¯¼è‡´å¡ä½çš„é—®é¢˜</span></span><br><span class="line">touch /var/log/rabbitmq/empty.log</span><br><span class="line">vim cluster-entrypoint.sh</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹ .env æ–‡ä»¶ï¼ˆ compose é»˜è®¤ä½¿ç”¨çš„ç¯å¢ƒå˜é‡ ï¼‰ï¼Œå¹¶å°†å…¶ä¿®æ”¹ä¸º consumer.py ä¸­å†™æ­»çš„ç”¨æˆ·åå’Œå¯†ç </span></span><br><span class="line">cat ./.env</span><br><span class="line">export RABBITMQ_DEFAULT_USER=username</span><br><span class="line">export RABBITMQ_DEFAULT_PASS=password</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> è®¾ç½®ç¯å¢ƒå˜é‡å¹¶è§¦å‘ç”Ÿäº§è€…</span></span><br><span class="line">export RMQ_QUEUE=hello</span><br><span class="line">export RMQ_USER=username</span><br><span class="line">export RMQ_PASSWORD=password</span><br><span class="line">python3 ~/producer.py hello-lwc</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> è§¦å‘æ¶ˆè´¹è€…</span></span><br><span class="line">python3 ~/consumer.py</span><br></pre></td></tr></table></figure>

<!--
# æ·»åŠ ç”¨æˆ·
docker exec rabbitmq-cluster-docker-master-rabbitmq1-1 rabbitmqctl add_user username password

docker exec rabbitmq-cluster-docker-master-rabbitmq1-1 rabbitmqctl set_permissions -p / username ".*" ".*" ".*"

docker exec rabbitmq-cluster-docker-master-rabbitmq1-1 ls -l /var/log/rabbitmq/

docker exec rabbitmq-cluster-docker-master-rabbitmq1-1 find / -name 'rabbitmq.conf'

log.dir = /var/log/rabbitmq
-->

<h3 id="ã€gitã€linuxã€‘â€œMonacoâ€-Disappearing-Trick"><a href="#ã€gitã€linuxã€‘â€œMonacoâ€-Disappearing-Trick" class="headerlink" title="ã€gitã€linuxã€‘â€œMonacoâ€: Disappearing Trick"></a>ã€gitã€linuxã€‘<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/monaco">â€œMonacoâ€: Disappearing Trick</a></h3><p><img src="/2024/01/17/sadserver-intro/45.png" alt="é¢˜ç›®"></p>
<h4 id="é¢˜æ„-39"><a href="#é¢˜æ„-39" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h4><p>æœ¬åœ° 5000 ç«¯å£ä¸Šå¯åŠ¨äº†ä¸€ä¸ª web æœåŠ¡ï¼Œé€šè¿‡ post æ–¹æ³•æŒ‡å®šå¯†ç è°ƒç”¨å®ƒçš„æ¥å£åï¼Œä¼šè¿”å›ä¸€ä¸ªå¯†é’¥ï¼Œéœ€è¦æŠŠè¿™ä¸ªå¯†é’¥å†™å…¥ mysolution æ–‡ä»¶ä¸­</p>
<p>æ ¹æ®æç¤ºï¼Œå½“å‰è·¯å¾„æ˜¯ä¸€ä¸ªä»£ç å·¥ä½œè·¯å¾„ï¼Œâ€œé‚£ä¹ˆâ€ï¼ˆè™½ç„¶æ„Ÿè§‰è¿™ä¸ªæ¨ç†æœ‰ç‚¹ç‰µå¼ºï¼‰å¯ä»¥æ¨æµ‹æ˜¯ä¸€ä¸ª git è·¯å¾„ï¼Œä½†æ˜¯æœ¬åœ°å¹¶æ²¡æœ‰ä»£ç ï¼Œå¯ä»¥é€šè¿‡ git æŒ‡ä»¤æ¢å¤ webserver çš„ä»£ç ï¼Œç¡®è®¤å…¶éœ€è¦çš„å¯†ç æ˜¯åœ¨å“ªä¸ªç¯å¢ƒå˜é‡ä¸­å®šä¹‰çš„ï¼Œå¹¶åœ¨å·²å¯åŠ¨çš„ webserver è¿›ç¨‹ä¸­ï¼Œæ‰¾åˆ°å¯¹åº”çš„ç¯å¢ƒå˜é‡</p>
<h4 id="ç›¸å…³æŒ‡ä»¤-40"><a href="#ç›¸å…³æŒ‡ä»¤-40" class="headerlink" title="ç›¸å…³æŒ‡ä»¤"></a>ç›¸å…³æŒ‡ä»¤</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> æ¢å¤ git é¡¹ç›®ï¼ˆå³ï¼šé‡æ–°æ‹‰å–ä»£ç ï¼‰</span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># æ˜¾ç¤ºç›®å‰æ–‡ä»¶å·®å¼‚</span></span></span><br><span class="line">git status</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># æ¢å¤æŒ‡å®šæ–‡ä»¶</span></span></span><br><span class="line">git restore webserver_v1.py</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># æˆ–: æ¢å¤å½“å‰è·¯å¾„ä¸‹çš„æ‰€æœ‰æ–‡ä»¶</span></span></span><br><span class="line">git restore .</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹ webserver é€»è¾‘</span></span><br><span class="line">cat webserver_v1.py</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥æ‰¾ webserver_v1.py é…ç½®çš„å¯†ç ç›¸å…³çš„ç¯å¢ƒå˜é‡ï¼Œåœ¨å·²å¯åŠ¨çš„ webserver æœåŠ¡ä¸­å®šä¹‰çš„å€¼</span></span><br><span class="line">ps -ef | grep webserver.py | grep -v grep | awk &#x27;&#123;print $2&#125;&#x27; | xargs -I &#123;&#125; bash -c &quot;cat /proc/&#123;&#125;/environ&quot; | tr &#x27;\000&#x27; &#x27;\n&#x27; | grep &quot;(ç¯å¢ƒå˜é‡å)&quot;</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> è®¿é—® webserver å¹¶æŒ‡å®šå¯†ç ï¼Œå¹¶å°†å¾—åˆ°çš„ secret å†™å…¥ mysolution æ–‡ä»¶ä¸­</span></span><br><span class="line">secret=`curl -X POST localhost:5000 --data-raw &quot;password=(ä¸Šä¸€æ­¥å¾—åˆ°çš„å¯†ç )&quot; | sed &#x27;s/.* //g&#x27;`</span><br><span class="line">echo &quot;$secret&quot; &gt; ~/mysolution</span><br></pre></td></tr></table></figure>

<h3 id="ã€dockerã€‘â€œFlorenceâ€-Database-Migration-Hell"><a href="#ã€dockerã€‘â€œFlorenceâ€-Database-Migration-Hell" class="headerlink" title="ã€dockerã€‘â€œFlorenceâ€: Database Migration Hell"></a>ã€dockerã€‘<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/florence">â€œFlorenceâ€: Database Migration Hell</a></h3><p><img src="/2024/01/17/sadserver-intro/46.png" alt="é¢˜ç›®"></p>
<h4 id="é¢˜æ„-40"><a href="#é¢˜æ„-40" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h4><p>/home/admin/app/docker-compose.yml ä¸­å®šä¹‰äº†ä¸€ä¸ª nginx + nodejs + postgresql çš„åå°æœåŠ¡ï¼Œå…¶ä¸­ pgsql ä½œä¸ºæ•°æ®åº“ï¼›api æœåŠ¡è¿›è¡Œæ•°æ®åº“è®¿é—®ç”¨æˆ·çš„åˆå§‹åŒ–ï¼Œä»¥åŠæä¾›æ¥å£ï¼›api_aggregator å¯¹ pgsql è¿›è¡Œè®¿é—®æƒé™éªŒè¯ï¼›nginx æœåŠ¡æä¾›ä»£ç†å’Œ https æ¥å£ã€‚æ­£å¸¸çš„å¯åŠ¨å’Œåˆå§‹åŒ–é¡ºåºä¸º: pgsql -&gt; d</p>
<p>ç°åœ¨è¿™äº›æœåŠ¡çš„å¯åŠ¨å’Œè®¿é—®æœ‰é—®é¢˜ï¼Œéœ€è¦è§£å†³</p>
<h4 id="ç›¸å…³æŒ‡ä»¤-41"><a href="#ç›¸å…³æŒ‡ä»¤-41" class="headerlink" title="ç›¸å…³æŒ‡ä»¤"></a>ç›¸å…³æŒ‡ä»¤</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹ compose å®šä¹‰</span></span><br><span class="line">cat ~/app/docker-compose.yml</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹å¹¶ä¿®æ”¹ postgresql Dockerfileï¼Œä»¥è§£å†³ postgresql å®¹å™¨æ—¥å¿—ä¸­çš„ <span class="string">&quot;initdb: cannot be run as root&quot;</span> é—®é¢˜</span></span><br><span class="line">vim ~/app/postgresql/Dockerfile</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> é‡å¯å®¹å™¨å¹¶é‡æ–°æ„å»ºé•œåƒ</span></span><br><span class="line">docker compose down --volumes</span><br><span class="line">docker compose up --build -d</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æ·»åŠ  è§£å†³ api_aggregator è¿æ¥ pg å¤±è´¥çš„é—®é¢˜</span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># ç¬¬14è¡Œæ·»åŠ å†…å®¹</span></span></span><br><span class="line">sed -i &quot;14iecho \&quot;host all api_aggregator 0.0.0.0/0 md5\&quot; &gt;&gt; /var/lib/postgresql/data/pg_hba.conf&quot; ~/app/postgresql/entrypoint.sh</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> è§£å†³ api_aggregator å®¹å™¨æ—¥å¿—æç¤ºè¿æ¥ pgsql å¤±è´¥é—®é¢˜</span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># æŸ¥çœ‹ app æœåŠ¡å¯åŠ¨æ—¶å¯¹ pgsql çš„ migrations é€»è¾‘(go-pg/migrations.NewCollection.DiscoverSQLMigrations</span></span></span><br><span class="line">cat ~/app/api/pkg/db/db.go</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># æŸ¥çœ‹ api_aggregator æœåŠ¡æ‰€ç”¨çš„è´¦å·å’Œå¯†ç </span></span></span><br><span class="line">cat ~/app/docker-compose.yml | grep DATABASE_URL</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># è®¡ç®—å¯†ç çš„ md5 å€¼</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># æ³¨æ„è®¡ç®—æ–¹å¼: å¯†ç å’Œç”¨æˆ·åä¸€èµ·è®¡ç®—ï¼Œå‚è€ƒæºç  https://github.com/postgres/postgres/blob/REL_17_STABLE/src/interfaces/libpq/fe-auth.c#L732</span></span></span><br><span class="line">echo -n (ä¸Šä¸€æ­¥å¾—åˆ°çš„å¯†ç )(ä¸Šä¸€æ­¥å¾—åˆ°çš„ç”¨æˆ·å) | md5sum | awk &#x27;&#123;print $1&#125;&#x27;</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># åˆ›å»º api_aggregator è®¿é—®éœ€è¦çš„ç”¨æˆ·</span></span></span><br><span class="line">sed -i &quot;s/CREATE ROLE api_aggregator .*/CREATE ROLE api_aggregator LOGIN PASSWORD &#x27;(ä¸Šä¸€æ­¥è®¡ç®—å¾—åˆ°çš„md5å€¼)&#x27;;/g&quot; ~/app/api/migrations/1_users.up.sql</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># api æœåŠ¡ä¸­æ·»åŠ é€‚å½“ sleep ï¼Œé˜²æ­¢æ‰§è¡Œ migration æ—¶ pgsql è¿˜æœªå¯åŠ¨å¯¼è‡´æŠ¥é”™</span></span></span><br><span class="line">sed -i &quot;10i\&quot;time\&quot;&quot; ~/app/api/server.go</span><br><span class="line">sed -i &quot;14itime.Sleep(10 * time.Second)&quot; ~/app/api/server.go</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># api_aggregator æœåŠ¡ä¸­æ·»åŠ é€‚å½“ sleepï¼ŒåŸå› åŒä¸Š</span></span></span><br><span class="line">sed -i &quot;s#CMD node.*#CMD sleep 10; node /usr/src/app/index.js#g&quot; ~/app/api_aggregator/Dockerfile</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># æ³¨: æˆªæ­¢åˆ°è¿™ä¸€æ­¥ï¼Œé‡å¯å®¹å™¨å4ä¸ªå®¹å™¨åº”è¯¥çŠ¶æ€éƒ½æ˜¯æ­£å¸¸çš„äº†</span></span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> å°† sadserver.local åŸŸåæ˜ å°„åˆ°æœ¬åœ°(<span class="keyword">for</span> nginx)</span></span><br><span class="line">echo &quot;127.0.0.1 sadserver.local&quot; &gt;&gt; /etc/hosts</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> é‡æ–°ç”Ÿæˆè¯ä¹¦ï¼Œè§£å†³è¯ä¹¦è¿‡æœŸé—®é¢˜: curl: (60) SSL certificate problem: certificate has expired</span></span><br><span class="line">openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/nginx/certs/sadserver.key -out /etc/nginx/certs/sadserver.crt -subj &quot;/C=CN/ST=SZ/L=NS/O=Internet/OU=Company/CN=sadserver.local&quot;</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> é‡å¯ nginx</span></span><br><span class="line">systemctl restart nginx</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> éªŒè¯æ¥å£è®¿é—®</span></span><br><span class="line">curl --cacert /etc/nginx/certs/sadserver.crt https://sadserver.local</span><br></pre></td></tr></table></figure>

<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æœ€è¿‘çœ‹äº†ITç‹‚äººè¿™éƒ¨å‰§ï¼Œåˆšå¥½æƒ³åˆ°ï¼ŒITäººå¹³æ—¶çš„å·¥ä½œå¯èƒ½å¾ˆæ‚ï¼Œè¿™é‡Œæä¸€ç‚¹å¼€å‘ï¼Œé‚£é‡Œåšä¸€ç‚¹è¿ç»´ï¼Œç”šè‡³è¿˜æ²¡æœ‰ç¨‹åºé‚£æ ·æœ‰é€»è¾‘ï¼Œä½†ä»å¤–é¢æ¥çœ‹ï¼ŒITäººç¡®å®æ˜¯åœ¨åšå¾ˆå¤šäº‹æƒ…çš„ï¼Œåªæ˜¯ä»–ä»¬å¥½åƒåœ¨ä¸€ä¸ªé”ä¸Šçš„ç¤¼ç‰©ç›’é‚£æ ·ï¼Œä¸æ‰“å¼€å°±ä¸çŸ¥é“é‡Œé¢æœ‰ä»€ä¹ˆ</p>
<p>è¿™éƒ¨å‰§ï¼Œå’Œ sadserver è¿™ä¸ªè§£é¢˜å¹³å°ï¼Œéƒ½åƒæ˜¯æ‰“å¼€è¿™ä¸ªç›’å­çš„é’¥åŒ™</p>
<!--

æ•´ç†å®Œé¢˜ç›®ä¹‹ä½™ï¼Œå°±ä»¥ä¸€é¦–é€‚åˆå¤œæ™šçš„æ­Œæ›²ä½œä¸ºç»“æŸå§

ã€Šlittle girlã€‹

-->

<!--
ä¸æ˜¯æ‰€æœ‰ linux æŒ‡ä»¤éƒ½èƒ½ç»å¸¸ç”¨åˆ°ï¼Œä½†æ²¡æœ‰ä¸€ä¸ªæŒ‡ä»¤æ˜¯æ²¡æœ‰ç”¨çš„
-->

<!--
ä½œè€…æ¸©é¦¨æé†’: åšå®Œä¸€é“é¢˜ä¹‹åæœ€å¥½åŠæ—¶å…³é—­æœåŠ¡å™¨ï¼Œå¯ä»¥å¸®ä»–çœé’±

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo shutdown -h now</span><br></pre></td></tr></table></figure>

<p>æ›´æ–°: ç°åœ¨åšå®Œä¸€é“é¢˜åï¼Œåªè¦ check é€šè¿‡äº†ï¼Œä¼šè‡ªåŠ¨å…³é—­æœåŠ¡å™¨ã€‚ã€‚</p>
<p>â€“&gt;</p>
<!--

---- å½“å‰: åç»­å°†è¿™ç¯‡æ–‡ç« åœ¨ æ¨ å‘ï¼Œ@ ä¸€ä¸‹ï¼Œæœ‰ç‚¹æ„æ€ã€‚ã€‚ã€‚æœ‰æœºä¼šç¿»è¯‘æˆè‹±æ–‡

maybe I can translate it to english, when i am free...

-->

<!--

ä»Šå¤©çš„å¬ä¼šæ­Œ: æ­¤åˆ»å†™æœ¬æ–‡åœ¨å¬çš„æ­Œï¼Œä¹Ÿæ˜¯èº«è¾¹æªè¿·ç»™æˆ‘çš„ç¤¼ç‰©

-->

<!--
åç»­å‘ç°çš„æ–°é¢˜ç›®: https://sadservers.com/scenario/luc
--></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a href="mailto:xxx@gmail.com">smiecj</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a href="http://smiecj.github.io/2024/01/17/sadserver-intro/">http://smiecj.github.io/2024/01/17/sadserver-intro/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥è‡ª <a href="http://smiecj.github.io" target="_blank">Smiecjçš„å°çª</a>ï¼</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/linux/">linux</a><a class="post-meta__tags" href="/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/">æ“ä½œç³»ç»Ÿ</a><a class="post-meta__tags" href="/tags/life/">life</a></div><div class="post_share"><div class="social-share" data-image="/2024/01/17/sadserver-intro/cover.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/04/25/azkaban-tools/"><img class="prev-cover" src="/img/blog_img/azkaban.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">ä¸Šä¸€ç¯‡</div><div class="prev_info">azkaban-tools é¡¹ç›®ä»‹ç»</div></div></a></div><div class="next-post pull-right"><a href="/2023/12/06/program-100-qas/"><img class="next-cover" src="/2023/12/06/program-100-qas/cover.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info">äº’è”ç½‘ä¹‹100é—®</div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> è¯„è®º</span></div></div><div class="comment-wrap"><div><div id="gitalk-container"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://avatars.githubusercontent.com/u/14009307" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">smiecj</div><div class="author-info__description">å†™å†™ç”Ÿæ´»ï¼Œåšåšç¬”è®°ï¼ŒèŠèŠæ—¥å¸¸</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">44</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">40</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">28</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/smiecj"><i class="fab fa-github"></i><span>è®¿é—®ä¸»é¡µ</span></a></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®å½•</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%83%8C%E6%99%AF"><span class="toc-number">1.</span> <span class="toc-text">èƒŒæ™¯</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E5%88%86%E7%B1%BB"><span class="toc-number">2.</span> <span class="toc-text">é¢˜ç›®åˆ†ç±»</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E8%A7%A3%E9%A2%98"><span class="toc-number">3.</span> <span class="toc-text">å¦‚ä½•è§£é¢˜</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-%E7%AE%80%E5%8D%95"><span class="toc-number">4.</span> <span class="toc-text">Level: ç®€å•</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90linux%E3%80%91%E2%80%9CSaint-John%E2%80%9D-what-is-writing-to-this-log-file"><span class="toc-number">4.1.</span> <span class="toc-text">ã€linuxã€‘â€œSaint Johnâ€: what is writing to this log file?</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E6%84%8F"><span class="toc-number">4.1.1.</span> <span class="toc-text">é¢˜æ„</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4"><span class="toc-number">4.1.2.</span> <span class="toc-text">ç›¸å…³æŒ‡ä»¤</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E6%8E%A8%E8%8D%90%E3%80%91%E3%80%90linux%E3%80%91%E2%80%9CSaskatoon%E2%80%9D-counting-IPs"><span class="toc-number">4.2.</span> <span class="toc-text">ã€æ¨èã€‘ã€linuxã€‘â€œSaskatoonâ€: counting IPs.</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E6%84%8F-1"><span class="toc-number">4.2.1.</span> <span class="toc-text">é¢˜æ„</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4-1"><span class="toc-number">4.2.2.</span> <span class="toc-text">ç›¸å…³æŒ‡ä»¤</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E6%8E%A8%E8%8D%90%E3%80%91%E3%80%90linux%E3%80%91%E2%80%9CSantiago%E2%80%9D-Find-the-secret-combination"><span class="toc-number">4.3.</span> <span class="toc-text">ã€æ¨èã€‘ã€linuxã€‘â€œSantiagoâ€: Find the secret combination</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E6%84%8F-2"><span class="toc-number">4.3.1.</span> <span class="toc-text">é¢˜æ„</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4-2"><span class="toc-number">4.3.2.</span> <span class="toc-text">ç›¸å…³æŒ‡ä»¤</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#The-Command-Line-Murders"><span class="toc-number">4.4.</span> <span class="toc-text">The Command Line Murders</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E6%8E%A8%E8%8D%90%E3%80%91%E3%80%90linux%E3%80%91%E2%80%9CTaipei%E2%80%9D-Come-a-knocking"><span class="toc-number">4.5.</span> <span class="toc-text">ã€æ¨èã€‘ã€linuxã€‘â€œTaipeiâ€: Come a-knocking</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E6%84%8F-3"><span class="toc-number">4.5.1.</span> <span class="toc-text">é¢˜æ„</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4-3"><span class="toc-number">4.5.2.</span> <span class="toc-text">ç›¸å…³æŒ‡ä»¤</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E6%8E%A8%E8%8D%90%E3%80%91%E3%80%90linux%E3%80%91%E2%80%9CLhasa%E2%80%9D-Easy-Math"><span class="toc-number">4.6.</span> <span class="toc-text">ã€æ¨èã€‘ã€linuxã€‘â€œLhasaâ€: Easy Math</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E6%84%8F-4"><span class="toc-number">4.6.1.</span> <span class="toc-text">é¢˜æ„</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4-4"><span class="toc-number">4.6.2.</span> <span class="toc-text">ç›¸å…³æŒ‡ä»¤</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90postgresql%E3%80%91%E2%80%9CBucharest%E2%80%9D-Connecting-to-Postgres"><span class="toc-number">4.7.</span> <span class="toc-text">ã€postgresqlã€‘â€œBucharestâ€: Connecting to Postgres</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E6%84%8F-5"><span class="toc-number">4.7.1.</span> <span class="toc-text">é¢˜æ„</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4-5"><span class="toc-number">4.7.2.</span> <span class="toc-text">ç›¸å…³æŒ‡ä»¤</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90kubernetes%E3%80%91%E2%80%9CBilbao%E2%80%9D-Basic-Kubernetes-Problems"><span class="toc-number">4.8.</span> <span class="toc-text">ã€kubernetesã€‘â€œBilbaoâ€: Basic Kubernetes Problems</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E6%84%8F-6"><span class="toc-number">4.8.1.</span> <span class="toc-text">é¢˜æ„</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4-6"><span class="toc-number">4.8.2.</span> <span class="toc-text">ç›¸å…³æŒ‡ä»¤</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90linux%E3%80%91%E2%80%9CApia%E2%80%9D-Needle-in-a-Haystack"><span class="toc-number">4.9.</span> <span class="toc-text">ã€linuxã€‘â€œApiaâ€: Needle in a Haystack</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E6%84%8F-7"><span class="toc-number">4.9.1.</span> <span class="toc-text">é¢˜æ„</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4-7"><span class="toc-number">4.9.2.</span> <span class="toc-text">ç›¸å…³æŒ‡ä»¤</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%AD%E7%AD%89"><span class="toc-number">5.</span> <span class="toc-text">ä¸­ç­‰</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90postgresql%E3%80%91%E2%80%9CManhattan%E2%80%9D-can%E2%80%99t-write-data-into-database"><span class="toc-number">5.1.</span> <span class="toc-text">ã€postgresqlã€‘â€œManhattanâ€: canâ€™t write data into database.</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E6%84%8F-8"><span class="toc-number">5.1.1.</span> <span class="toc-text">é¢˜æ„</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4-8"><span class="toc-number">5.1.2.</span> <span class="toc-text">ç›¸å…³æŒ‡ä»¤</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E6%8E%A8%E8%8D%90%E3%80%91%E3%80%90httpd%E3%80%81linux%E3%80%91%E2%80%9CTokyo%E2%80%9D-can%E2%80%99t-serve-web-file"><span class="toc-number">5.2.</span> <span class="toc-text">ã€æ¨èã€‘ã€httpdã€linuxã€‘â€œTokyoâ€: canâ€™t serve web file</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E6%84%8F-9"><span class="toc-number">5.2.1.</span> <span class="toc-text">é¢˜æ„</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4-9"><span class="toc-number">5.2.2.</span> <span class="toc-text">ç›¸å…³æŒ‡ä»¤</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90nginx%E3%80%91%E2%80%9CCape-Town%E2%80%9D-Borked-Nginx"><span class="toc-number">5.3.</span> <span class="toc-text">ã€nginxã€‘â€œCape Townâ€: Borked Nginx</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E6%84%8F-10"><span class="toc-number">5.3.1.</span> <span class="toc-text">é¢˜æ„</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4-10"><span class="toc-number">5.3.2.</span> <span class="toc-text">ç›¸å…³æŒ‡ä»¤</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90docker%E3%80%91%E2%80%9CSalta%E2%80%9D-Docker-container-won%E2%80%99t-start"><span class="toc-number">5.4.</span> <span class="toc-text">ã€dockerã€‘â€œSaltaâ€: Docker container wonâ€™t start.</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E6%84%8F-11"><span class="toc-number">5.4.1.</span> <span class="toc-text">é¢˜æ„</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4-11"><span class="toc-number">5.4.2.</span> <span class="toc-text">ç›¸å…³æŒ‡ä»¤</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90linux%E3%80%91%E2%80%9COaxaca%E2%80%9D-Close-an-Open-File"><span class="toc-number">5.5.</span> <span class="toc-text">ã€linuxã€‘â€œOaxacaâ€: Close an Open File</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E6%84%8F-12"><span class="toc-number">5.5.1.</span> <span class="toc-text">é¢˜æ„</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4-12"><span class="toc-number">5.5.2.</span> <span class="toc-text">ç›¸å…³æŒ‡ä»¤</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90nginx%E3%80%81gunicorn%E3%80%91%E2%80%9CMelbourne%E2%80%9D-WSGI-with-Gunicorn"><span class="toc-number">5.6.</span> <span class="toc-text">ã€nginxã€gunicornã€‘â€œMelbourneâ€: WSGI with Gunicorn</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E6%84%8F-13"><span class="toc-number">5.6.1.</span> <span class="toc-text">é¢˜æ„</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4-13"><span class="toc-number">5.6.2.</span> <span class="toc-text">ç›¸å…³æŒ‡ä»¤</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90etcd%E3%80%81linux%E3%80%91%E2%80%9CLisbon%E2%80%9D-etcd-SSL-cert-troubles"><span class="toc-number">5.7.</span> <span class="toc-text">ã€etcdã€linuxã€‘â€œLisbonâ€: etcd SSL cert troubles</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E6%84%8F-14"><span class="toc-number">5.7.1.</span> <span class="toc-text">é¢˜æ„</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4-14"><span class="toc-number">5.7.2.</span> <span class="toc-text">ç›¸å…³æŒ‡ä»¤</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E6%8E%A8%E8%8D%90%E3%80%91%E3%80%90linux%E3%80%91%E2%80%9CKihei%E2%80%9D-Surely-Not-Another-Disk-Space-Scenario"><span class="toc-number">5.8.</span> <span class="toc-text">ã€æ¨èã€‘ã€linuxã€‘â€œKiheiâ€: Surely Not Another Disk Space Scenario</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E6%84%8F-15"><span class="toc-number">5.8.1.</span> <span class="toc-text">é¢˜æ„</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4-15"><span class="toc-number">5.8.2.</span> <span class="toc-text">ç›¸å…³æŒ‡ä»¤</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90linux%E3%80%91%E2%80%9CUnimak-Island%E2%80%9D-Fun-with-Mr-Jason"><span class="toc-number">5.9.</span> <span class="toc-text">ã€linuxã€‘â€œUnimak Islandâ€: Fun with Mr Jason</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E6%84%8F-16"><span class="toc-number">5.9.1.</span> <span class="toc-text">é¢˜æ„</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4-16"><span class="toc-number">5.9.2.</span> <span class="toc-text">ç›¸å…³æŒ‡ä»¤</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90python%E3%80%81go%E3%80%91%E2%80%9CIvujivik%E2%80%9D-Parlez-vous-Francais"><span class="toc-number">5.10.</span> <span class="toc-text">ã€pythonã€goã€‘â€œIvujivikâ€: Parlez-vous FranÃ§ais?</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E6%84%8F-17"><span class="toc-number">5.10.1.</span> <span class="toc-text">é¢˜æ„</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4-17"><span class="toc-number">5.10.2.</span> <span class="toc-text">ç›¸å…³æŒ‡ä»¤</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90linux%E3%80%91%E2%80%9CParis%E2%80%9D-Where-is-my-webserver"><span class="toc-number">5.11.</span> <span class="toc-text">ã€linuxã€‘â€œParisâ€: Where is my webserver?</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E6%84%8F-18"><span class="toc-number">5.11.1.</span> <span class="toc-text">é¢˜æ„</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4-18"><span class="toc-number">5.11.2.</span> <span class="toc-text">ç›¸å…³æŒ‡ä»¤</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90kubernetes%E3%80%91%E2%80%9CBuenos-Aires%E2%80%9D-Kubernetes-Pod-Crashing"><span class="toc-number">5.12.</span> <span class="toc-text">ã€kubernetesã€‘â€œBuenos Airesâ€: Kubernetes Pod Crashing</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E6%84%8F-19"><span class="toc-number">5.12.1.</span> <span class="toc-text">é¢˜æ„</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4-19"><span class="toc-number">5.12.2.</span> <span class="toc-text">ç›¸å…³æŒ‡ä»¤</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90haproxy%E3%80%81docker%E3%80%91%E2%80%9CTarifa%E2%80%9D-Between-Two-Seas"><span class="toc-number">5.13.</span> <span class="toc-text">ã€haproxyã€dockerã€‘â€œTarifaâ€: Between Two Seas</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E6%84%8F-20"><span class="toc-number">5.13.1.</span> <span class="toc-text">é¢˜æ„</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4-20"><span class="toc-number">5.13.2.</span> <span class="toc-text">ç›¸å…³æŒ‡ä»¤</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E6%8E%A8%E8%8D%90%E3%80%91%E3%80%90sqlite%E3%80%91%E2%80%9CMarrakech%E2%80%9D-Word-Histogram"><span class="toc-number">5.14.</span> <span class="toc-text">ã€æ¨èã€‘ã€sqliteã€‘â€œMarrakechâ€: Word Histogram</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E6%84%8F-21"><span class="toc-number">5.14.1.</span> <span class="toc-text">é¢˜æ„</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4-21"><span class="toc-number">5.14.2.</span> <span class="toc-text">ç›¸å…³æŒ‡ä»¤</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90mysql%E3%80%91%E2%80%9CRosario%E2%80%9D-Restore-a-MySQL-database"><span class="toc-number">5.15.</span> <span class="toc-text">ã€mysqlã€‘â€œRosarioâ€: Restore a MySQL database</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4-22"><span class="toc-number">5.15.1.</span> <span class="toc-text">ç›¸å…³æŒ‡ä»¤</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90mysql%E3%80%91%E2%80%9CAbaokoro%E2%80%9D-Restore-MySQL-Databases-Spooked-by-a-Ghost"><span class="toc-number">5.16.</span> <span class="toc-text">ã€mysqlã€‘â€œAbaokoroâ€: Restore MySQL Databases Spooked by a Ghost</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E6%84%8F-22"><span class="toc-number">5.16.1.</span> <span class="toc-text">é¢˜æ„</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4-23"><span class="toc-number">5.16.2.</span> <span class="toc-text">ç›¸å…³æŒ‡ä»¤</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90k8s%E3%80%81helm%E3%80%91%E2%80%9CPoznan%E2%80%9D-Helm-Chart-Issue-in-Kubernetes"><span class="toc-number">5.17.</span> <span class="toc-text">ã€k8sã€helmã€‘â€œPoznaÅ„â€: Helm Chart Issue in Kubernetes</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90linux%E3%80%91%E2%80%9CManado%E2%80%9D-How-much-do-you-press"><span class="toc-number">5.18.</span> <span class="toc-text">ã€linuxã€‘â€œManadoâ€: How much do you press?</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E6%84%8F-23"><span class="toc-number">5.18.1.</span> <span class="toc-text">é¢˜æ„</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4-24"><span class="toc-number">5.18.2.</span> <span class="toc-text">ç›¸å…³æŒ‡ä»¤</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90docker%E3%80%81golang%E3%80%91%E2%80%9CWarsaw%E2%80%9D-Prometheus-can%E2%80%99t-scrape-the-webserver"><span class="toc-number">5.19.</span> <span class="toc-text">ã€dockerã€golangã€‘â€œWarsawâ€: Prometheus canâ€™t scrape the webserver</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E6%84%8F-24"><span class="toc-number">5.19.1.</span> <span class="toc-text">é¢˜æ„</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4-25"><span class="toc-number">5.19.2.</span> <span class="toc-text">ç›¸å…³æŒ‡ä»¤</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%80%9CMoyogalpa%E2%80%9D-Security-Snag-The-Trials-of-Mary-and-John"><span class="toc-number">5.20.</span> <span class="toc-text">â€œMoyogalpaâ€: Security Snag. The Trials of Mary and John</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E6%84%8F-25"><span class="toc-number">5.20.1.</span> <span class="toc-text">é¢˜æ„</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4-26"><span class="toc-number">5.20.2.</span> <span class="toc-text">ç›¸å…³æŒ‡ä»¤</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90postgresql%E3%80%91%E2%80%9CHelsingor%E2%80%9D-The-first-walls-of-postgres-physical-replication"><span class="toc-number">5.21.</span> <span class="toc-text">ã€postgresqlã€‘â€œHelsingÃ¸râ€: The first walls of postgres physical replication</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E6%84%8F-26"><span class="toc-number">5.21.1.</span> <span class="toc-text">é¢˜æ„</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4-27"><span class="toc-number">5.21.2.</span> <span class="toc-text">ç›¸å…³æŒ‡ä»¤</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90WSGI%E3%80%91%E2%80%9CBekasi%E2%80%9D-Supervisor-is-still-around"><span class="toc-number">5.22.</span> <span class="toc-text">ã€WSGIã€‘â€œBekasiâ€: Supervisor is still around</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E6%84%8F-27"><span class="toc-number">5.22.1.</span> <span class="toc-text">é¢˜æ„</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4-28"><span class="toc-number">5.22.2.</span> <span class="toc-text">ç›¸å…³æŒ‡ä»¤</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90nginx%E3%80%91%E2%80%9CDepok%E2%80%9D-Nginx-with-Brotli"><span class="toc-number">5.23.</span> <span class="toc-text">ã€nginxã€‘â€œDepokâ€: Nginx with Brotli</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E6%84%8F-28"><span class="toc-number">5.23.1.</span> <span class="toc-text">é¢˜æ„</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4-29"><span class="toc-number">5.23.2.</span> <span class="toc-text">ç›¸å…³æŒ‡ä»¤</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90linux%E3%80%91%E2%80%9CTukaani%E2%80%9D-XZ-LZMA-Library-Compromised"><span class="toc-number">5.24.</span> <span class="toc-text">ã€linuxã€‘â€œTukaaniâ€: XZ LZMA Library Compromised</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E6%84%8F-29"><span class="toc-number">5.24.1.</span> <span class="toc-text">é¢˜æ„</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4-30"><span class="toc-number">5.24.2.</span> <span class="toc-text">ç›¸å…³æŒ‡ä»¤</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%B0%E9%9A%BE"><span class="toc-number">6.</span> <span class="toc-text">å›°éš¾</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90linux%E3%80%91%E2%80%9CJakarta%E2%80%9D-it%E2%80%99s-always-DNS"><span class="toc-number">6.1.</span> <span class="toc-text">ã€linuxã€‘â€œJakartaâ€: itâ€™s always DNS.</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E6%84%8F-30"><span class="toc-number">6.1.1.</span> <span class="toc-text">é¢˜æ„</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4-31"><span class="toc-number">6.1.2.</span> <span class="toc-text">ç›¸å…³æŒ‡ä»¤</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90wordpress%E3%80%81docker%E3%80%91%E2%80%9CBern%E2%80%9D-Docker-web-container-can%E2%80%99t-connect-to-db-container"><span class="toc-number">6.2.</span> <span class="toc-text">ã€wordpressã€dockerã€‘â€œBernâ€: Docker web container canâ€™t connect to db container.</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E6%84%8F-31"><span class="toc-number">6.2.1.</span> <span class="toc-text">é¢˜æ„</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4-32"><span class="toc-number">6.2.2.</span> <span class="toc-text">ç›¸å…³æŒ‡ä»¤</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E6%8E%A8%E8%8D%90%E3%80%91%E3%80%90linux%E3%80%91%E2%80%9CKarakorum%E2%80%9D-WTFIT-%E2%80%93-What-The-Fun-Is-This"><span class="toc-number">6.3.</span> <span class="toc-text">ã€æ¨èã€‘ã€linuxã€‘â€œKarakorumâ€: WTFIT â€“ What The Fun Is This?</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E6%84%8F-32"><span class="toc-number">6.3.1.</span> <span class="toc-text">é¢˜æ„</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4-33"><span class="toc-number">6.3.2.</span> <span class="toc-text">ç›¸å…³æŒ‡ä»¤</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90kubernetes%E3%80%91%E2%80%9CSingara%E2%80%9D-Docker-and-Kubernetes-web-app-not-working"><span class="toc-number">6.4.</span> <span class="toc-text">ã€kubernetesã€‘â€œSingaraâ€: Docker and Kubernetes web app not working.</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E6%84%8F-33"><span class="toc-number">6.4.1.</span> <span class="toc-text">é¢˜æ„</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4-34"><span class="toc-number">6.4.2.</span> <span class="toc-text">ç›¸å…³æŒ‡ä»¤</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90postgresql%E3%80%91%E2%80%9CHong-Kong%E2%80%9D-can%E2%80%99t-write-data-into-database"><span class="toc-number">6.5.</span> <span class="toc-text">ã€postgresqlã€‘â€œHong-Kongâ€: canâ€™t write data into database.</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E6%84%8F-34"><span class="toc-number">6.5.1.</span> <span class="toc-text">é¢˜æ„</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4-35"><span class="toc-number">6.5.2.</span> <span class="toc-text">ç›¸å…³æŒ‡ä»¤</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E6%8E%A8%E8%8D%90%E3%80%91%E3%80%90linux%E3%80%91%E2%80%9CPokhara%E2%80%9D-SSH-and-other-sshenanigans"><span class="toc-number">6.6.</span> <span class="toc-text">ã€æ¨èã€‘ã€linuxã€‘â€œPokharaâ€: SSH and other sshenanigans</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E6%84%8F-35"><span class="toc-number">6.6.1.</span> <span class="toc-text">é¢˜æ„</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4-36"><span class="toc-number">6.6.2.</span> <span class="toc-text">ç›¸å…³æŒ‡ä»¤</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90linux%E3%80%91%E2%80%9CRoseau%E2%80%9D-Hack-a-Web-Server"><span class="toc-number">6.7.</span> <span class="toc-text">ã€linuxã€‘â€œRoseauâ€: Hack a Web Server</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E6%84%8F-36"><span class="toc-number">6.7.1.</span> <span class="toc-text">é¢˜æ„</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4-37"><span class="toc-number">6.7.2.</span> <span class="toc-text">ç›¸å…³æŒ‡ä»¤</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90java%E3%80%81linux%E3%80%91%E2%80%9CBelo-Horizonte%E2%80%9D-A-Java-Enigma"><span class="toc-number">6.8.</span> <span class="toc-text">ã€javaã€linuxã€‘â€œBelo-Horizonteâ€: A Java Enigma</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E6%84%8F-37"><span class="toc-number">6.8.1.</span> <span class="toc-text">é¢˜æ„</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4-38"><span class="toc-number">6.8.2.</span> <span class="toc-text">ç›¸å…³æŒ‡ä»¤</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90rabbitmq%E3%80%81docker%E3%80%91%E2%80%9CChennai%E2%80%9D-Pull-a-Rabbit-from-a-Hat"><span class="toc-number">6.9.</span> <span class="toc-text">ã€rabbitmqã€dockerã€‘â€œChennaiâ€: Pull a Rabbit from a Hat</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E6%84%8F-38"><span class="toc-number">6.9.1.</span> <span class="toc-text">é¢˜æ„</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4-39"><span class="toc-number">6.9.2.</span> <span class="toc-text">ç›¸å…³æŒ‡ä»¤</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90git%E3%80%81linux%E3%80%91%E2%80%9CMonaco%E2%80%9D-Disappearing-Trick"><span class="toc-number">6.10.</span> <span class="toc-text">ã€gitã€linuxã€‘â€œMonacoâ€: Disappearing Trick</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E6%84%8F-39"><span class="toc-number">6.10.1.</span> <span class="toc-text">é¢˜æ„</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4-40"><span class="toc-number">6.10.2.</span> <span class="toc-text">ç›¸å…³æŒ‡ä»¤</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90docker%E3%80%91%E2%80%9CFlorence%E2%80%9D-Database-Migration-Hell"><span class="toc-number">6.11.</span> <span class="toc-text">ã€dockerã€‘â€œFlorenceâ€: Database Migration Hell</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E6%84%8F-40"><span class="toc-number">6.11.1.</span> <span class="toc-text">é¢˜æ„</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4-41"><span class="toc-number">6.11.2.</span> <span class="toc-text">ç›¸å…³æŒ‡ä»¤</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">7.</span> <span class="toc-text">æ€»ç»“</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>æœ€æ–°æ–‡ç« </span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2024/04/25/azkaban-tools/" title="azkaban-tools é¡¹ç›®ä»‹ç»"><img src="/img/blog_img/azkaban.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="azkaban-tools é¡¹ç›®ä»‹ç»"/></a><div class="content"><a class="title" href="/2024/04/25/azkaban-tools/" title="azkaban-tools é¡¹ç›®ä»‹ç»">azkaban-tools é¡¹ç›®ä»‹ç»</a><time datetime="2024-04-24T16:00:00.000Z" title="å‘è¡¨äº 2024-04-25 00:00:00">2024-04-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/01/17/sadserver-intro/" title="make sadservers happy again"><img src="/2024/01/17/sadserver-intro/cover.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="make sadservers happy again"/></a><div class="content"><a class="title" href="/2024/01/17/sadserver-intro/" title="make sadservers happy again">make sadservers happy again</a><time datetime="2024-01-16T16:00:00.000Z" title="å‘è¡¨äº 2024-01-17 00:00:00">2024-01-17</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/12/06/program-100-qas/" title="äº’è”ç½‘ä¹‹100é—®"><img src="/2023/12/06/program-100-qas/cover.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="äº’è”ç½‘ä¹‹100é—®"/></a><div class="content"><a class="title" href="/2023/12/06/program-100-qas/" title="äº’è”ç½‘ä¹‹100é—®">äº’è”ç½‘ä¹‹100é—®</a><time datetime="2023-12-05T16:00:00.000Z" title="å‘è¡¨äº 2023-12-06 00:00:00">2023-12-06</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/10/31/emr-mongo-to-hive/" title="mongodbæ•°æ®åŒæ­¥åˆ°hive"><img src="/2023/10/31/emr-mongo-to-hive/mongo.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="mongodbæ•°æ®åŒæ­¥åˆ°hive"/></a><div class="content"><a class="title" href="/2023/10/31/emr-mongo-to-hive/" title="mongodbæ•°æ®åŒæ­¥åˆ°hive">mongodbæ•°æ®åŒæ­¥åˆ°hive</a><time datetime="2023-10-30T16:00:00.000Z" title="å‘è¡¨äº 2023-10-31 00:00:00">2023-10-31</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/10/23/golang-origin/" title="go è¯­è¨€ä»‹ç»"><img src="/2023/10/23/golang-origin/golang.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="go è¯­è¨€ä»‹ç»"/></a><div class="content"><a class="title" href="/2023/10/23/golang-origin/" title="go è¯­è¨€ä»‹ç»">go è¯­è¨€ä»‹ç»</a><time datetime="2023-10-22T16:00:00.000Z" title="å‘è¡¨äº 2023-10-23 00:00:00">2023-10-23</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2021 - 2024 By smiecj</div><div class="framework-info"><span>æ¡†æ¶ </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>ä¸»é¢˜ </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="darkmode" type="button" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢"><i class="fas fa-adjust"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="ç›´è¾¾è¯„è®º"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">æœ¬åœ°æœç´¢</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="æœç´¢æ–‡ç« " type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>function addGitalkSource () {
  const ele = document.createElement('link')
  ele.rel = 'stylesheet'
  ele.href= 'https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css'
  document.getElementsByTagName('head')[0].appendChild(ele)
}

function loadGitalk () {
  function initGitalk () {
    var gitalk = new Gitalk(Object.assign({
      clientID: '40d352b09238233a6c88',
      clientSecret: 'db953d71dbaf0d65873a7ace2e60635fd475285a',
      repo: 'smiecj.github.io',
      owner: 'smiecj',
      admin: ['smiecj'],
      id: '2144fa0d7d99d187890071cb3acd02e8',
      updateCountCallback: commentCount
    },null))

    gitalk.render('gitalk-container')
  }

  if (typeof Gitalk === 'function') initGitalk()
  else {
    addGitalkSource()
    getScript('https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.js').then(initGitalk)
  }
}

function commentCount(n){
  let isCommentCount = document.querySelector('#post-meta .gitalk-comment-count')
  if (isCommentCount) {
    isCommentCount.innerHTML= n
  }
}

if ('Gitalk' === 'Gitalk' || !true) {
  if (true) btf.loadComment(document.getElementById('gitalk-container'), loadGitalk)
  else loadGitalk()
} else {
  function loadOtherComment () {
    loadGitalk()
  }
}</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>