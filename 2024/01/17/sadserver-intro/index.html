<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>make sadservers happy again | Smiecj的小窝</title><meta name="keywords" content="linux,操作系统,life"><meta name="author" content="smiecj,xxx@gmail.com"><meta name="copyright" content="smiecj"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="sadserver 刷题记录">
<meta property="og:type" content="article">
<meta property="og:title" content="make sadservers happy again">
<meta property="og:url" content="http://smiecj.github.io/2024/01/17/sadserver-intro/index.html">
<meta property="og:site_name" content="Smiecj的小窝">
<meta property="og:description" content="sadserver 刷题记录">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://smiecj.github.io/2024/01/17/sadserver-intro/cover.png">
<meta property="article:published_time" content="2024-01-16T16:00:00.000Z">
<meta property="article:modified_time" content="2024-07-15T16:00:00.000Z">
<meta property="article:author" content="smiecj">
<meta property="article:tag" content="linux">
<meta property="article:tag" content="操作系统">
<meta property="article:tag" content="life">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://smiecj.github.io/2024/01/17/sadserver-intro/cover.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://smiecj.github.io/2024/01/17/sadserver-intro/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'make sadservers happy again',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-07-16 00:00:00'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
    const detectApple = () => {
      if (GLOBAL_CONFIG_SITE.isHome && /iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="Smiecj的小窝" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://avatars.githubusercontent.com/u/14009307" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">44</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">40</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">28</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 文章</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/2024/01/17/sadserver-intro/cover.png')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Smiecj的小窝</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 文章</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">make sadservers happy again</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-01-16T16:00:00.000Z" title="发表于 2024-01-17 00:00:00">2024-01-17</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-07-15T16:00:00.000Z" title="更新于 2024-07-16 00:00:00">2024-07-16</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/">操作系统</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="make sadservers happy again"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/smiecj/p/18306958">本文 cnblog 博客地址</a></p>
<h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>从 <a target="_blank" rel="noopener" href="https://www.ruanyifeng.com/blog/2022/11/weekly-issue-230.html">阮一峰老师的博客</a> 了解到 <a target="_blank" rel="noopener" href="https://sadservers.com/">sadserver</a> 这样一个可以提供 linux 服务器，并尝试解决系统和服务相关问题的在线测试平台。非常难得的是它可以直接提供一个公网的linux服务器（一般40-60分钟后会自动销毁），你可以在上面做任何探索。对于想要学习常用 linux 指令的同学，是一个非常不错的练手平台</p>
<p>sadserver 大部分题目都是免费的，46道题中11道需要会员，会员一个月5美元。可以在完成其他题目之后再小小氪💰一下挑战剩下的题目</p>
<p>本文整理了目前sadserver所有题目的分类和解题相关指令，带部分“剧透”，建议对题目本身有强烈兴趣的同学直接动手尝试</p>
<p>*推荐: 标注推荐的主要是和 linux 常用指令相关的题目，其他开源服务相关的题目可以选择性了解</p>
<p>*提醒: 部分题目需要root用户权限，以执行系统配置修改等相关指令，可通过<code>sudo su</code>指令提权</p>
<h2 id="题目分类"><a href="#题目分类" class="headerlink" title="题目分类"></a>题目分类</h2><table>
<thead>
<tr>
<th>题目</th>
<th>类型/相关服务</th>
<th>题目/问题概述</th>
<th>相关指令</th>
</tr>
</thead>
<tbody><tr>
<td>“Saint John”: what is writing to this log file?</td>
<td>linux</td>
<td>查找文件占用的进程</td>
<td>lsof, find</td>
</tr>
<tr>
<td><strong>“Saskatoon”: counting IPs. (推荐)</strong></td>
<td>linux</td>
<td>字符串计数</td>
<td>awk, uniq, sort</td>
</tr>
<tr>
<td>“Santiago”: Find the secret combination (推荐)</td>
<td>linux</td>
<td>文本内容过滤</td>
<td>grep</td>
</tr>
<tr>
<td><strong>“Taipei”: Come a-knocking (推荐)</strong></td>
<td>linux</td>
<td>knock 端口开放</td>
<td>knocked</td>
</tr>
<tr>
<td><strong>“Lhasa”: Easy Math (推荐)</strong></td>
<td>linux</td>
<td>数值计算</td>
<td>bc</td>
</tr>
<tr>
<td>“Bucharest”: Connecting to Postgres</td>
<td>postgresql</td>
<td>pgsql配置修复</td>
<td></td>
</tr>
<tr>
<td>“Bilbao”: Basic Kubernetes Problems</td>
<td>kubernetes</td>
<td>服务配置修复</td>
<td>kubectl</td>
</tr>
<tr>
<td>“Apia”: Needle in a Haystack</td>
<td>linux</td>
<td>文本比较</td>
<td>diff</td>
</tr>
<tr>
<td>“Manhattan”: can’t write data into database.</td>
<td>postgresql</td>
<td>pgsql 配置修复</td>
<td></td>
</tr>
<tr>
<td><strong>“Tokyo”: can’t serve web file (推荐)</strong></td>
<td>httpd, linux</td>
<td>httpd 配置修复</td>
<td>iptables</td>
</tr>
<tr>
<td>“Cape Town”: Borked Nginx</td>
<td>nginx</td>
<td>nginx 配置修复</td>
<td>systemctl</td>
</tr>
<tr>
<td>“Salta”: Docker container won’t start</td>
<td>Docker</td>
<td>容器内服务启动问题</td>
<td>docker, netstat</td>
</tr>
<tr>
<td>“Oaxaca”: Close an Open File</td>
<td>linux</td>
<td>查找文件占用的进程</td>
<td>lsof, exec</td>
</tr>
<tr>
<td>“Melbourne”: WSGI with Gunicorn</td>
<td>gunicorn</td>
<td>gunicorn 配置修复</td>
<td></td>
</tr>
<tr>
<td>“Lisbon”: etcd SSL cert troubles</td>
<td>etcd 访问不通</td>
<td>etcd, iptables</td>
<td></td>
</tr>
<tr>
<td>“Kihei”: Surely Not Another Disk Space Scenario (推荐)</td>
<td>linux</td>
<td>挂盘</td>
<td>pvcreate, vgcreate, lvcreate, mount</td>
</tr>
<tr>
<td>“Unimak Island”: Fun with Mr Jason</td>
<td>linux</td>
<td>文本解析</td>
<td>jq</td>
</tr>
<tr>
<td>“Ivujivik”: Parlez-vous Français?</td>
<td>python</td>
<td>excel 解析</td>
<td>python</td>
</tr>
<tr>
<td>“Paris”: Where is my webserver?</td>
<td>linux</td>
<td>http 接口调用和参数</td>
<td>curl</td>
</tr>
<tr>
<td>“Buenos Aires”: Kubernetes Pod Crashing</td>
<td>kubernetes</td>
<td>kubernetes 权限体系</td>
<td>kubectl</td>
</tr>
<tr>
<td>“Tarifa”: Between Two Seas</td>
<td>nginx</td>
<td>nginx 配置修复</td>
<td>docker</td>
</tr>
<tr>
<td><strong>“Marrakech”: Word Histogram (推荐)</strong></td>
<td>sqlite</td>
<td>文本解析</td>
<td>sqlite</td>
</tr>
<tr>
<td>“Rosario”: Restore a MySQL database</td>
<td>mysql</td>
<td>mysql 故障恢复</td>
<td>mysql</td>
</tr>
<tr>
<td>“Abaokoro”: Restore MySQL Databases Spooked by a Ghost</td>
<td>mysql</td>
<td>mysql 数据导入</td>
<td>mysql</td>
</tr>
<tr>
<td>“Poznań”: Helm Chart Issue in Kubernetes</td>
<td>kubernetes</td>
<td>helm 基本使用</td>
<td>helm</td>
</tr>
<tr>
<td>“Manado”: How much do you press?</td>
<td>linux</td>
<td>解压缩常用指令的使用</td>
<td>zip, tar, xz</td>
</tr>
<tr>
<td>“Warsaw”: Prometheus can’t scrape the webserver</td>
<td>linux</td>
<td>go 服务问题修复</td>
<td>docker</td>
</tr>
<tr>
<td>“Moyogalpa”: Security Snag. The Trials of Mary and John</td>
<td>linux</td>
<td>服务文件权限和防火墙设置</td>
<td>apparmor, systemctl, update-ca-certificates</td>
</tr>
<tr>
<td>“Helsingør”: The first walls of postgres physical replication</td>
<td>postgresql</td>
<td>postgresql 同步主库相关配置修复</td>
<td>docker</td>
</tr>
<tr>
<td>“Bekasi”: Supervisor is still around</td>
<td>wsgi</td>
<td>wsgi 启动配置修复</td>
<td>curl, supervisorctl</td>
</tr>
<tr>
<td>“Depok”: Nginx with Brotli</td>
<td>nginx</td>
<td>nginx 插件安装</td>
<td>cmake, make, systemctl</td>
</tr>
<tr>
<td>“Tukaani”: XZ LZMA Library Compromised</td>
<td>linux</td>
<td>preload 库问题修复</td>
<td>lsof</td>
</tr>
<tr>
<td>“Jakarta”: it’s always DNS.</td>
<td>linux</td>
<td>DNS 解析配置修复</td>
<td></td>
</tr>
<tr>
<td>“Bern”: Docker web container can’t connect to db container.</td>
<td>wordpress</td>
<td>通过 docker 启动 wordpress</td>
<td>docker</td>
</tr>
<tr>
<td><strong>“Karakorum”: WTFIT – What The Fun Is This? (推荐)</strong></td>
<td>linux</td>
<td>定位系统和进程启动问题</td>
<td>perl, strace, python</td>
</tr>
<tr>
<td>“Singara”: Docker and Kubernetes web app not working.</td>
<td>kubernetes</td>
<td>镜像重建和提交</td>
<td>docker, kubectl</td>
</tr>
<tr>
<td>“Hong-Kong”: can’t write data into database.</td>
<td>postgresql</td>
<td>postgresql 配置问题修复</td>
<td>postgres, systemctl</td>
</tr>
<tr>
<td><strong>“Pokhara”: SSH and other sshenanigans (推荐)</strong></td>
<td>linux</td>
<td>ssh 和 su 问题解决</td>
<td>ssh, su, chage, ssh-keygen</td>
</tr>
<tr>
<td>“Roseau”: Hack a Web Server</td>
<td>linux</td>
<td>john 暴力破解工具的使用</td>
<td>john</td>
</tr>
<tr>
<td>“Belo-Horizonte”: A Java Enigma</td>
<td>linux</td>
<td>java 程序执行问题解决</td>
<td>java, javap, free, fallocate, mkswap, swapon</td>
</tr>
<tr>
<td>“Chennai”: Pull a Rabbit from a Hat</td>
<td>rabbitmq</td>
<td>rabbitmq 测试生产消费</td>
<td>docker, python</td>
</tr>
<tr>
<td>“Monaco”: Disappearing Trick</td>
<td>linux</td>
<td>git和进程环境变量</td>
<td>git</td>
</tr>
<tr>
<td>“Florence”: Database Migration Hell</td>
<td>微服务</td>
<td>js+web后台+pgsql问题解决</td>
<td>docker, sed</td>
</tr>
</tbody></table>
<h2 id="如何解题"><a href="#如何解题" class="headerlink" title="如何解题"></a>如何解题</h2><p><img src="/2024/01/17/sadserver-intro/01.png" alt="打开题目"></p>
<p><img src="/2024/01/17/sadserver-intro/02.png" alt="题目示例"></p>
<p><img src="/2024/01/17/sadserver-intro/03.png" alt="检查成功结果"></p>
<h2 id="Level-简单"><a href="#Level-简单" class="headerlink" title="Level: 简单"></a>Level: 简单</h2><h3 id="【linux】“Saint-John”-what-is-writing-to-this-log-file"><a href="#【linux】“Saint-John”-what-is-writing-to-this-log-file" class="headerlink" title="【linux】“Saint John”: what is writing to this log file?"></a>【linux】<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/saint-john">“Saint John”: what is writing to this log file?</a></h3><p><img src="/2024/01/17/sadserver-intro/04.png" alt="题目"></p>
<h4 id="题意"><a href="#题意" class="headerlink" title="题意"></a>题意</h4><p>服务器上有一个日志文件在被一个进程占用，需要找到这个进程并停止</p>
<h4 id="相关指令"><a href="#相关指令" class="headerlink" title="相关指令"></a>相关指令</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 查看文件占用进程 id</span></span><br><span class="line">lsof /var/log/bad.log</span><br><span class="line">ls -l /proc/*/fd/* | grep bad.log</span><br><span class="line">fuser /var/log/bad.log</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 确认文件是否最近未更新</span></span><br><span class="line">find /var/log/bad.log -mmin -0.1</span><br></pre></td></tr></table></figure>

<h3 id="【推荐】【linux】“Saskatoon”-counting-IPs"><a href="#【推荐】【linux】“Saskatoon”-counting-IPs" class="headerlink" title="【推荐】【linux】“Saskatoon”: counting IPs."></a>【推荐】【linux】<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/saskatoon">“Saskatoon”: counting IPs.</a></h3><p><img src="/2024/01/17/sadserver-intro/05.png" alt="题目"></p>
<h4 id="题意-1"><a href="#题意-1" class="headerlink" title="题意"></a>题意</h4><p>/home/admin/access.log 是一个 web 服务的访问记录日志（如 nginx 的访问日志就在 access.log 中），从中统计出访问次数最多的源ip</p>
<h4 id="相关指令-1"><a href="#相关指令-1" class="headerlink" title="相关指令"></a>相关指令</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 截取ip</span></span><br><span class="line">cat /home/admin/access.log | awk &#x27;&#123;print $1&#125;&#x27; &gt; /tmp/access_ips.log</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 排序</span></span><br><span class="line">cat /tmp/access_ips.log | sort &gt; /tmp/sort_ips.log</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 计数 &amp; 再排序</span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># uniq: 统计出现次数</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># sort: -n: 按数值排序而不是字符串序; -r: 逆序</span></span></span><br><span class="line">cat /tmp/sort_ips.log | uniq -c | sort -nr &gt; /tmp/count_ips.log</span><br></pre></td></tr></table></figure>

<h3 id="【推荐】【linux】“Santiago”-Find-the-secret-combination"><a href="#【推荐】【linux】“Santiago”-Find-the-secret-combination" class="headerlink" title="【推荐】【linux】“Santiago”: Find the secret combination"></a>【推荐】【linux】<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/santiago">“Santiago”: Find the secret combination</a></h3><p><img src="/2024/01/17/sadserver-intro/06.png" alt="题目"></p>
<h4 id="题意-2"><a href="#题意-2" class="headerlink" title="题意"></a>题意</h4><p>统计特定字符串在每个文件中的出现次数，并导出只出现一次的文件，出现位置的下一行内容</p>
<h4 id="相关指令-2"><a href="#相关指令-2" class="headerlink" title="相关指令"></a>相关指令</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 查找文件内容 &amp; 统计数量</span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 注意: 题目要求是字符串出现次数，如果是统计词语可在 grep 之后加上 -w 参数</span></span></span><br><span class="line">find /home/admin -name &quot;*.txt&quot; | xargs grep -c &#x27;Alice&#x27;</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 输出之后一行（前一行是-B），且过滤出数字部分</span></span><br><span class="line">grep &quot;Alice&quot; -A1 /home/admin/1342-0.txt | grep -oE &quot;[0-9]+&quot;</span><br></pre></td></tr></table></figure>

<h3 id="The-Command-Line-Murders"><a href="#The-Command-Line-Murders" class="headerlink" title="The Command Line Murders"></a><a target="_blank" rel="noopener" href="https://sadservers.com/scenario/command-line-murders">The Command Line Murders</a></h3><p>本题更像是解密游戏，而不是解决服务器问题，因此笔者选择（偷懒）跳过了这题，喜欢读解密类小说的可以试一下</p>
<h3 id="【推荐】【linux】“Taipei”-Come-a-knocking"><a href="#【推荐】【linux】“Taipei”-Come-a-knocking" class="headerlink" title="【推荐】【linux】“Taipei”: Come a-knocking"></a>【推荐】【linux】<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/taipei">“Taipei”: Come a-knocking</a></h3><p><img src="/2024/01/17/sadserver-intro/07.png" alt="题目"></p>
<h4 id="题意-3"><a href="#题意-3" class="headerlink" title="题意"></a>题意</h4><p>本机 80 端口启动了 http 服务，但端口被 knockd 进程限制访问，无法直接访问</p>
<p>需要通过 knock 对所有端口进行“开门”，使得 80 端口放开</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/f-carey/p/16066178.html">参考-knock：端口敲门服务</a></p>
<h4 id="相关指令-3"><a href="#相关指令-3" class="headerlink" title="相关指令"></a>相关指令</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 对 1000 到 65535 的所有端口发送 knock 请求（ 发送 SYN ）</span></span><br><span class="line">for port in &#123;1000..65535&#125;</span><br><span class="line">do</span><br><span class="line">	knock localhost $&#123;port&#125;</span><br><span class="line">done</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 扫描本地常见服务端口（ 发送 SYN ）</span></span><br><span class="line">nmap -p- localhost</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看 nmap 扫描的端口范围</span></span><br><span class="line">nmap -v -oG - | grep &quot;Ports scanned&quot;</span><br></pre></td></tr></table></figure>

<h3 id="【推荐】【linux】“Lhasa”-Easy-Math"><a href="#【推荐】【linux】“Lhasa”-Easy-Math" class="headerlink" title="【推荐】【linux】“Lhasa”: Easy Math"></a>【推荐】【linux】<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/lhasa">“Lhasa”: Easy Math</a></h3><p><img src="/2024/01/17/sadserver-intro/08.png" alt="题目"></p>
<h4 id="题意-4"><a href="#题意-4" class="headerlink" title="题意"></a>题意</h4><p>将一个文本中的第二列数字求和以及求平均</p>
<p>linux 本身的运算符支持整数运算，因此节点还提供了 python3 和 bc</p>
<h4 id="相关指令-4"><a href="#相关指令-4" class="headerlink" title="相关指令"></a>相关指令</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 获取第二列</span></span><br><span class="line">sum_expr=`awk &#x27;&#123;print $2&#125;&#x27; /home/admin/scores.txt </span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 将文本的每一行拼接到同一行，并用加号分隔</span></span><br><span class="line">paste -sd+ test.txt</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 计算数学表达式</span></span><br><span class="line">sum=`echo $&#123;expr&#125; | bc`</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 文本行数</span></span><br><span class="line">count=`cat scores.txt | wc -l`</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 保留两位小数，计算两数相除</span></span><br><span class="line">echo &quot;scale=2; $&#123;sum&#125; / $&#123;count&#125;&quot; | bc</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># python3 test.py</span></span><br><span class="line"><span class="built_in">sum</span> = <span class="number">0</span></span><br><span class="line">num = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">score_file = <span class="string">&#x27;/home/admin/scores.txt&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(score_file, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> scores_file:</span><br><span class="line">    lines = data = scores_file.read().splitlines()</span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> lines:</span><br><span class="line">        score = line.split(<span class="string">&quot; &quot;</span>)[<span class="number">1</span>]</span><br><span class="line">        <span class="built_in">sum</span> += <span class="built_in">float</span>(score)</span><br><span class="line">        num += <span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;%.2f&quot;</span> % (<span class="built_in">sum</span> / num))</span><br></pre></td></tr></table></figure>

<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// go run test.go</span></span><br><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;bufio&quot;</span></span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;os&quot;</span></span><br><span class="line">	<span class="string">&quot;strconv&quot;</span></span><br><span class="line">	<span class="string">&quot;strings&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	scoreFile, _ := os.Open(<span class="string">&quot;/root/scores.txt&quot;</span>)</span><br><span class="line">	<span class="keyword">defer</span> scoreFile.Close()</span><br><span class="line"></span><br><span class="line">	scanner := bufio.NewScanner(scoreFile)</span><br><span class="line">	scoreCount := <span class="number">0</span></span><br><span class="line">	scoreSum := <span class="number">0.0</span></span><br><span class="line">	<span class="keyword">for</span> scanner.Scan() &#123;</span><br><span class="line">		scoreStr := strings.Split(scanner.Text(), <span class="string">&quot; &quot;</span>)[<span class="number">1</span>]</span><br><span class="line">		scoreFloat, _ := strconv.ParseFloat(scoreStr, <span class="number">32</span>)</span><br><span class="line">		scoreSum += scoreFloat</span><br><span class="line">		scoreCount++</span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Printf(<span class="string">&quot;%.2f\n&quot;</span>, <span class="keyword">float32</span>(scoreSum)/<span class="keyword">float32</span>(scoreCount))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="【postgresql】“Bucharest”-Connecting-to-Postgres"><a href="#【postgresql】“Bucharest”-Connecting-to-Postgres" class="headerlink" title="【postgresql】“Bucharest”: Connecting to Postgres"></a>【postgresql】<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/bucharest">“Bucharest”: Connecting to Postgres</a></h3><p><img src="/2024/01/17/sadserver-intro/09.png" alt="题目"></p>
<h4 id="题意-5"><a href="#题意-5" class="headerlink" title="题意"></a>题意</h4><p>本机启动了 postgresql 服务，但因为配置问题连接失败。需要修复 pgsql 配置并重启</p>
<h4 id="相关指令-5"><a href="#相关指令-5" class="headerlink" title="相关指令"></a>相关指令</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 指定密码、用户和 db 连接 pgsql</span></span><br><span class="line">PGPASSWORD=app1user psql -h 127.0.0.1 -d app1 -U app1user -c &#x27;\q&#x27;</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看 pgsql 进程和启动参数 (-e: 查看所有进程，-f: 列举所有进程信息)</span></span><br><span class="line">ps -ef | grep pgsql</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看 pgsql 服务基础配置文件</span></span><br><span class="line">vim /etc/postgresql/13/main/postgresql.conf</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看 pgsql 登录身份和允许访问源地址的配置文件</span></span><br><span class="line">vim /etc/postgresql/13/main/pg_hba.conf</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 重启 pgsql</span></span><br><span class="line">systemctl restart postgresql</span><br></pre></td></tr></table></figure>

<h3 id="【kubernetes】“Bilbao”-Basic-Kubernetes-Problems"><a href="#【kubernetes】“Bilbao”-Basic-Kubernetes-Problems" class="headerlink" title="【kubernetes】“Bilbao”: Basic Kubernetes Problems"></a>【kubernetes】<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/bilbao">“Bilbao”: Basic Kubernetes Problems</a></h3><p><img src="/2024/01/17/sadserver-intro/10.png" alt="题目"></p>
<h4 id="题意-6"><a href="#题意-6" class="headerlink" title="题意"></a>题意</h4><p>manifest.yaml 中定义了 nginx service，但启动失败了，需要通过 pod 的启动信息去解决</p>
<h4 id="相关指令-6"><a href="#相关指令-6" class="headerlink" title="相关指令"></a>相关指令</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 检查指令:</span> </span><br><span class="line">curl 10.43.216.196</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看 nginx pod 状态</span></span><br><span class="line">kubectl get pods</span><br><span class="line">kubectl describe pod nginx-deployment-67699598cc-zrj6f</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 解决 1 node(s) didn<span class="string">&#x27;t match Pod&#x27;</span>s node affinity/selector ...</span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># node 添加 label</span></span></span><br><span class="line">kubectl label nodes node1 disk=ssd</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 删除 pod （触发重建）</span></span></span><br><span class="line">kubectl delete pod nginx-deployment-67699598cc-zrj6f</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 解决 1 Insufficient memory</span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 减少 nginx 申请的内存资源</span></span></span><br><span class="line">sed -i &quot;s/memory:.*/memory: 500Mi/g&quot; manifest.yml</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 重载 manifest.yml</span></span></span><br><span class="line">kubectl apply -f manifest.yml</span><br></pre></td></tr></table></figure>

<!--
## 查看
kubectl get nodes -o json | jq '.items[].spec'

## 移除
kubectl taint nodes --all node.kubernetes.io/unreachable:NoSchedule-

kubectl taint nodes i-02f8e6680f7d5e616 node.kubernetes.io/unreachable:NoSchedule-

kubectl taint nodes i-02f8e6680f7d5e616 node.kubernetes.io/unreachable:NoExecute-
-->

<h3 id="【linux】“Apia”-Needle-in-a-Haystack"><a href="#【linux】“Apia”-Needle-in-a-Haystack" class="headerlink" title="【linux】“Apia”: Needle in a Haystack"></a>【linux】<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/apia">“Apia”: Needle in a Haystack</a></h3><p><img src="/2024/01/17/sadserver-intro/11.png" alt="题目"></p>
<h4 id="题意-7"><a href="#题意-7" class="headerlink" title="题意"></a>题意</h4><p>在 /home/admin/data 目录下有很多 txt 文件，其中一个和其他文件内容不一样，而且只是在一个段落中多了一个单词，找到这个单词</p>
<h4 id="相关指令-7"><a href="#相关指令-7" class="headerlink" title="相关指令"></a>相关指令</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 输出文本的 md5 值</span></span><br><span class="line">md5sum  /home/admin/data/file1.txt</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 对比两个文本差异（段落级别）</span></span><br><span class="line">diff /home/admin/data/file1.txt /home/admin/data/file2.txt</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 对比两个文本差异（单词级别）</span></span><br><span class="line">wdiff /home/admin/data/file1.txt /home/admin/data/file2.txt</span><br></pre></td></tr></table></figure>

<h2 id="中等"><a href="#中等" class="headerlink" title="中等"></a>中等</h2><h3 id="【postgresql】“Manhattan”-can’t-write-data-into-database"><a href="#【postgresql】“Manhattan”-can’t-write-data-into-database" class="headerlink" title="【postgresql】“Manhattan”: can’t write data into database."></a>【postgresql】<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/manhattan">“Manhattan”: can’t write data into database.</a></h3><p><img src="/2024/01/17/sadserver-intro/12.png" alt="题目"></p>
<h4 id="题意-8"><a href="#题意-8" class="headerlink" title="题意"></a>题意</h4><p>本机启动了 postgresql 服务，但执行 insert 会失败，找到原因并解决</p>
<h4 id="相关指令-8"><a href="#相关指令-8" class="headerlink" title="相关指令"></a>相关指令</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 查看 postgresql 日志</span></span><br><span class="line">tail -f /var/log/postgresql/postgresql-14-main.log</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 重启 postgresql</span></span><br><span class="line">systemctl restart postgresql</span><br></pre></td></tr></table></figure>

<h3 id="【推荐】【httpd、linux】“Tokyo”-can’t-serve-web-file"><a href="#【推荐】【httpd、linux】“Tokyo”-can’t-serve-web-file" class="headerlink" title="【推荐】【httpd、linux】“Tokyo”: can’t serve web file"></a>【推荐】【httpd、linux】<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/tokyo">“Tokyo”: can’t serve web file</a></h3><p><img src="/2024/01/17/sadserver-intro/13.png" alt="题目"></p>
<h4 id="题意-9"><a href="#题意-9" class="headerlink" title="题意"></a>题意</h4><p>本机启动了 apache2（即 <a target="_blank" rel="noopener" href="https://askubuntu.com/a/248412">httpd</a>） 服务，但执行 curl 127.0.0.1:80 没有任何返回，确认具体原因</p>
<h4 id="相关指令-9"><a href="#相关指令-9" class="headerlink" title="相关指令"></a>相关指令</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 查看防火墙规则列表</span></span><br><span class="line">iptables -L --line-numbers</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 删除指定规则</span></span><br><span class="line">iptables -t filter --delete INPUT 1</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 清空所有防火墙规则</span></span><br><span class="line">iptables -F</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 给文件添加所有用户可读权限</span></span><br><span class="line">chmod +r /var/www/html/index.html</span><br></pre></td></tr></table></figure>

<h3 id="【nginx】“Cape-Town”-Borked-Nginx"><a href="#【nginx】“Cape-Town”-Borked-Nginx" class="headerlink" title="【nginx】“Cape Town”: Borked Nginx"></a>【nginx】<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/capetown">“Cape Town”: Borked Nginx</a></h3><p><img src="/2024/01/17/sadserver-intro/14.png" alt="题目"></p>
<h4 id="题意-10"><a href="#题意-10" class="headerlink" title="题意"></a>题意</h4><p>本机安装了 nginx 但无法启动，检查启动失败原因，修复并启动</p>
<h4 id="相关指令-10"><a href="#相关指令-10" class="headerlink" title="相关指令"></a>相关指令</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 重启 nginx 服务</span></span><br><span class="line">systemctl restart nginx</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看 nginx 启动日志</span></span><br><span class="line">journalctl -u nginx</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看 nginx 启动错误日志</span></span><br><span class="line">tail -f /var/log/nginx/error.log</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看 nginx 配置</span></span><br><span class="line">/etc/nginx/nginx.conf</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看 nginx systemd 服务管理配置</span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 关键配置: LimitNOFILE</span></span></span><br><span class="line">vim /etc/systemd/system/nginx.service</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 重新加载配置并重启 nginx</span></span><br><span class="line">systemctl daemon-reload</span><br><span class="line">systemctl restart nginx</span><br></pre></td></tr></table></figure>

<h3 id="【docker】“Salta”-Docker-container-won’t-start"><a href="#【docker】“Salta”-Docker-container-won’t-start" class="headerlink" title="【docker】“Salta”: Docker container won’t start."></a>【docker】<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/salta">“Salta”: Docker container won’t start.</a></h3><p><img src="/2024/01/17/sadserver-intro/15.png" alt="题目"></p>
<h4 id="题意-11"><a href="#题意-11" class="headerlink" title="题意"></a>题意</h4><p>本机 /home/admin/app 目录下有一个支持容器化的 node 应用，并提供 Dockerfile 可以直接构建<br>服务主逻辑在 server.js 中<br>需要构建镜像后，启动该服务，并解决调用该服务接口遇到的问题</p>
<h4 id="相关指令-11"><a href="#相关指令-11" class="headerlink" title="相关指令"></a>相关指令</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 构建镜像</span></span><br><span class="line">docker build -t app .</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 启动</span></span><br><span class="line">docker run -d --name app -p 8888:8888 app</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 检查端口占用</span></span><br><span class="line">netstat -tunlp | grep 8888</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看容器日志</span></span><br><span class="line">docker logs dd231758183e</span><br></pre></td></tr></table></figure>

<h3 id="【linux】“Oaxaca”-Close-an-Open-File"><a href="#【linux】“Oaxaca”-Close-an-Open-File" class="headerlink" title="【linux】“Oaxaca”: Close an Open File"></a>【linux】<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/oaxaca">“Oaxaca”: Close an Open File</a></h3><p><img src="/2024/01/17/sadserver-intro/16.png" alt="题目"></p>
<h4 id="题意-12"><a href="#题意-12" class="headerlink" title="题意"></a>题意</h4><p>/home/admin/somefile 正在被一个进程占用，找到占用原因，并使得下次登录终端后，该文件不会再被进程占用</p>
<p>相关知识点: <a target="_blank" rel="noopener" href="https://www.geeksforgeeks.org/exec-command-in-linux-with-examples/">exec 指令</a></p>
<h4 id="相关指令-12"><a href="#相关指令-12" class="headerlink" title="相关指令"></a>相关指令</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 找到占用文件的进程 ，并直接 <span class="built_in">kill</span></span></span><br><span class="line">lsof /home/admin/somefile | tail -2 | awk &#x27;&#123;print $2&#125;&#x27; | xargs kill -9</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 一个会导致 /tmp/test.txt 被bash进程占用的指令</span></span><br><span class="line">exec 77&gt; /tmp/test.txt</span><br></pre></td></tr></table></figure>

<h3 id="【nginx、gunicorn】“Melbourne”-WSGI-with-Gunicorn"><a href="#【nginx、gunicorn】“Melbourne”-WSGI-with-Gunicorn" class="headerlink" title="【nginx、gunicorn】“Melbourne”: WSGI with Gunicorn"></a>【nginx、gunicorn】<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/melbourne">“Melbourne”: WSGI with Gunicorn</a></h3><p><img src="/2024/01/17/sadserver-intro/17.png" alt="题目"></p>
<h4 id="题意-13"><a href="#题意-13" class="headerlink" title="题意"></a>题意</h4><p>本机运行了 nginx 和 <a target="_blank" rel="noopener" href="https://docs.gunicorn.org/en/latest/install.html">gunicorn</a>（实现了 WSGI 协议的 HTTP 服务器，master-worker 架构）</p>
<p>正常情况下，通过 curl 调用服务的调用链: curl -&gt; nginx -&gt; gunicorn -&gt; wesi.py，其中 /home/admin/wesi.py 中定义了接口的响应方式为返回200状态码和字符串”Hello World”</p>
<p>但是通过 curl -i <a target="_blank" rel="noopener" href="http://localhost/">http://localhost</a> 调用接口失败了，找到原因并通过修改配置解决</p>
<p>相关教程: <a target="_blank" rel="noopener" href="https://docs.gunicorn.org/en/latest/deploy.html">Deploying Gunicorn</a><br>相关知识点: <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Length">http header: content-length</a></p>
<h4 id="相关指令-13"><a href="#相关指令-13" class="headerlink" title="相关指令"></a>相关指令</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 查看 nginx 错误日志</span></span><br><span class="line">tail -f /var/log/nginx/error.log</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 查找 nginx 配置目录下带有指定关键字的配置文件</span></span><br><span class="line">find /etc/nginx -name &#x27;*&#x27; -type f | xargs grep &quot;gunicorn&quot;</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 重启 nginx</span></span><br><span class="line">systemctl restart nginx</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看 gunicorn 配置</span></span><br><span class="line">vim /etc/systemd/system/gunicorn.service</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看 wsgi 服务配置</span></span><br><span class="line">vim /home/admin/wsgi.py</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 重启 gunicorn</span></span><br><span class="line">systemctl restart gunicorn</span><br></pre></td></tr></table></figure>

<!--
[WSGI](https://zh.wikipedia.org/zh-cn/Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BD%91%E5%85%B3%E6%8E%A5%E5%8F%A3): Web Server Gateway Interface, 为Python语言定义的Web服务器和Web应用程序或框架之间的一种简单而通用的接口

[gunicorn](https://docs.gunicorn.org/en/stable/): 基于 WSGI 实现的http服务器，类似 httpd
-->

<h3 id="【etcd、linux】“Lisbon”-etcd-SSL-cert-troubles"><a href="#【etcd、linux】“Lisbon”-etcd-SSL-cert-troubles" class="headerlink" title="【etcd、linux】“Lisbon”: etcd SSL cert troubles"></a>【etcd、linux】<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/lisbon">“Lisbon”: etcd SSL cert troubles</a></h3><p><img src="/2024/01/17/sadserver-intro/18.png" alt="题目"></p>
<h4 id="题意-14"><a href="#题意-14" class="headerlink" title="题意"></a>题意</h4><p>本机部署了 etcd 服务，正常情况下可通过 <code>etcdctl get foo</code> 或 <code>curl -i https://localhost:2379/v2/keys/foo</code> 获取配置，但目前访问失败，需要解决</p>
<h4 id="相关指令-14"><a href="#相关指令-14" class="headerlink" title="相关指令"></a>相关指令</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 通过 etcdctl 获取配置</span></span><br><span class="line">etcdctl get foo</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 设置系统时间</span></span><br><span class="line">date -s &#x27;2023-01-29 00:00:00&#x27;</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 调用etcd接口</span></span><br><span class="line">curl -ik https://localhost:2379/v2/keys/foo</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看防火墙NAT类型的配置</span></span><br><span class="line">iptables -t nat -L</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 清空NAT类型防火墙规则</span></span><br><span class="line">iptables -t nat -F</span><br></pre></td></tr></table></figure>

<h3 id="【推荐】【linux】“Kihei”-Surely-Not-Another-Disk-Space-Scenario"><a href="#【推荐】【linux】“Kihei”-Surely-Not-Another-Disk-Space-Scenario" class="headerlink" title="【推荐】【linux】“Kihei”: Surely Not Another Disk Space Scenario"></a>【推荐】【linux】<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/kihei">“Kihei”: Surely Not Another Disk Space Scenario</a></h3><p><img src="/2024/01/17/sadserver-intro/19.png" alt="题目"></p>
<h4 id="题意-15"><a href="#题意-15" class="headerlink" title="题意"></a>题意</h4><p>当前路径的 kihei 程序会在 /home/admin/data 目录下创建一个 1.5G大小的文件，但因为磁盘空间不足，执行失败了，需要在不删除其他文件的情况下使得 kihei 能够正常执行</p>
<h4 id="相关指令-15"><a href="#相关指令-15" class="headerlink" title="相关指令"></a>相关指令</h4><p>本题是非常完整的磁盘挂载练手好题，可以结合挂盘相关的指令一起理解</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/MssGuo/article/details/120473476">参考: lvcreate 创建逻辑卷、vgcreate 创建卷组、pvcreate 创建物理卷、vgextend 扩容卷组、lv缩容</a></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 查看 kihei 进程的详细日志</span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 注意: 这里的 kihei 可执行文件并不是来自开源项目...</span></span></span><br><span class="line">./kihei -v</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看本地磁盘使用情况和剩余空间</span></span><br><span class="line">df -h</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看所有磁盘</span></span><br><span class="line">lsblk</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 创建物理卷</span></span><br><span class="line">pvcreate /dev/nvme1n1</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看所有物理卷</span></span><br><span class="line">pvs</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 创建卷组</span></span><br><span class="line">vgcreate vg1 /dev/nvme1n1 /dev/nvme2n1</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看所有卷组</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 创建逻辑卷</span></span><br><span class="line">lvcreate -n lv1 -l 100%FREE vg1</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看逻辑卷</span></span><br><span class="line">lvs</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 格式化卷，初始化文件系统</span></span><br><span class="line">mkfs -t ext4 /dev/vg1/lv1</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 卷挂载，并设置目录权限</span></span><br><span class="line">mount /dev/vg1/lv1 /home/admin/data</span><br><span class="line">chown -R admin:root /home/admin/data</span><br></pre></td></tr></table></figure>

<h3 id="【linux】“Unimak-Island”-Fun-with-Mr-Jason"><a href="#【linux】“Unimak-Island”-Fun-with-Mr-Jason" class="headerlink" title="【linux】“Unimak Island”: Fun with Mr Jason"></a>【linux】<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/unimak">“Unimak Island”: Fun with Mr Jason</a></h3><p><img src="/2024/01/17/sadserver-intro/20.png" alt="题目"></p>
<h4 id="题意-16"><a href="#题意-16" class="headerlink" title="题意"></a>题意</h4><p>station_information.json 中包含若干个单车租赁站的信息，筛选其中 没有自动服务机（has_kiosk=false）且剩余单车超过30辆（capacity&gt;30）的租赁站，将它的id（station_id）写入答案文件中</p>
<h4 id="相关指令-16"><a href="#相关指令-16" class="headerlink" title="相关指令"></a>相关指令</h4><p>虽然题目提示本机有 <a target="_blank" rel="noopener" href="https://github.com/jqlang/jq">jq</a> 、 <a target="_blank" rel="noopener" href="https://github.com/tomnomnom/gron">gron</a> 和 <a target="_blank" rel="noopener" href="https://github.com/simeji/jid">jid</a> 等工具，但后两者操作起来都不如同时包含解析和筛选器的 jq 方便，这里直接展示 jq 的几个基本指令，组合几个 filter ，就可以解答本题了</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 获取数组长度</span></span><br><span class="line">echo &quot;[1,2,3,4,5]&quot; | jq length</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 过滤器</span></span><br><span class="line">echo &#x27;&#123;&quot;dates&quot;:[&#123;&quot;day&quot;:&quot;monday&quot;,&quot;emotion&quot;:&quot;happy&quot;&#125;,&#123;&quot;day&quot;:&quot;tuesday&quot;,&quot;emotion&quot;:&quot;crazy&quot;&#125;]&#125;&#x27; | jq -r &#x27;.dates[] | select(.emotion==&quot;happy&quot;)&#x27;</span><br></pre></td></tr></table></figure>

<h3 id="【python、go】“Ivujivik”-Parlez-vous-Francais"><a href="#【python、go】“Ivujivik”-Parlez-vous-Francais" class="headerlink" title="【python、go】“Ivujivik”: Parlez-vous Français?"></a>【python、go】<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/ivujivik">“Ivujivik”: Parlez-vous Français?</a></h3><p><img src="/2024/01/17/sadserver-intro/21.png" alt="题目"></p>
<h4 id="题意-17"><a href="#题意-17" class="headerlink" title="题意"></a>题意</h4><p>table_tableau11.csv 文件中记录了总统选举中，各个选区的投票情况信息，需要按题目的筛选条件得到对应的选区名称</p>
<p>省份,选区名称,选区编号,人口,选民,投票站,有效选票,有效选票百分比,被拒绝的选票 被拒绝的选票,被拒绝的选票百分比,总投票数,选民投票率,当选候选人</p>
<h4 id="相关指令-17"><a href="#相关指令-17" class="headerlink" title="相关指令"></a>相关指令</h4><p>本题主要考察通过各个语言/工具解析 csv 的方法，这里展示 python 和 go 的解答方式</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># pandas</span></span><br><span class="line"><span class="keyword">import</span> csv</span><br><span class="line">max_reject = <span class="number">0</span></span><br><span class="line">answer = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;table_tableau11.csv&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    reader = csv.reader(f)</span><br><span class="line">    <span class="built_in">next</span>(reader) <span class="comment"># skip first line</span></span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> reader:</span><br><span class="line">        current_reject = <span class="built_in">int</span>(<span class="built_in">float</span>(row[<span class="number">8</span>]))</span><br><span class="line">        current_population = <span class="built_in">int</span>(row[<span class="number">3</span>])</span><br><span class="line">        <span class="keyword">if</span> current_reject &gt; max_reject:</span><br><span class="line">            max_reject = current_reject</span><br><span class="line">            <span class="keyword">if</span> current_population &lt; <span class="number">100000</span>:</span><br><span class="line">                answer = row[<span class="number">1</span>]</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;mysolution&#x27;</span>, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(<span class="string">f&quot;<span class="subst">&#123;answer&#125;</span>\n&quot;</span>)</span><br><span class="line">    f.close()</span><br></pre></td></tr></table></figure>


<figure class="highlight golang"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;encoding/csv&quot;</span></span><br><span class="line">	<span class="string">&quot;os&quot;</span></span><br><span class="line">	<span class="string">&quot;io/ioutil&quot;</span></span><br><span class="line">	<span class="string">&quot;strconv&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	f, _ := os.Open(<span class="string">&quot;table_tableau11.csv&quot;</span>)</span><br><span class="line"></span><br><span class="line">	csvReader := csv.NewReader(f)</span><br><span class="line">	csvReader.FieldsPerRecord = <span class="number">-1</span> <span class="comment">// ignore fields per record</span></span><br><span class="line">	records, _ := csvReader.ReadAll()</span><br><span class="line"></span><br><span class="line">	answer := <span class="string">&quot;&quot;</span></span><br><span class="line">	maxReject := <span class="number">0</span></span><br><span class="line">	<span class="keyword">for</span> _, currentRecord := <span class="keyword">range</span> records[<span class="number">1</span>:] &#123;</span><br><span class="line">			currentReject, _ := strconv.Atoi(currentRecord[<span class="number">8</span>])</span><br><span class="line">			currentPopulation, _ := strconv.Atoi(currentRecord[<span class="number">3</span>])</span><br><span class="line">			<span class="keyword">if</span> currentReject &gt; maxReject &#123;</span><br><span class="line">					maxReject = currentReject</span><br><span class="line">					<span class="keyword">if</span> currentPopulation &lt; <span class="number">100000</span> &#123;</span><br><span class="line">							answer = currentRecord[<span class="number">1</span>]</span><br><span class="line">					&#125;</span><br><span class="line">			&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	ioutil.WriteFile(<span class="string">&quot;mysolution&quot;</span>, []<span class="keyword">byte</span>(answer + <span class="string">&quot;\n&quot;</span>), <span class="number">0644</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="【linux】“Paris”-Where-is-my-webserver"><a href="#【linux】“Paris”-Where-is-my-webserver" class="headerlink" title="【linux】“Paris”: Where is my webserver?"></a>【linux】<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/paris">“Paris”: Where is my webserver?</a></h3><p><img src="/2024/01/17/sadserver-intro/22.png" alt="题目"></p>
<h4 id="题意-18"><a href="#题意-18" class="headerlink" title="题意"></a>题意</h4><p>本题没有提示应该比较难做出来，因为问题相关的代码甚至都看不到，所以不是很推荐，主要考察对 user-agent header 的了解</p>
<p><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/User-Agent">user-agent</a>: 表示客户端类型，默认为空，浏览器访问时将会自动填充</p>
<p>这里访问 5000 端口启动的服务端会对 user-agent 进行校验，如果为空将不会返回数据，需要指定任意的 user-agent 再调用 5000 端口，拿到答案需要的密码</p>
<h4 id="相关指令-18"><a href="#相关指令-18" class="headerlink" title="相关指令"></a>相关指令</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 添加 user-agent 调用接口</span></span><br><span class="line">curl --user-agent &quot;hhh&quot; http://localhost:5000</span><br><span class="line">curl -H &#x27;User-Agent: hhh&#x27; http://localhost:5000</span><br><span class="line">curl -A &#x27;hhh&#x27; http://localhost:5000</span><br></pre></td></tr></table></figure>


<h3 id="【kubernetes】“Buenos-Aires”-Kubernetes-Pod-Crashing"><a href="#【kubernetes】“Buenos-Aires”-Kubernetes-Pod-Crashing" class="headerlink" title="【kubernetes】“Buenos Aires”: Kubernetes Pod Crashing"></a>【kubernetes】<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/buenos-aires">“Buenos Aires”: Kubernetes Pod Crashing</a></h3><p><img src="/2024/01/17/sadserver-intro/23.png" alt="题目"></p>
<h4 id="题意-19"><a href="#题意-19" class="headerlink" title="题意"></a>题意</h4><p>本机部署了 k8s ，其中名为 logshipper 的 pod 启动失败了，需要确认失败原因</p>
<p>本题主要考察 k8s 的 clusterrole 对应的权限类型</p>
<h4 id="相关指令-19"><a href="#相关指令-19" class="headerlink" title="相关指令"></a>相关指令</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 查看所有 pod 的 label</span></span><br><span class="line">kubectl get pod --show-labels</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看指定 label 对应的 pod 信息和状态</span></span><br><span class="line">kubectl describe pod -l app=logshipper</span><br><span class="line">kubectl describe pod logshipper-597f84bf4f-6ssjq</span><br><span class="line">kubectl describe deployment logshipper</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看 pod 日志（提示权限不足）</span></span><br><span class="line">kubectl logs logshipper-597f84bf4f-6ssjq --follow</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看 logshipper pod 绑定的 serviceAccount 对应的 rolebinding 和 clusterrolebinding</span></span><br><span class="line">kubectl get rolebinding,clusterrolebinding --all-namespaces -o jsonpath=&#x27;&#123;range .items[?(@.subjects[0].name==&quot;logshipper-sa&quot;)]&#125;[&#123;.roleRef.kind&#125;,&#123;.roleRef.name&#125;]&#123;end&#125;&#x27;</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看指定 clusterrole</span></span><br><span class="line">kubectl describe ClusterRole logshipper-cluster-role</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 编辑 clusterrole 权限</span></span><br><span class="line">kubectl edit ClusterRole logshipper-cluster-role</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 删除（触发自动拉起新的pod）</span></span><br><span class="line">kubectl delete pod logshipper-597f84bf4f-6ssjq</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 获取服务状态</span></span><br><span class="line">kubectl get pods -l app=logshipper --no-headers -o json | jq -r &#x27;.items[] | &quot;\(.status.containerStatuses[0].ready)&quot;&#x27;</span><br></pre></td></tr></table></figure>

<h3 id="【haproxy、docker】“Tarifa”-Between-Two-Seas"><a href="#【haproxy、docker】“Tarifa”-Between-Two-Seas" class="headerlink" title="【haproxy、docker】“Tarifa”: Between Two Seas"></a>【haproxy、docker】<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/tarifa">“Tarifa”: Between Two Seas</a></h3><p><img src="/2024/01/17/sadserver-intro/24.png" alt="题目"></p>
<h4 id="题意-20"><a href="#题意-20" class="headerlink" title="题意"></a>题意</h4><p>本机通过 docker compose 启动了一个 haproxy 和两个 nginx。因为 haproxy 的配置（haproxy.cfg）策略是对两个 nginx 节点进行轮询（roundrobin）访问，因此正常情况下，调用 localhost:5000 会依次返回  “nginx_0” 和 “nginx_1”<br>但目前调用只返回了 “nginx_0”，需要找到原因</p>
<h4 id="相关指令-20"><a href="#相关指令-20" class="headerlink" title="相关指令"></a>相关指令</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 调用 haproxy</span></span><br><span class="line">curl localhost:5000</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看 haproxy pod 日志</span></span><br><span class="line">docker logs c79c9eb25143</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看 haproxy 配置</span></span><br><span class="line">vim haproxy.cfg</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看 nginx 配置</span></span><br><span class="line">vim custom-nginx_0.conf</span><br><span class="line">vim custom-nginx_1.conf</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看 docker compose 服务定义</span></span><br><span class="line">vim docker-compose.yml</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 重启 docker-compose 服务组</span></span><br><span class="line">docker compose down</span><br><span class="line">docker compose up -d</span><br></pre></td></tr></table></figure>

<h3 id="【推荐】【sqlite】“Marrakech”-Word-Histogram"><a href="#【推荐】【sqlite】“Marrakech”-Word-Histogram" class="headerlink" title="【推荐】【sqlite】“Marrakech”: Word Histogram"></a>【推荐】【sqlite】<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/marrakech">“Marrakech”: Word Histogram</a></h3><p><img src="/2024/01/17/sadserver-intro/25.png" alt="题目"></p>
<h4 id="题意-21"><a href="#题意-21" class="headerlink" title="题意"></a>题意</h4><p>frankestein.txt 文本中有一段文章，找到其中出现次数排第二多的单词<br>常见的单词分隔符为: .,:; ，且单词需忽略大小写</p>
<h4 id="相关指令-21"><a href="#相关指令-21" class="headerlink" title="相关指令"></a>相关指令</h4><p>这里通过 sqlite3 来解决本题</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 所有单词分隔后，转成全大写并按换行符分隔写入新文件</span></span><br><span class="line">cat frankestein.txt | tr &#x27;.&#x27; &#x27;\n&#x27; | tr &#x27;,&#x27; &#x27;\n&#x27; | tr &#x27;:&#x27; &#x27;\n&#x27; | tr &#x27;;&#x27; &#x27;\n&#x27; | tr &#x27; &#x27; &#x27;\n&#x27; | tr &#x27;&quot;&#x27; &#x27;\n&#x27; | sed -r &#x27;/^\s*$/d&#x27; | tr &#x27;a-z&#x27; &#x27;A-Z&#x27; &gt; frankestein_new.txt</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 写入文件头（作为 sqlite 加载的列名）</span></span><br><span class="line">sed -i &#x27;1iword&#x27; frankestein_new.txt</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> sqlite: 导入文本到words表</span></span><br><span class="line">.import frankestein_new.txt words</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> sql: 出现次数排第二的单词</span></span><br><span class="line">SELECT a.word, a.count_word FROM (SELECT word, count(word) AS count_word FROM words GROUP BY word) AS a ORDER BY a.count_word DESC LIMIT 1 OFFSET 1;</span><br></pre></td></tr></table></figure>
<h3 id="【mysql】“Rosario”-Restore-a-MySQL-database"><a href="#【mysql】“Rosario”-Restore-a-MySQL-database" class="headerlink" title="【mysql】“Rosario”: Restore a MySQL database"></a>【mysql】<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/rosario">“Rosario”: Restore a MySQL database</a></h3><p><img src="/2024/01/17/sadserver-intro/26.png" alt="题目"></p>
<p>本机启动了 <a target="_blank" rel="noopener" href="https://github.com/MariaDB/server">mariadb</a> ，需要在 main 数据库中执行 backup.sql 中的语句，但题目没有提供数据库登录密码</p>
<p>本题主要考察 mysql/mariadb 如何通过免密模式启动，参考 <a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.4/en/resetting-permissions.html">B.3.3.2 How to Reset the Root Password</a></p>
<h4 id="相关指令-22"><a href="#相关指令-22" class="headerlink" title="相关指令"></a>相关指令</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 查看/修改 mariadb 启动配置</span></span><br><span class="line">vim /usr/lib/systemd/system/mariadb.service</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 添加systemctl启动服务的环境变量</span></span><br><span class="line">[Service]</span><br><span class="line">Environment=&quot;MYSQLD_OPTS=&#x27;--skip-grant-tables&#x27;&quot;</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 重启 mariadb</span></span><br><span class="line">systemctl daemon-reload</span><br><span class="line">service mariadb restart</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 免密登录</span></span><br><span class="line">mysql</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 修正 backup.sql 语法问题</span></span><br><span class="line">sed -i &#x27;s#?$#;#g&#x27; /home/admin/backup.sql</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 执行 backup.sql</span></span><br><span class="line">use main;</span><br><span class="line">source /home/admin/backup.sql;</span><br><span class="line"></span><br><span class="line">mysql -Dmain &lt; /home/admin/backup.sql</span><br></pre></td></tr></table></figure>

<h3 id="【mysql】“Abaokoro”-Restore-MySQL-Databases-Spooked-by-a-Ghost"><a href="#【mysql】“Abaokoro”-Restore-MySQL-Databases-Spooked-by-a-Ghost" class="headerlink" title="【mysql】“Abaokoro”: Restore MySQL Databases Spooked by a Ghost"></a>【mysql】<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/abaokoro">“Abaokoro”: Restore MySQL Databases Spooked by a Ghost</a></h3><p><img src="/2024/01/17/sadserver-intro/27.png" alt="题目"></p>
<h4 id="题意-22"><a href="#题意-22" class="headerlink" title="题意"></a>题意</h4><p>本机启动了 mariadb ，需要将 dbs_to_restore.zip 中的三个 sql 文件分别导入 first 、 second 和 third 三个数据库中</p>
<h4 id="相关指令-23"><a href="#相关指令-23" class="headerlink" title="相关指令"></a>相关指令</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 检查磁盘占用</span></span><br><span class="line">du -h --max-depth=1 /var</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 解压</span></span><br><span class="line">tar -xzvf dbs_to_restore.tar.gz </span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 导入三个数据库（注：导入时间较长）</span></span><br><span class="line">mysql -e &quot;create database first&quot;</span><br><span class="line">mysql -Dfirst &lt; first.sql</span><br><span class="line"></span><br><span class="line">mysql -e &quot;create database second&quot;</span><br><span class="line">mysql -Dsecond &lt; second.sql</span><br><span class="line"></span><br><span class="line">mysql -e &quot;create database third&quot;</span><br><span class="line">mysql -Dthird &lt; third.sql</span><br></pre></td></tr></table></figure>

<h3 id="【k8s、helm】“Poznan”-Helm-Chart-Issue-in-Kubernetes"><a href="#【k8s、helm】“Poznan”-Helm-Chart-Issue-in-Kubernetes" class="headerlink" title="【k8s、helm】“Poznań”: Helm Chart Issue in Kubernetes"></a>【k8s、helm】<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/poznan">“Poznań”: Helm Chart Issue in Kubernetes</a></h3><p><img src="/2024/01/17/sadserver-intro/28.png" alt="题目"></p>
<p>本机通过 web_chart 目录定义的 nginx chart 启动了一个 nginx pod，期望是调用任何一个 nginx 的 80 端口都能返回 configmap.yaml 中定义的 “Welcome SadServers” 页面</p>
<p>但现在调用返回的是 nginx 默认的页面，configmap 配的页面并没有生效。需要使之生效，还需要将 nginx 的副本数修改为 3</p>
<p>本题主要考察 helm 的基本使用，以及 k8s configmap 如何注入到 pod 中，参考:<br><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/71058097/how-do-i-attach-a-configmap-to-a-deployment-in-kubernetes/71058264#71058264">How do I attach a configmap to a deployment in Kubernetes?</a></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 获取 nginx pod 对应的 ip 并调用 nginx 服务</span></span><br><span class="line">pod_ip=`kubectl get pods -n default -o jsonpath=&#x27;&#123;.items[0].status.podIP&#125;&#x27;`</span><br><span class="line">curl $&#123;pod_ip&#125;</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看 deployment</span></span><br><span class="line">kubectl describe deployment web-chart-nginx</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 修改 chart values（包含副本数配置）</span></span><br><span class="line">helm get values web-chart --all</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 重装 web-chart</span></span><br><span class="line">helm uninstall web-chart</span><br><span class="line">helm install web-chart web_chart/</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 或: 更新 chart</span></span><br><span class="line">helm upgrade web-chart ./web_chart --values ./web_chart/values.yaml</span><br></pre></td></tr></table></figure>

<p>修改后的 deployment:</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">(省略)</span></span><br><span class="line">    <span class="attr">spec:</span></span><br><span class="line">      <span class="attr">containers:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> &#123;&#123; <span class="string">.Chart.Name</span> &#125;&#125;</span><br><span class="line">          <span class="attr">image:</span> <span class="string">&quot;<span class="template-variable">&#123;&#123; .Values.image.repository &#125;&#125;</span>:<span class="template-variable">&#123;&#123; .Values.image.tag &#125;&#125;</span>&quot;</span></span><br><span class="line">          <span class="attr">imagePullPolicy:</span> &#123;&#123; <span class="string">.Values.image.pullPolicy</span> &#125;&#125;</span><br><span class="line">          <span class="attr">ports:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">http</span></span><br><span class="line">              <span class="attr">containerPort:</span> <span class="number">80</span></span><br><span class="line">              <span class="attr">protocol:</span> <span class="string">TCP</span></span><br><span class="line">          <span class="attr">volumeMounts:</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">mountPath:</span> <span class="string">/usr/share/nginx/html/</span></span><br><span class="line">            <span class="attr">name:</span> <span class="string">nginx-html</span></span><br><span class="line">      <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">nginx-html</span></span><br><span class="line">        <span class="attr">configMap:</span></span><br><span class="line">          <span class="attr">name:</span> &#123;&#123; <span class="string">.Release.Name</span> &#125;&#125;<span class="string">-cm-index-html</span></span><br><span class="line">          <span class="attr">items:</span>              </span><br><span class="line">          <span class="bullet">-</span> <span class="attr">key:</span> <span class="string">index.html</span></span><br><span class="line">            <span class="attr">path:</span> <span class="string">index.html</span></span><br></pre></td></tr></table></figure>

<h3 id="【linux】“Manado”-How-much-do-you-press"><a href="#【linux】“Manado”-How-much-do-you-press" class="headerlink" title="【linux】“Manado”: How much do you press?"></a>【linux】<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/manado">“Manado”: How much do you press?</a></h3><p><img src="/2024/01/17/sadserver-intro/29.png" alt="题目"></p>
<h4 id="题意-23"><a href="#题意-23" class="headerlink" title="题意"></a>题意</h4><p>通过本机提供的 gzip、xz、lzip、tar 等工具，将 35147 字节大小的 names 文件压缩成不到 9400 字节，并将压缩文件放到 solution 目录下</p>
<p>可以在<strong>不删除</strong>任何行的前提下对文件进行修改</p>
<h4 id="相关指令-24"><a href="#相关指令-24" class="headerlink" title="相关指令"></a>相关指令</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> gzip 压缩和解压</span></span><br><span class="line">gzip -v9 names</span><br><span class="line">gunzip names.gz</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> xz</span></span><br><span class="line">xz names</span><br><span class="line">xz -d names.xz</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> lzip</span></span><br><span class="line">tar --use-compress-program=lbzip2 -cvf names.tar.bz2 names</span><br><span class="line">tar --use-compress-program=lbzip2 -xvf names.tar.bz2</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> lz4</span></span><br><span class="line">lz4 names</span><br><span class="line">lz4 -d names.lz4</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> lzip</span></span><br><span class="line">lzip --best names</span><br><span class="line">lzip -d names.lz</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> lzop</span></span><br><span class="line">lzop -9 names</span><br><span class="line">lzop -d names.lz.lzo</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> zstd</span></span><br><span class="line">zstd -19 names</span><br><span class="line">zstd -d names.zst</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 文件内容排序</span></span><br><span class="line">sort names &gt; names_new</span><br></pre></td></tr></table></figure>

<h3 id="【docker、golang】“Warsaw”-Prometheus-can’t-scrape-the-webserver"><a href="#【docker、golang】“Warsaw”-Prometheus-can’t-scrape-the-webserver" class="headerlink" title="【docker、golang】“Warsaw”: Prometheus can’t scrape the webserver"></a>【docker、golang】<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/warsaw">“Warsaw”: Prometheus can’t scrape the webserver</a></h3><p><img src="/2024/01/17/sadserver-intro/30.png" alt="题目"></p>
<h4 id="题意-24"><a href="#题意-24" class="headerlink" title="题意"></a>题意</h4><p>app 目录下是一个通过 gorilla/mux 框架搭建的 web 服务，并通过 promhttp 暴露 /metrics 接口</p>
<p>但是目前直接调用 <a target="_blank" rel="noopener" href="http://localhost:9000/metrics">http://localhost:9000/metrics</a> 接口将失败，需要解决</p>
<h4 id="相关指令-25"><a href="#相关指令-25" class="headerlink" title="相关指令"></a>相关指令</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 调用 metrics 接口</span></span><br><span class="line">curl http://localhost:9000/metrics</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 重启 docker compose 服务</span></span><br><span class="line">docker compose down --volumes</span><br><span class="line">docker compose up -d</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 重新构建镜像再启动</span></span></span><br><span class="line">docker compose up --build -d</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看 app 的启动逻辑</span></span><br><span class="line">vim app/main.go</span><br></pre></td></tr></table></figure>

<h3 id="“Moyogalpa”-Security-Snag-The-Trials-of-Mary-and-John"><a href="#“Moyogalpa”-Security-Snag-The-Trials-of-Mary-and-John" class="headerlink" title="“Moyogalpa”: Security Snag. The Trials of Mary and John"></a><a target="_blank" rel="noopener" href="https://sadservers.com/scenario/moyogalpa">“Moyogalpa”: Security Snag. The Trials of Mary and John</a></h3><p><img src="/2024/01/17/sadserver-intro/31.png" alt="题目"></p>
<h4 id="题意-25"><a href="#题意-25" class="headerlink" title="题意"></a>题意</h4><p>本地有一个通过 systemctl 启动的 web 服务，虽然它可以运行但访问其接口会失败，需要修复证书和权限相关的问题，以及防火墙 apparmor 的配置问题</p>
<p><a target="_blank" rel="noopener" href="https://wsxk.github.io/apparmor%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6/">apparmor 的使用方式参考</a></p>
<h4 id="相关指令-26"><a href="#相关指令-26" class="headerlink" title="相关指令"></a>相关指令</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 查看服务定义</span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 一个二进制文件，指定了静态文件路径为 /home/webapp/static-files, 证书文件为 /home/webapp/pki/server.crt</span></span></span><br><span class="line">cat /etc/systemd/system/webapp.service</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 重启 webapp</span></span><br><span class="line">systemctl restart webapp</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 解决 webapp 无法 su 的问题: 替换 webapp 的登录 shell</span></span><br><span class="line">vim /etc/passwd</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 手动启动 webapp</span></span><br><span class="line">export APP_STATIC_DIR=/home/webapp/static-files</span><br><span class="line">export APP_CERT=/home/webapp/pki/server.crt</span><br><span class="line">export APP_KEY=/home/webapp/pki/server.pem</span><br><span class="line">su webapp -c &quot;/usr/local/bin/webapp&quot;</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 修复证书权限问题</span></span><br><span class="line">chown -R webapp:webapp /home/webapp/</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 添加 hosts</span></span><br><span class="line">echo &quot;127.0.0.1 webapp&quot; &gt;&gt; /etc/hosts</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 检查指令</span></span><br><span class="line">curl https://webapp:7000/users.html</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 修复 SSL certificate problem: unable to get <span class="built_in">local</span> issuer certificate 的问题</span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 参考: https://stackoverflow.com/questions/24611640/curl-60-ssl-certificate-problem-unable-to-get-local-issuer-certificate</span></span></span><br><span class="line">cp /home/webapp/pki/CA.crt /usr/local/share/ca-certificates</span><br><span class="line">chmod 644 /usr/local/share/ca-certificates/CA.crt</span><br><span class="line">update-ca-certificates</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 解决 open /home/webapp/static-files/users.html: permission denied 的问题</span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 在防火墙配置中，添加 /home/webapp/static-files/ r 和 /home/webapp/static-files/* r</span></span></span><br><span class="line">vim /etc/apparmor.d/usr.local.bin.webapp</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 更新配置到内核中</span></span></span><br><span class="line">apparmor_parser -r /etc/apparmor.d/usr.local.bin.webapp</span><br></pre></td></tr></table></figure>

<!--

[使用 AppArmor 限制容器对资源的访问](https://kubernetes.io/zh-cn/docs/tutorials/security/apparmor/)

[AppArmor相关各脚本和服务解析（2）](https://blog.csdn.net/phmatthaus/article/details/130863424)

[How do you add a certificate authority (CA) to Ubuntu?](https://superuser.com/questions/437330/how-do-you-add-a-certificate-authority-ca-to-ubuntu)

-->

<h3 id="【postgresql】“Helsingor”-The-first-walls-of-postgres-physical-replication"><a href="#【postgresql】“Helsingor”-The-first-walls-of-postgres-physical-replication" class="headerlink" title="【postgresql】“Helsingør”: The first walls of postgres physical replication"></a>【postgresql】<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/helsingor">“Helsingør”: The first walls of postgres physical replication</a></h3><p><img src="/2024/01/17/sadserver-intro/32.png" alt="题目"></p>
<h4 id="题意-26"><a href="#题意-26" class="headerlink" title="题意"></a>题意</h4><p>本地通过 docker compose 启动了 postgresql，agent/check.sh 也就是检查答案的脚本中，将会先确认备库和主库的同步是否正常。但是目前备库启动失败了，需要找到原因并解决</p>
<p>扩展: <a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/8466223/reuse-a-hash-in-yaml/9197237#9197237">yaml 中复用内容的写法（&amp;）</a></p>
<h4 id="相关指令-27"><a href="#相关指令-27" class="headerlink" title="相关指令"></a>相关指令</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 查看节点状态</span></span><br><span class="line">docker ps -a</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看日志</span></span><br><span class="line">docker logs 98e1b8d4a341</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 重启 compose</span></span><br><span class="line">docker compose down --volumes</span><br><span class="line">docker compose up -d</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 强制重建</span></span></span><br><span class="line">docker compose up -d --force-recreate</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 修改配置</span></span><br><span class="line">vim postgres/replica/postgres.conf</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 批量修复配置</span></span></span><br><span class="line">sed -i &quot;s/max_connections = 80/max_connections = 100/g&quot; postgres/replica/postgres.conf</span><br><span class="line">sed -i &quot;s/max_worker_processes = 4/max_worker_processes = 8/g&quot; postgres/replica/postgres.conf</span><br><span class="line">sed -i &quot;s/max_wal_senders = 5/max_wal_senders = 10/g&quot; postgres/replica/postgres.conf</span><br><span class="line">sed -i &quot;s/max_locks_per_transaction = 32/max_locks_per_transaction = 64/g&quot; postgres/replica/postgres.conf</span><br></pre></td></tr></table></figure>

<!--
# 查看从库数据
docker compose exec postgres-db-replica psql -U helsingor -d helsingor -tc "select person_id from users order by person_id desc limit 1;"

# 
docker compose exec postgres-db-master psql -U helsingor -d helsingor -tc "insert into users (first_name, last_name, age, city, os) values ('Will', 'Smith', '55', 'Philadelphia', 'MacOS')"

docker compose exec postgres-db-replica psql -U helsingor -d helsingor -tc "select person_id from users order by person_id desc limit 1;"
-->

<h3 id="【WSGI】“Bekasi”-Supervisor-is-still-around"><a href="#【WSGI】“Bekasi”-Supervisor-is-still-around" class="headerlink" title="【WSGI】“Bekasi”: Supervisor is still around"></a>【WSGI】<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/bekasi">“Bekasi”: Supervisor is still around</a></h3><p><img src="/2024/01/17/sadserver-intro/33.png" alt="题目"></p>
<h4 id="题意-27"><a href="#题意-27" class="headerlink" title="题意"></a>题意</h4><p>本地通过 uwsgi 启动了一个 https 服务，但通过 curl -k <a target="_blank" rel="noopener" href="https://bekasi/">https://bekasi</a> 调用失败</p>
<p>本题思路是先确认 uwsgi 的部署方式，再确认如何修改它的部署配置，最后重启</p>
<h4 id="相关指令-28"><a href="#相关指令-28" class="headerlink" title="相关指令"></a>相关指令</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 调用服务</span></span><br><span class="line">curl -k https://bekasi</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看 uwsgi 进程</span></span><br><span class="line">ps -ef | grep uwsgi</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看后台逻辑</span></span><br><span class="line">cat bekasi/bekasi.py</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 修改 supervisor 启动 uwsgi 配置</span></span></span><br><span class="line">vim /etc/supervisor/conf.d/uwsgi.conf</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 重载配置并重启服务</span></span><br><span class="line">sudo supervisorctl reload</span><br></pre></td></tr></table></figure>

<!--
cat /etc/supervisor/conf.d/uwsgi.conf
cat /usr/lib/systemd/system/supervisor.service
systemctl restart supervisor

# vim bekasi/bekasi.ini
env             = BEKASI_USER=admin
env             = BEKASI_SERVER=bekasi.sadservers.com

# vim /etc/supervisor/conf.d/uwsgi.conf
environment=BEKASI_USER=admin,BEKASI_SERVER=bekasi.sadservers.com

# 重启 supervisor
systemctl restart supervisor

# 修改 uwsgi 后台服务配置
vim bekasi/bekasi.ini

# （会被 supervisor 自动拉起）
ps -ef | grep "uwsgi" | grep -v grep | awk '{print $2}' | xargs kill -9
-->


<h3 id="【nginx】“Depok”-Nginx-with-Brotli"><a href="#【nginx】“Depok”-Nginx-with-Brotli" class="headerlink" title="【nginx】“Depok”: Nginx with Brotli"></a>【nginx】<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/depok">“Depok”: Nginx with Brotli</a></h3><p><img src="/2024/01/17/sadserver-intro/34.png" alt="题目"></p>
<h4 id="题意-28"><a href="#题意-28" class="headerlink" title="题意"></a>题意</h4><p><a target="_blank" rel="noopener" href="https://github.com/google/ngx_brotli">brotli</a> 是 是 Google 在 2015 年 9 月推出的一种压缩算法，使用通用的 LZ77 无损压缩算法、Huffman 编码和二阶上下文建模（2nd order context modelling）的特定组合，旨在进一步提高压缩比</p>
<p>部署在本地的 nginx 服务目前还不支持 brotli 压缩算法，需要通过 brotli 源码安装插件</p>
<p>本题主要考察 nginx 插件的安装方法</p>
<p>参考: <a target="_blank" rel="noopener" href="https://juejin.cn/post/7031471867609546759">CentOS 8 安装并加载 Nginx 模组 ngx_brotli 然后启用 brotli 压缩</a></p>
<p><a target="_blank" rel="noopener" href="https://ubuntu.com/server/docs/how-to-use-nginx-modules">How to use nginx modules</a></p>
<h4 id="相关指令-29"><a href="#相关指令-29" class="headerlink" title="相关指令"></a>相关指令</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 调用 nginx 并指定编码为 br</span></span><br><span class="line">curl -H &quot;Accept-Encoding: br&quot; -I http://localhost</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 编译 brotli 插件</span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 步骤参考官方仓库 https://github.com/google/ngx_brotli</span></span></span><br><span class="line">cd /home/admin/ngx_brotli/deps/brotli</span><br><span class="line">mkdir out</span><br><span class="line">cd out</span><br><span class="line">cmake -DCMAKE_BUILD_TYPE=Release -DBUILD_SHARED_LIBS=OFF -DCMAKE_C_FLAGS=&quot;-Ofast -m64 -march=native -mtune=native -flto -funroll-loops -ffunction-sections -fdata-sections -Wl,--gc-sections&quot; -DCMAKE_CXX_FLAGS=&quot;-Ofast -m64 -march=native -mtune=native -flto -funroll-loops -ffunction-sections -fdata-sections -Wl,--gc-sections&quot; -DCMAKE_INSTALL_PREFIX=./installed ..</span><br><span class="line">cmake --build . --config Release --target brotlienc</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 重新编译 nginx 并链接 brotli</span></span><br><span class="line">cd /home/admin/nginx</span><br><span class="line">./configure --with-compat --add-dynamic-module=../ngx_brotli</span><br><span class="line">make modules</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 拷贝编译后产生的链接文件</span></span><br><span class="line">cp objs/ngx_http_brotli_filter_module.so /usr/lib/nginx/modules/</span><br><span class="line">cp objs/ngx_http_brotli_static_module.so /usr/lib/nginx/modules/</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 添加</span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># vim /etc/nginx/modules-available/50-ngx-http-brotli.conf</span></span></span><br><span class="line">load_module modules/ngx_http_brotli_filter_module.so;</span><br><span class="line">load_module modules/ngx_http_brotli_static_module.so;</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 开启 brotli 插件</span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># vim /etc/nginx/sites-enabled/default</span></span></span><br><span class="line">server &#123;</span><br><span class="line">	brotli on;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 重载 nginx 配置</span></span><br><span class="line">sudo systemctl reload nginx</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 重启 nginx</span></span><br><span class="line">sudo systemctl restart nginx</span><br></pre></td></tr></table></figure>

<!-- 参考:

[http响应Header：Content-Encoding=br怎么办？](https://blog.csdn.net/lrcxl/article/details/128416117)

-->

<h3 id="【linux】“Tukaani”-XZ-LZMA-Library-Compromised"><a href="#【linux】“Tukaani”-XZ-LZMA-Library-Compromised" class="headerlink" title="【linux】“Tukaani”: XZ LZMA Library Compromised"></a>【linux】<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/tukaani">“Tukaani”: XZ LZMA Library Compromised</a></h3><p><img src="/2024/01/17/sadserver-intro/35.png" alt="题目"></p>
<h4 id="题意-29"><a href="#题意-29" class="headerlink" title="题意"></a>题意</h4><p>liblzma 是一个用于数据压缩的库，提供对 LZMA（Lempel-Ziv-Markov chain algorithm）和 XZ 压缩格式的支持</p>
<p>正常情况下本地服务需要加载的是 /usr/lib/x86_64-linux-gnu/liblzma.so.5.2.5，但通过 sudo lsof | grep liblzma.so.5 可以看到很多进程都加载了 /opt/.trash/liblzma.so.5，需要解决这个问题</p>
<p>本题主要考察预加载库的设置（LD_PRELOAD）</p>
<h4 id="相关指令-30"><a href="#相关指令-30" class="headerlink" title="相关指令"></a>相关指令</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 查看 liblzma 相关进程</span></span><br><span class="line">lsof | grep liblzma.so.5</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 删除无效库</span></span><br><span class="line">rm /opt/.trash/liblzma.so.5</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看所有动态链接库之前预加载的库配置</span></span><br><span class="line">vim /etc/ld.so.preload</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 重启节点</span></span><br><span class="line">reboot</span><br></pre></td></tr></table></figure>

<h2 id="困难"><a href="#困难" class="headerlink" title="困难"></a>困难</h2><p>提醒: 困难的题目似乎登录节点后默认在根目录，需要记得切换到 /home/admin 才能看到题目提供的文件</p>
<h3 id="【linux】“Jakarta”-it’s-always-DNS"><a href="#【linux】“Jakarta”-it’s-always-DNS" class="headerlink" title="【linux】“Jakarta”: it’s always DNS."></a>【linux】<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/jakarta">“Jakarta”: it’s always DNS.</a></h3><p><img src="/2024/01/17/sadserver-intro/36.png" alt="题目"></p>
<h4 id="题意-30"><a href="#题意-30" class="headerlink" title="题意"></a>题意</h4><p>本机无法 ping 通 google.com，直接 ping 返回的是 Name or service not known，</p>
<p>本题是以前 sadserver 的实验题，所以虽然放在困难部分，但只要修复 /etc/nsswitch.conf 配置即可解决</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/emilyyoucan/articles/8118173.html">参考-Linux系统解析域名的先后顺序files（/etc/hosts）OR dns（/etc/resolv.conf）</a></p>
<h4 id="相关指令-31"><a href="#相关指令-31" class="headerlink" title="相关指令"></a>相关指令</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 查看并修复域名解析优先级配置</span></span><br><span class="line">vim /etc/nsswitch.conf</span><br><span class="line">sed -i &quot;s/hosts:.*/hosts:          files dns/g&quot; /etc/nsswitch.conf</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 检查指令</span></span><br><span class="line">ping google.com</span><br></pre></td></tr></table></figure>

<h3 id="【wordpress、docker】“Bern”-Docker-web-container-can’t-connect-to-db-container"><a href="#【wordpress、docker】“Bern”-Docker-web-container-can’t-connect-to-db-container" class="headerlink" title="【wordpress、docker】“Bern”: Docker web container can’t connect to db container."></a>【wordpress、docker】<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/bern">“Bern”: Docker web container can’t connect to db container.</a></h3><p><img src="/2024/01/17/sadserver-intro/37.png" alt="题目"></p>
<h4 id="题意-31"><a href="#题意-31" class="headerlink" title="题意"></a>题意</h4><p>本地通过 docker 启动了 <a target="_blank" rel="noopener" href="https://wordpress.com/zh-cn">wordpress</a> 和 mariadb 两个容器，mariadb 数据库状态正常，但 wordpress 服务无法访问 mariadb，需要解决这个问题</p>
<h4 id="相关指令-32"><a href="#相关指令-32" class="headerlink" title="相关指令"></a>相关指令</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 查看 wordpress 接口返回结果</span></span><br><span class="line">curl -s localhost:80 |tail -4</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 检查 wordpress 容器访问域名 <span class="string">&quot;mysql&quot;</span> 的结果</span></span><br><span class="line">docker exec wordpress mysqladmin -h mysql -u root -ppassword --connect-timeout 2 ping</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看 wordpress 容器的详细信息（ 主要看环境变量 Env ）</span></span><br><span class="line">docker inspect 6ffb084b515c</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看 wordpress 容器中设置的连接数据库相关的环境变量</span></span><br><span class="line">docker exec wordpress env | grep WORDPRESS_DB_</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看 wordpress 配置文件中，和连接数据库相关的环境变量</span></span><br><span class="line">grep WORDPRESS_DB_ /home/admin/html/wp-config.php</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 删除容器</span></span><br><span class="line">docker rm 6ffb084b515c</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 启动新的 设置了域名映射的 wordpress 容器</span></span><br><span class="line">docker run -it -p 80:80 -e WORDPRESS_DB_PASSWORD=password -e WORDPRESS_DB_USER=root --add-host mysql:172.17.0.1 --name wordpress -d wordpress:sad</span><br></pre></td></tr></table></figure>

<!--
# 查看重启脚本
cat /usr/local/bin/docker-entrypoint.sh

# 重启 wordpress
ps -ef | grep 'apache2' | grep -v grep | awk '{print $2}' | xargs --no-run-if-empty kill -9
/usr/local/bin/docker-entrypoint.sh apache2-foreground

# 设置 wordpress 数据库配置相关的环境变量
## export WORDPRESS_DB_PASSWORD=password
## export WORDPRESS_DB_USER=root
export WORDPRESS_DB_HOST=172.17.0.1(容器连接宿主机的地址)

# 修改 wordpress 配置文件
vim ./wp-config.php
## 172.17.0.1: 容器连接宿主机的地址
## sed -i "s/'WORDPRESS_DB_HOST', 'mysql'/'WORDPRESS_DB_HOST', '172.17.0.1'/g" wp-config.php

# hosts 中设置域名和ip映射
echo "172.17.0.1 mysql" >> /etc/hosts

# 重启容器
docker restart 6ffb084b515c
-->

<h3 id="【推荐】【linux】“Karakorum”-WTFIT-–-What-The-Fun-Is-This"><a href="#【推荐】【linux】“Karakorum”-WTFIT-–-What-The-Fun-Is-This" class="headerlink" title="【推荐】【linux】“Karakorum”: WTFIT – What The Fun Is This?"></a>【推荐】【linux】<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/karakorum">“Karakorum”: WTFIT – What The Fun Is This?</a></h3><p><img src="/2024/01/17/sadserver-intro/38.png" alt="题目"></p>
<h4 id="题意-32"><a href="#题意-32" class="headerlink" title="题意"></a>题意</h4><p>/home/admin/wtfit 文件是一个需要连接某个地址才能启动的服务。但首先它因为没有可执行权限而无法执行，其次它实际执行也有报错，需要给它添加可执行权限，并解决运行文件使得其能够正常启动</p>
<h4 id="相关指令-33"><a href="#相关指令-33" class="headerlink" title="相关指令"></a>相关指令</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> chmod 添加可执行权限</span></span><br><span class="line">chmod +x /home/admin/wtfit</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 通过 perl 脚本调用 chmod</span></span><br><span class="line">perl -e &#x27;chmod 0755, &quot;/usr/bin/chmod&quot;&#x27;</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 通过 ld-linux （动态链接器） 调用 chmod</span></span><br><span class="line">/lib64/ld-linux-x86-64.so.2 /usr/bin/chmod +x /usr/bin/chmod</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 执行二进制文件，并跟踪进程堆栈</span></span><br><span class="line">strace /home/admin/wtfit</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 通过 python 快速启动一个监听端口 7777 http 服务端</span></span><br><span class="line">python3 -m http.server 7777 &amp;</span><br></pre></td></tr></table></figure>

<h3 id="【kubernetes】“Singara”-Docker-and-Kubernetes-web-app-not-working"><a href="#【kubernetes】“Singara”-Docker-and-Kubernetes-web-app-not-working" class="headerlink" title="【kubernetes】“Singara”: Docker and Kubernetes web app not working."></a>【kubernetes】<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/singara">“Singara”: Docker and Kubernetes web app not working.</a></h3><p><img src="/2024/01/17/sadserver-intro/39.png" alt="题目"></p>
<h4 id="题意-33"><a href="#题意-33" class="headerlink" title="题意"></a>题意</h4><p>本地通过 <a target="_blank" rel="noopener" href="https://github.com/k3s-io/k3s">k3s</a> 启动了一个轻量级 kubernetes 集群，并在 /home/admin/deployment.yml 中定义了 webapp 这个 web 服务，但是容器启动有问题，通过 curl -i localhost:8888 无法调通，需要解决</p>
<h4 id="相关指令-34"><a href="#相关指令-34" class="headerlink" title="相关指令"></a>相关指令</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 获取所有 pod</span></span><br><span class="line">kubectl get pod -A</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 获取 pod 的描述信息</span></span><br><span class="line">kubectl describe pod webapp-deployment-666b67994b-5sffz -n web</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 启动 register 镜像仓库</span></span><br><span class="line">docker run -d -p 5000:5000 registry:2</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 提交镜像 webapp 到本地镜像仓库</span></span><br><span class="line">docker tag webapp localhost:5000/webapp</span><br><span class="line">docker push localhost:5000/webapp</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 修改 deployment 并重新启动</span></span><br><span class="line">kubectl delete deployment webapp-deployment -n web</span><br><span class="line">vim /home/admin/deployment.yml</span><br><span class="line">kubectl apply -f /home/admin/deployment.yml</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 开放端口</span></span><br><span class="line">kubectl port-forward deployments/webapp-deployment 8888 -n web &amp; </span><br></pre></td></tr></table></figure>

<h3 id="【postgresql】“Hong-Kong”-can’t-write-data-into-database"><a href="#【postgresql】“Hong-Kong”-can’t-write-data-into-database" class="headerlink" title="【postgresql】“Hong-Kong”: can’t write data into database."></a>【postgresql】<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/hongkong">“Hong-Kong”: can’t write data into database.</a></h3><p><img src="/2024/01/17/sadserver-intro/40.png" alt="题目"></p>
<h4 id="题意-34"><a href="#题意-34" class="headerlink" title="题意"></a>题意</h4><p>本地启动了 postgresql 但无法正常连接和插入数据，需要从 pg 的存储目录配置去分析原因</p>
<h4 id="相关指令-35"><a href="#相关指令-35" class="headerlink" title="相关指令"></a>相关指令</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 检查指令: 向 pg 中插入一条数据</span></span><br><span class="line">sudo -u postgres psql -c &quot;insert into persons(name) values (&#x27;jane smith&#x27;);&quot; -d dt</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 手动启动 pg server 并确认报错</span></span><br><span class="line">pg_ctlcluster 14 main restart -m fast</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看配置中的存储目录</span></span><br><span class="line">cat /etc/postgresql/14/main/postgresql.conf | grep data_directory</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 创建数据目录并初始化</span></span><br><span class="line">mkdir -p /opt/pgdata</span><br><span class="line">chown -R postgres:postgres /opt/pgdata</span><br><span class="line">su postgres -c &quot;/usr/lib/postgresql/14/bin/initdb -D /opt/pgdata/main&quot;</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 重启 pgsql</span></span><br><span class="line">systemctl restart postgresql</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 从日志确认启动启动是否正常</span></span><br><span class="line">tail -f /var/log/postgresql/postgresql-14-main.log</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 创建库表</span></span><br><span class="line">sudo -u postgres psql -c &quot;create database dt&quot;</span><br><span class="line">sudo -u postgres psql -c &quot;CREATE TABLE persons(name varchar(100))&quot; -d dt</span><br></pre></td></tr></table></figure>

<h3 id="【推荐】【linux】“Pokhara”-SSH-and-other-sshenanigans"><a href="#【推荐】【linux】“Pokhara”-SSH-and-other-sshenanigans" class="headerlink" title="【推荐】【linux】“Pokhara”: SSH and other sshenanigans"></a>【推荐】【linux】<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/pokhara">“Pokhara”: SSH and other sshenanigans</a></h3><p><img src="/2024/01/17/sadserver-intro/41.png" alt="题目"></p>
<h4 id="题意-35"><a href="#题意-35" class="headerlink" title="题意"></a>题意</h4><p>本机启动了 sshd，且 client 用户下已经设置了 ssh key ， 期望是可以通过 ssh client@localhost 免密访问本机，但是目前会失败，找到账号和 ssh 相关的问题并解决</p>
<p>注: /home/client/.ssh/authorized_keys 中已经添加了公钥</p>
<p>本题涉及面很广，包括 ssh 配置、linux 用户配置、用户可用系统资源配置等，但整体都是围绕 su client 和 ssh client@localhost 失败来解决的，建议实际解题时，通过这两个指令执行的报错一步步解决</p>
<h4 id="相关指令-36"><a href="#相关指令-36" class="headerlink" title="相关指令"></a>相关指令</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 切换 client 用户</span></span><br><span class="line">su client</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 解决 <span class="string">&quot;Your account has expired; please contact your system administrator.&quot;</span> 问题</span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 查看 client 用户的过期时间</span></span></span><br><span class="line">chage -l client</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 设置 client 用户过期时间</span></span></span><br><span class="line">chage -E 2024-12-31 client</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 解决 <span class="string">&quot;su: failed to execute /usr/sbin/nologin: Resource temporarily unavailable&quot;</span> 问题</span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 查看用户登录信息 （登录脚本）</span></span></span><br><span class="line">lslogins client</span><br><span class="line"><span class="meta">#</span><span class="bash"> 或: cat /etc/passwd | grep client</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 设置用户登录 shell 为 /bin/bash</span></span><br><span class="line">usermod --shell /bin/bash client</span><br><span class="line"><span class="meta">#</span><span class="bash"> 或: sed -i <span class="string">&quot;s#/home/client:/usr/sbin/nologin#/home/client:/bin/bash#g&quot;</span> /etc/passwd</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 检查指令: ssh 到 client 用户并执行 <span class="built_in">pwd</span></span></span><br><span class="line">ssh -v client@localhost &quot;pwd&quot;</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 解决 &quot;su: failed to execute /usr/sbin/nologin: Resource temporarily unavailable&quot; 问题</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># https://access.redhat.com/solutions/30316</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 查看文件描述符配置 （需要修改）</span></span></span><br><span class="line">vim /etc/security/limits.conf</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 解决 ssh client 问题</span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># https://askubuntu.com/a/343217</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># root 用户下生成ssh密钥对，并把公钥写入 client 的 authorized_keys 中</span></span></span><br><span class="line">ssh-keygen</span><br><span class="line">cat ~/.ssh/id_rsa.pub &gt;&gt; /home/client/.ssh/authorized_keys</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 清空 known_hosts</span></span></span><br><span class="line">echo &quot;&quot; &gt; /home/client/.ssh/known_hosts</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 修正私钥文件权限</span></span><br><span class="line">chmod 600 /home/client/.ssh/*</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 删除 ssh 错误配置并重启 sshd</span></span><br><span class="line">rm /etc/ssh/sshd_config.d/sad.conf</span><br><span class="line">systemctl restart sshd</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 最后，切回 admin 用户并执行 ssh，使得 known hosts 被刷新</span></span><br><span class="line">sudo -u client ssh client@localhost &#x27;pwd&#x27;</span><br></pre></td></tr></table></figure>

<h3 id="【linux】“Roseau”-Hack-a-Web-Server"><a href="#【linux】“Roseau”-Hack-a-Web-Server" class="headerlink" title="【linux】“Roseau”: Hack a Web Server"></a>【linux】<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/roseau">“Roseau”: Hack a Web Server</a></h3><p><img src="/2024/01/17/sadserver-intro/42.png" alt="题目"></p>
<h4 id="题意-36"><a href="#题意-36" class="headerlink" title="题意"></a>题意</h4><p>在本机的 apache web 服务器上存有一个密码文件，通过 zip 方式加密压缩。这个压缩文件通过 admin 用户无法直接访问，需要调用 apache 接口拿到，然而 apache 接口也是需要密码（配置: AuthUserFile）。因此需要通过密码破解工具 john 分别破解 apache 的密码 以及 压缩文件</p>
<p>本题主要是介绍暴力破解工具 <a target="_blank" rel="noopener" href="https://github.com/openwall/john">john</a> 的使用。它的原理简单来说是通过 预先准备的词典、哈希字典，对特定加密方式进行特定的暴力破解</p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/395718068">参考-使用John the ripper破解密码</a></p>
<h4 id="相关指令-37"><a href="#相关指令-37" class="headerlink" title="相关指令"></a>相关指令</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 查看 httpd 配置，包括根路径和认证方式</span></span><br><span class="line">cat /etc/apache2/sites-enabled/000-default.conf</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看 apache 根路径下的压缩文件</span></span><br><span class="line">ls -l /var/www/html</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 破解 httpd 密码</span></span><br><span class="line">/home/admin/john/run/john /etc/apache2/.htpasswd</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 下载 webfile 文件</span></span><br><span class="line">curl localhost/webfile -u &quot;carlos:(这里替换成httpd密码)&quot; --output secret</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 解密 secret （格式: zip） 密码</span></span><br><span class="line">/home/admin/john/run/zip2john secret &gt; zip.hash</span><br><span class="line">/home/admin/john/run/john zip.hash</span><br></pre></td></tr></table></figure>

<!--
curl localhost/webfile -u "carlos:chalet" --output secret
unzip -p andes
-->

<h3 id="【java、linux】“Belo-Horizonte”-A-Java-Enigma"><a href="#【java、linux】“Belo-Horizonte”-A-Java-Enigma" class="headerlink" title="【java、linux】“Belo-Horizonte”: A Java Enigma"></a>【java、linux】<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/belo-horizonte">“Belo-Horizonte”: A Java Enigma</a></h3><p><img src="/2024/01/17/sadserver-intro/43.png" alt="题目"></p>
<h4 id="题意-37"><a href="#题意-37" class="headerlink" title="题意"></a>题意</h4><p>Sad.class 是一段 java 程序，成功执行后，会打印一段题目需要的密码，但它目前是无法执行的，需要通过反编译等方法解决</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/yu20190429/article/details/109050769">参考: 使用fallocate命令创建swap分区</a></p>
<h4 id="相关指令-38"><a href="#相关指令-38" class="headerlink" title="相关指令"></a>相关指令</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 运行 class</span></span><br><span class="line">java Sad.class</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看 /usr/bin/java 指向的实际的文件</span></span><br><span class="line">readlink -f /usr/bin/java</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看本机安装的其他版本 java</span></span><br><span class="line">ls -l /usr/lib/jvm | grep java</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 将 /usr/bin/java 指向新的地址</span></span><br><span class="line">sudo rm /usr/bin/java</span><br><span class="line">sudo ln -s /usr/lib/jvm/java-1.17.0-openjdk-amd64/bin/java /usr/bin/java</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 反编译 Sad.class</span></span><br><span class="line">javap -c -l Sad.class</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 重命名</span></span><br><span class="line">mv Sad.class VerySad.class</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看本地内存（总剩余内存只有 200m 左右，不足以运行进程）</span></span><br><span class="line">free -m</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看本地磁盘（可以看到至少有4G空间）</span></span><br><span class="line">df -h</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 以本地磁盘申请交换空间</span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 申请1G空间</span></span></span><br><span class="line">sudo fallocate -l 1G /swapfile</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 设置文件权限为600</span></span></span><br><span class="line">sudo chmod 600 /swapfile</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 将文件设置为交换空间</span></span></span><br><span class="line">sudo mkswap /swapfile</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 启用交换文件</span></span></span><br><span class="line">sudo swapon /swapfile</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 查看交换空间</span></span></span><br><span class="line">sudo swapon --show</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 再次查看内存</span></span></span><br><span class="line">free -m</span><br></pre></td></tr></table></figure>

<h3 id="【rabbitmq、docker】“Chennai”-Pull-a-Rabbit-from-a-Hat"><a href="#【rabbitmq、docker】“Chennai”-Pull-a-Rabbit-from-a-Hat" class="headerlink" title="【rabbitmq、docker】“Chennai”: Pull a Rabbit from a Hat"></a>【rabbitmq、docker】<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/chennai">“Chennai”: Pull a Rabbit from a Hat</a></h3><p><img src="/2024/01/17/sadserver-intro/44.png" alt="题目"></p>
<h4 id="题意-38"><a href="#题意-38" class="headerlink" title="题意"></a>题意</h4><p>在本地的 rabbitmq-cluster-docker-master 目录下，提供了启动 rabbitmq 三节点集群的 compose 仓库（参考这个 <a target="_blank" rel="noopener" href="https://github.com/serkodev/rabbitmq-cluster-docker">serkodev/rabbitmq-cluster-docker</a> ），需要正常启动集群，并先后运行 <code>python3 ~/producer.py hello-lwc</code> 和 <code>python3 ~/consumer.py</code>，完成一个完整的生产和消费过程</p>
<p>注意: 虽然 consumer.py 和 producer.py 中确实有一些连接参数不太一致，但题目要求不能修改这两个代码文件，否则校验答案会失败，因此只能通过设置环境变量的方式来解决</p>
<h4 id="相关指令-39"><a href="#相关指令-39" class="headerlink" title="相关指令"></a>相关指令</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 重启 rabbitmq 集群</span></span><br><span class="line">docker compose down --volumes</span><br><span class="line">docker compose up -d</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 修改启动脚本最后一段，tail 之前创建一个空日志文件，解决 tail 执行失败导致卡住的问题</span></span><br><span class="line">touch /var/log/rabbitmq/empty.log</span><br><span class="line">vim cluster-entrypoint.sh</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看 .env 文件（ compose 默认使用的环境变量 ），并将其修改为 consumer.py 中写死的用户名和密码</span></span><br><span class="line">cat ./.env</span><br><span class="line">export RABBITMQ_DEFAULT_USER=username</span><br><span class="line">export RABBITMQ_DEFAULT_PASS=password</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 设置环境变量并触发生产者</span></span><br><span class="line">export RMQ_QUEUE=hello</span><br><span class="line">export RMQ_USER=username</span><br><span class="line">export RMQ_PASSWORD=password</span><br><span class="line">python3 ~/producer.py hello-lwc</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 触发消费者</span></span><br><span class="line">python3 ~/consumer.py</span><br></pre></td></tr></table></figure>

<!--
# 添加用户
docker exec rabbitmq-cluster-docker-master-rabbitmq1-1 rabbitmqctl add_user username password

docker exec rabbitmq-cluster-docker-master-rabbitmq1-1 rabbitmqctl set_permissions -p / username ".*" ".*" ".*"

docker exec rabbitmq-cluster-docker-master-rabbitmq1-1 ls -l /var/log/rabbitmq/

docker exec rabbitmq-cluster-docker-master-rabbitmq1-1 find / -name 'rabbitmq.conf'

log.dir = /var/log/rabbitmq
-->

<h3 id="【git、linux】“Monaco”-Disappearing-Trick"><a href="#【git、linux】“Monaco”-Disappearing-Trick" class="headerlink" title="【git、linux】“Monaco”: Disappearing Trick"></a>【git、linux】<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/monaco">“Monaco”: Disappearing Trick</a></h3><p><img src="/2024/01/17/sadserver-intro/45.png" alt="题目"></p>
<h4 id="题意-39"><a href="#题意-39" class="headerlink" title="题意"></a>题意</h4><p>本地 5000 端口上启动了一个 web 服务，通过 post 方法指定密码调用它的接口后，会返回一个密钥，需要把这个密钥写入 mysolution 文件中</p>
<p>根据提示，当前路径是一个代码工作路径，“那么”（虽然感觉这个推理有点牵强）可以推测是一个 git 路径，但是本地并没有代码，可以通过 git 指令恢复 webserver 的代码，确认其需要的密码是在哪个环境变量中定义的，并在已启动的 webserver 进程中，找到对应的环境变量</p>
<h4 id="相关指令-40"><a href="#相关指令-40" class="headerlink" title="相关指令"></a>相关指令</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 恢复 git 项目（即：重新拉取代码）</span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 显示目前文件差异</span></span></span><br><span class="line">git status</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 恢复指定文件</span></span></span><br><span class="line">git restore webserver_v1.py</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 或: 恢复当前路径下的所有文件</span></span></span><br><span class="line">git restore .</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看 webserver 逻辑</span></span><br><span class="line">cat webserver_v1.py</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 查找 webserver_v1.py 配置的密码相关的环境变量，在已启动的 webserver 服务中定义的值</span></span><br><span class="line">ps -ef | grep webserver.py | grep -v grep | awk &#x27;&#123;print $2&#125;&#x27; | xargs -I &#123;&#125; bash -c &quot;cat /proc/&#123;&#125;/environ&quot; | tr &#x27;\000&#x27; &#x27;\n&#x27; | grep &quot;(环境变量名)&quot;</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 访问 webserver 并指定密码，并将得到的 secret 写入 mysolution 文件中</span></span><br><span class="line">secret=`curl -X POST localhost:5000 --data-raw &quot;password=(上一步得到的密码)&quot; | sed &#x27;s/.* //g&#x27;`</span><br><span class="line">echo &quot;$secret&quot; &gt; ~/mysolution</span><br></pre></td></tr></table></figure>

<h3 id="【docker】“Florence”-Database-Migration-Hell"><a href="#【docker】“Florence”-Database-Migration-Hell" class="headerlink" title="【docker】“Florence”: Database Migration Hell"></a>【docker】<a target="_blank" rel="noopener" href="https://sadservers.com/scenario/florence">“Florence”: Database Migration Hell</a></h3><p><img src="/2024/01/17/sadserver-intro/46.png" alt="题目"></p>
<h4 id="题意-40"><a href="#题意-40" class="headerlink" title="题意"></a>题意</h4><p>/home/admin/app/docker-compose.yml 中定义了一个 nginx + nodejs + postgresql 的后台服务，其中 pgsql 作为数据库；api 服务进行数据库访问用户的初始化，以及提供接口；api_aggregator 对 pgsql 进行访问权限验证；nginx 服务提供代理和 https 接口。正常的启动和初始化顺序为: pgsql -&gt; d</p>
<p>现在这些服务的启动和访问有问题，需要解决</p>
<h4 id="相关指令-41"><a href="#相关指令-41" class="headerlink" title="相关指令"></a>相关指令</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 查看 compose 定义</span></span><br><span class="line">cat ~/app/docker-compose.yml</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看并修改 postgresql Dockerfile，以解决 postgresql 容器日志中的 <span class="string">&quot;initdb: cannot be run as root&quot;</span> 问题</span></span><br><span class="line">vim ~/app/postgresql/Dockerfile</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 重启容器并重新构建镜像</span></span><br><span class="line">docker compose down --volumes</span><br><span class="line">docker compose up --build -d</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 添加 解决 api_aggregator 连接 pg 失败的问题</span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 第14行添加内容</span></span></span><br><span class="line">sed -i &quot;14iecho \&quot;host all api_aggregator 0.0.0.0/0 md5\&quot; &gt;&gt; /var/lib/postgresql/data/pg_hba.conf&quot; ~/app/postgresql/entrypoint.sh</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 解决 api_aggregator 容器日志提示连接 pgsql 失败问题</span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 查看 app 服务启动时对 pgsql 的 migrations 逻辑(go-pg/migrations.NewCollection.DiscoverSQLMigrations</span></span></span><br><span class="line">cat ~/app/api/pkg/db/db.go</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 查看 api_aggregator 服务所用的账号和密码</span></span></span><br><span class="line">cat ~/app/docker-compose.yml | grep DATABASE_URL</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 计算密码的 md5 值</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 注意计算方式: 密码和用户名一起计算，参考源码 https://github.com/postgres/postgres/blob/REL_17_STABLE/src/interfaces/libpq/fe-auth.c#L732</span></span></span><br><span class="line">echo -n (上一步得到的密码)(上一步得到的用户名) | md5sum | awk &#x27;&#123;print $1&#125;&#x27;</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 创建 api_aggregator 访问需要的用户</span></span></span><br><span class="line">sed -i &quot;s/CREATE ROLE api_aggregator .*/CREATE ROLE api_aggregator LOGIN PASSWORD &#x27;(上一步计算得到的md5值)&#x27;;/g&quot; ~/app/api/migrations/1_users.up.sql</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># api 服务中添加适当 sleep ，防止执行 migration 时 pgsql 还未启动导致报错</span></span></span><br><span class="line">sed -i &quot;10i\&quot;time\&quot;&quot; ~/app/api/server.go</span><br><span class="line">sed -i &quot;14itime.Sleep(10 * time.Second)&quot; ~/app/api/server.go</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># api_aggregator 服务中添加适当 sleep，原因同上</span></span></span><br><span class="line">sed -i &quot;s#CMD node.*#CMD sleep 10; node /usr/src/app/index.js#g&quot; ~/app/api_aggregator/Dockerfile</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 注: 截止到这一步，重启容器后4个容器应该状态都是正常的了</span></span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 将 sadserver.local 域名映射到本地(<span class="keyword">for</span> nginx)</span></span><br><span class="line">echo &quot;127.0.0.1 sadserver.local&quot; &gt;&gt; /etc/hosts</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 重新生成证书，解决证书过期问题: curl: (60) SSL certificate problem: certificate has expired</span></span><br><span class="line">openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/nginx/certs/sadserver.key -out /etc/nginx/certs/sadserver.crt -subj &quot;/C=CN/ST=SZ/L=NS/O=Internet/OU=Company/CN=sadserver.local&quot;</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 重启 nginx</span></span><br><span class="line">systemctl restart nginx</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 验证接口访问</span></span><br><span class="line">curl --cacert /etc/nginx/certs/sadserver.crt https://sadserver.local</span><br></pre></td></tr></table></figure>

<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>最近看了IT狂人这部剧，刚好想到，IT人平时的工作可能很杂，这里搞一点开发，那里做一点运维，甚至还没有程序那样有逻辑，但从外面来看，IT人确实是在做很多事情的，只是他们好像在一个锁上的礼物盒那样，不打开就不知道里面有什么</p>
<p>这部剧，和 sadserver 这个解题平台，都像是打开这个盒子的钥匙</p>
<!--

整理完题目之余，就以一首适合夜晚的歌曲作为结束吧

《little girl》

-->

<!--
不是所有 linux 指令都能经常用到，但没有一个指令是没有用的
-->

<!--
作者温馨提醒: 做完一道题之后最好及时关闭服务器，可以帮他省钱

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo shutdown -h now</span><br></pre></td></tr></table></figure>

<p>更新: 现在做完一道题后，只要 check 通过了，会自动关闭服务器。。</p>
<p>–&gt;</p>
<!--

---- 当前: 后续将这篇文章在 推 发，@ 一下，有点意思。。。有机会翻译成英文

maybe I can translate it to english, when i am free...

-->

<!--

今天的听会歌: 此刻写本文在听的歌，也是身边枪迷给我的礼物

-->

<!--
后续发现的新题目: https://sadservers.com/scenario/luc
--></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:xxx@gmail.com">smiecj</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://smiecj.github.io/2024/01/17/sadserver-intro/">http://smiecj.github.io/2024/01/17/sadserver-intro/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://smiecj.github.io" target="_blank">Smiecj的小窝</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/linux/">linux</a><a class="post-meta__tags" href="/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/">操作系统</a><a class="post-meta__tags" href="/tags/life/">life</a></div><div class="post_share"><div class="social-share" data-image="/2024/01/17/sadserver-intro/cover.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/04/25/azkaban-tools/"><img class="prev-cover" src="/img/blog_img/azkaban.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">azkaban-tools 项目介绍</div></div></a></div><div class="next-post pull-right"><a href="/2023/12/06/program-100-qas/"><img class="next-cover" src="/2023/12/06/program-100-qas/cover.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">互联网之100问</div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="gitalk-container"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://avatars.githubusercontent.com/u/14009307" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">smiecj</div><div class="author-info__description">写写生活，做做笔记，聊聊日常</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">44</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">40</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">28</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/smiecj"><i class="fab fa-github"></i><span>访问主页</span></a></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%83%8C%E6%99%AF"><span class="toc-number">1.</span> <span class="toc-text">背景</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E5%88%86%E7%B1%BB"><span class="toc-number">2.</span> <span class="toc-text">题目分类</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E8%A7%A3%E9%A2%98"><span class="toc-number">3.</span> <span class="toc-text">如何解题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-%E7%AE%80%E5%8D%95"><span class="toc-number">4.</span> <span class="toc-text">Level: 简单</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90linux%E3%80%91%E2%80%9CSaint-John%E2%80%9D-what-is-writing-to-this-log-file"><span class="toc-number">4.1.</span> <span class="toc-text">【linux】“Saint John”: what is writing to this log file?</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E6%84%8F"><span class="toc-number">4.1.1.</span> <span class="toc-text">题意</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4"><span class="toc-number">4.1.2.</span> <span class="toc-text">相关指令</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E6%8E%A8%E8%8D%90%E3%80%91%E3%80%90linux%E3%80%91%E2%80%9CSaskatoon%E2%80%9D-counting-IPs"><span class="toc-number">4.2.</span> <span class="toc-text">【推荐】【linux】“Saskatoon”: counting IPs.</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E6%84%8F-1"><span class="toc-number">4.2.1.</span> <span class="toc-text">题意</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4-1"><span class="toc-number">4.2.2.</span> <span class="toc-text">相关指令</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E6%8E%A8%E8%8D%90%E3%80%91%E3%80%90linux%E3%80%91%E2%80%9CSantiago%E2%80%9D-Find-the-secret-combination"><span class="toc-number">4.3.</span> <span class="toc-text">【推荐】【linux】“Santiago”: Find the secret combination</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E6%84%8F-2"><span class="toc-number">4.3.1.</span> <span class="toc-text">题意</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4-2"><span class="toc-number">4.3.2.</span> <span class="toc-text">相关指令</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#The-Command-Line-Murders"><span class="toc-number">4.4.</span> <span class="toc-text">The Command Line Murders</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E6%8E%A8%E8%8D%90%E3%80%91%E3%80%90linux%E3%80%91%E2%80%9CTaipei%E2%80%9D-Come-a-knocking"><span class="toc-number">4.5.</span> <span class="toc-text">【推荐】【linux】“Taipei”: Come a-knocking</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E6%84%8F-3"><span class="toc-number">4.5.1.</span> <span class="toc-text">题意</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4-3"><span class="toc-number">4.5.2.</span> <span class="toc-text">相关指令</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E6%8E%A8%E8%8D%90%E3%80%91%E3%80%90linux%E3%80%91%E2%80%9CLhasa%E2%80%9D-Easy-Math"><span class="toc-number">4.6.</span> <span class="toc-text">【推荐】【linux】“Lhasa”: Easy Math</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E6%84%8F-4"><span class="toc-number">4.6.1.</span> <span class="toc-text">题意</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4-4"><span class="toc-number">4.6.2.</span> <span class="toc-text">相关指令</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90postgresql%E3%80%91%E2%80%9CBucharest%E2%80%9D-Connecting-to-Postgres"><span class="toc-number">4.7.</span> <span class="toc-text">【postgresql】“Bucharest”: Connecting to Postgres</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E6%84%8F-5"><span class="toc-number">4.7.1.</span> <span class="toc-text">题意</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4-5"><span class="toc-number">4.7.2.</span> <span class="toc-text">相关指令</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90kubernetes%E3%80%91%E2%80%9CBilbao%E2%80%9D-Basic-Kubernetes-Problems"><span class="toc-number">4.8.</span> <span class="toc-text">【kubernetes】“Bilbao”: Basic Kubernetes Problems</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E6%84%8F-6"><span class="toc-number">4.8.1.</span> <span class="toc-text">题意</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4-6"><span class="toc-number">4.8.2.</span> <span class="toc-text">相关指令</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90linux%E3%80%91%E2%80%9CApia%E2%80%9D-Needle-in-a-Haystack"><span class="toc-number">4.9.</span> <span class="toc-text">【linux】“Apia”: Needle in a Haystack</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E6%84%8F-7"><span class="toc-number">4.9.1.</span> <span class="toc-text">题意</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4-7"><span class="toc-number">4.9.2.</span> <span class="toc-text">相关指令</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%AD%E7%AD%89"><span class="toc-number">5.</span> <span class="toc-text">中等</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90postgresql%E3%80%91%E2%80%9CManhattan%E2%80%9D-can%E2%80%99t-write-data-into-database"><span class="toc-number">5.1.</span> <span class="toc-text">【postgresql】“Manhattan”: can’t write data into database.</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E6%84%8F-8"><span class="toc-number">5.1.1.</span> <span class="toc-text">题意</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4-8"><span class="toc-number">5.1.2.</span> <span class="toc-text">相关指令</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E6%8E%A8%E8%8D%90%E3%80%91%E3%80%90httpd%E3%80%81linux%E3%80%91%E2%80%9CTokyo%E2%80%9D-can%E2%80%99t-serve-web-file"><span class="toc-number">5.2.</span> <span class="toc-text">【推荐】【httpd、linux】“Tokyo”: can’t serve web file</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E6%84%8F-9"><span class="toc-number">5.2.1.</span> <span class="toc-text">题意</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4-9"><span class="toc-number">5.2.2.</span> <span class="toc-text">相关指令</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90nginx%E3%80%91%E2%80%9CCape-Town%E2%80%9D-Borked-Nginx"><span class="toc-number">5.3.</span> <span class="toc-text">【nginx】“Cape Town”: Borked Nginx</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E6%84%8F-10"><span class="toc-number">5.3.1.</span> <span class="toc-text">题意</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4-10"><span class="toc-number">5.3.2.</span> <span class="toc-text">相关指令</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90docker%E3%80%91%E2%80%9CSalta%E2%80%9D-Docker-container-won%E2%80%99t-start"><span class="toc-number">5.4.</span> <span class="toc-text">【docker】“Salta”: Docker container won’t start.</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E6%84%8F-11"><span class="toc-number">5.4.1.</span> <span class="toc-text">题意</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4-11"><span class="toc-number">5.4.2.</span> <span class="toc-text">相关指令</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90linux%E3%80%91%E2%80%9COaxaca%E2%80%9D-Close-an-Open-File"><span class="toc-number">5.5.</span> <span class="toc-text">【linux】“Oaxaca”: Close an Open File</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E6%84%8F-12"><span class="toc-number">5.5.1.</span> <span class="toc-text">题意</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4-12"><span class="toc-number">5.5.2.</span> <span class="toc-text">相关指令</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90nginx%E3%80%81gunicorn%E3%80%91%E2%80%9CMelbourne%E2%80%9D-WSGI-with-Gunicorn"><span class="toc-number">5.6.</span> <span class="toc-text">【nginx、gunicorn】“Melbourne”: WSGI with Gunicorn</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E6%84%8F-13"><span class="toc-number">5.6.1.</span> <span class="toc-text">题意</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4-13"><span class="toc-number">5.6.2.</span> <span class="toc-text">相关指令</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90etcd%E3%80%81linux%E3%80%91%E2%80%9CLisbon%E2%80%9D-etcd-SSL-cert-troubles"><span class="toc-number">5.7.</span> <span class="toc-text">【etcd、linux】“Lisbon”: etcd SSL cert troubles</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E6%84%8F-14"><span class="toc-number">5.7.1.</span> <span class="toc-text">题意</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4-14"><span class="toc-number">5.7.2.</span> <span class="toc-text">相关指令</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E6%8E%A8%E8%8D%90%E3%80%91%E3%80%90linux%E3%80%91%E2%80%9CKihei%E2%80%9D-Surely-Not-Another-Disk-Space-Scenario"><span class="toc-number">5.8.</span> <span class="toc-text">【推荐】【linux】“Kihei”: Surely Not Another Disk Space Scenario</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E6%84%8F-15"><span class="toc-number">5.8.1.</span> <span class="toc-text">题意</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4-15"><span class="toc-number">5.8.2.</span> <span class="toc-text">相关指令</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90linux%E3%80%91%E2%80%9CUnimak-Island%E2%80%9D-Fun-with-Mr-Jason"><span class="toc-number">5.9.</span> <span class="toc-text">【linux】“Unimak Island”: Fun with Mr Jason</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E6%84%8F-16"><span class="toc-number">5.9.1.</span> <span class="toc-text">题意</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4-16"><span class="toc-number">5.9.2.</span> <span class="toc-text">相关指令</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90python%E3%80%81go%E3%80%91%E2%80%9CIvujivik%E2%80%9D-Parlez-vous-Francais"><span class="toc-number">5.10.</span> <span class="toc-text">【python、go】“Ivujivik”: Parlez-vous Français?</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E6%84%8F-17"><span class="toc-number">5.10.1.</span> <span class="toc-text">题意</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4-17"><span class="toc-number">5.10.2.</span> <span class="toc-text">相关指令</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90linux%E3%80%91%E2%80%9CParis%E2%80%9D-Where-is-my-webserver"><span class="toc-number">5.11.</span> <span class="toc-text">【linux】“Paris”: Where is my webserver?</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E6%84%8F-18"><span class="toc-number">5.11.1.</span> <span class="toc-text">题意</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4-18"><span class="toc-number">5.11.2.</span> <span class="toc-text">相关指令</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90kubernetes%E3%80%91%E2%80%9CBuenos-Aires%E2%80%9D-Kubernetes-Pod-Crashing"><span class="toc-number">5.12.</span> <span class="toc-text">【kubernetes】“Buenos Aires”: Kubernetes Pod Crashing</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E6%84%8F-19"><span class="toc-number">5.12.1.</span> <span class="toc-text">题意</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4-19"><span class="toc-number">5.12.2.</span> <span class="toc-text">相关指令</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90haproxy%E3%80%81docker%E3%80%91%E2%80%9CTarifa%E2%80%9D-Between-Two-Seas"><span class="toc-number">5.13.</span> <span class="toc-text">【haproxy、docker】“Tarifa”: Between Two Seas</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E6%84%8F-20"><span class="toc-number">5.13.1.</span> <span class="toc-text">题意</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4-20"><span class="toc-number">5.13.2.</span> <span class="toc-text">相关指令</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E6%8E%A8%E8%8D%90%E3%80%91%E3%80%90sqlite%E3%80%91%E2%80%9CMarrakech%E2%80%9D-Word-Histogram"><span class="toc-number">5.14.</span> <span class="toc-text">【推荐】【sqlite】“Marrakech”: Word Histogram</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E6%84%8F-21"><span class="toc-number">5.14.1.</span> <span class="toc-text">题意</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4-21"><span class="toc-number">5.14.2.</span> <span class="toc-text">相关指令</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90mysql%E3%80%91%E2%80%9CRosario%E2%80%9D-Restore-a-MySQL-database"><span class="toc-number">5.15.</span> <span class="toc-text">【mysql】“Rosario”: Restore a MySQL database</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4-22"><span class="toc-number">5.15.1.</span> <span class="toc-text">相关指令</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90mysql%E3%80%91%E2%80%9CAbaokoro%E2%80%9D-Restore-MySQL-Databases-Spooked-by-a-Ghost"><span class="toc-number">5.16.</span> <span class="toc-text">【mysql】“Abaokoro”: Restore MySQL Databases Spooked by a Ghost</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E6%84%8F-22"><span class="toc-number">5.16.1.</span> <span class="toc-text">题意</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4-23"><span class="toc-number">5.16.2.</span> <span class="toc-text">相关指令</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90k8s%E3%80%81helm%E3%80%91%E2%80%9CPoznan%E2%80%9D-Helm-Chart-Issue-in-Kubernetes"><span class="toc-number">5.17.</span> <span class="toc-text">【k8s、helm】“Poznań”: Helm Chart Issue in Kubernetes</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90linux%E3%80%91%E2%80%9CManado%E2%80%9D-How-much-do-you-press"><span class="toc-number">5.18.</span> <span class="toc-text">【linux】“Manado”: How much do you press?</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E6%84%8F-23"><span class="toc-number">5.18.1.</span> <span class="toc-text">题意</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4-24"><span class="toc-number">5.18.2.</span> <span class="toc-text">相关指令</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90docker%E3%80%81golang%E3%80%91%E2%80%9CWarsaw%E2%80%9D-Prometheus-can%E2%80%99t-scrape-the-webserver"><span class="toc-number">5.19.</span> <span class="toc-text">【docker、golang】“Warsaw”: Prometheus can’t scrape the webserver</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E6%84%8F-24"><span class="toc-number">5.19.1.</span> <span class="toc-text">题意</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4-25"><span class="toc-number">5.19.2.</span> <span class="toc-text">相关指令</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%80%9CMoyogalpa%E2%80%9D-Security-Snag-The-Trials-of-Mary-and-John"><span class="toc-number">5.20.</span> <span class="toc-text">“Moyogalpa”: Security Snag. The Trials of Mary and John</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E6%84%8F-25"><span class="toc-number">5.20.1.</span> <span class="toc-text">题意</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4-26"><span class="toc-number">5.20.2.</span> <span class="toc-text">相关指令</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90postgresql%E3%80%91%E2%80%9CHelsingor%E2%80%9D-The-first-walls-of-postgres-physical-replication"><span class="toc-number">5.21.</span> <span class="toc-text">【postgresql】“Helsingør”: The first walls of postgres physical replication</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E6%84%8F-26"><span class="toc-number">5.21.1.</span> <span class="toc-text">题意</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4-27"><span class="toc-number">5.21.2.</span> <span class="toc-text">相关指令</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90WSGI%E3%80%91%E2%80%9CBekasi%E2%80%9D-Supervisor-is-still-around"><span class="toc-number">5.22.</span> <span class="toc-text">【WSGI】“Bekasi”: Supervisor is still around</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E6%84%8F-27"><span class="toc-number">5.22.1.</span> <span class="toc-text">题意</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4-28"><span class="toc-number">5.22.2.</span> <span class="toc-text">相关指令</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90nginx%E3%80%91%E2%80%9CDepok%E2%80%9D-Nginx-with-Brotli"><span class="toc-number">5.23.</span> <span class="toc-text">【nginx】“Depok”: Nginx with Brotli</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E6%84%8F-28"><span class="toc-number">5.23.1.</span> <span class="toc-text">题意</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4-29"><span class="toc-number">5.23.2.</span> <span class="toc-text">相关指令</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90linux%E3%80%91%E2%80%9CTukaani%E2%80%9D-XZ-LZMA-Library-Compromised"><span class="toc-number">5.24.</span> <span class="toc-text">【linux】“Tukaani”: XZ LZMA Library Compromised</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E6%84%8F-29"><span class="toc-number">5.24.1.</span> <span class="toc-text">题意</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4-30"><span class="toc-number">5.24.2.</span> <span class="toc-text">相关指令</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%B0%E9%9A%BE"><span class="toc-number">6.</span> <span class="toc-text">困难</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90linux%E3%80%91%E2%80%9CJakarta%E2%80%9D-it%E2%80%99s-always-DNS"><span class="toc-number">6.1.</span> <span class="toc-text">【linux】“Jakarta”: it’s always DNS.</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E6%84%8F-30"><span class="toc-number">6.1.1.</span> <span class="toc-text">题意</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4-31"><span class="toc-number">6.1.2.</span> <span class="toc-text">相关指令</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90wordpress%E3%80%81docker%E3%80%91%E2%80%9CBern%E2%80%9D-Docker-web-container-can%E2%80%99t-connect-to-db-container"><span class="toc-number">6.2.</span> <span class="toc-text">【wordpress、docker】“Bern”: Docker web container can’t connect to db container.</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E6%84%8F-31"><span class="toc-number">6.2.1.</span> <span class="toc-text">题意</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4-32"><span class="toc-number">6.2.2.</span> <span class="toc-text">相关指令</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E6%8E%A8%E8%8D%90%E3%80%91%E3%80%90linux%E3%80%91%E2%80%9CKarakorum%E2%80%9D-WTFIT-%E2%80%93-What-The-Fun-Is-This"><span class="toc-number">6.3.</span> <span class="toc-text">【推荐】【linux】“Karakorum”: WTFIT – What The Fun Is This?</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E6%84%8F-32"><span class="toc-number">6.3.1.</span> <span class="toc-text">题意</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4-33"><span class="toc-number">6.3.2.</span> <span class="toc-text">相关指令</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90kubernetes%E3%80%91%E2%80%9CSingara%E2%80%9D-Docker-and-Kubernetes-web-app-not-working"><span class="toc-number">6.4.</span> <span class="toc-text">【kubernetes】“Singara”: Docker and Kubernetes web app not working.</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E6%84%8F-33"><span class="toc-number">6.4.1.</span> <span class="toc-text">题意</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4-34"><span class="toc-number">6.4.2.</span> <span class="toc-text">相关指令</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90postgresql%E3%80%91%E2%80%9CHong-Kong%E2%80%9D-can%E2%80%99t-write-data-into-database"><span class="toc-number">6.5.</span> <span class="toc-text">【postgresql】“Hong-Kong”: can’t write data into database.</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E6%84%8F-34"><span class="toc-number">6.5.1.</span> <span class="toc-text">题意</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4-35"><span class="toc-number">6.5.2.</span> <span class="toc-text">相关指令</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E6%8E%A8%E8%8D%90%E3%80%91%E3%80%90linux%E3%80%91%E2%80%9CPokhara%E2%80%9D-SSH-and-other-sshenanigans"><span class="toc-number">6.6.</span> <span class="toc-text">【推荐】【linux】“Pokhara”: SSH and other sshenanigans</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E6%84%8F-35"><span class="toc-number">6.6.1.</span> <span class="toc-text">题意</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4-36"><span class="toc-number">6.6.2.</span> <span class="toc-text">相关指令</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90linux%E3%80%91%E2%80%9CRoseau%E2%80%9D-Hack-a-Web-Server"><span class="toc-number">6.7.</span> <span class="toc-text">【linux】“Roseau”: Hack a Web Server</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E6%84%8F-36"><span class="toc-number">6.7.1.</span> <span class="toc-text">题意</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4-37"><span class="toc-number">6.7.2.</span> <span class="toc-text">相关指令</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90java%E3%80%81linux%E3%80%91%E2%80%9CBelo-Horizonte%E2%80%9D-A-Java-Enigma"><span class="toc-number">6.8.</span> <span class="toc-text">【java、linux】“Belo-Horizonte”: A Java Enigma</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E6%84%8F-37"><span class="toc-number">6.8.1.</span> <span class="toc-text">题意</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4-38"><span class="toc-number">6.8.2.</span> <span class="toc-text">相关指令</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90rabbitmq%E3%80%81docker%E3%80%91%E2%80%9CChennai%E2%80%9D-Pull-a-Rabbit-from-a-Hat"><span class="toc-number">6.9.</span> <span class="toc-text">【rabbitmq、docker】“Chennai”: Pull a Rabbit from a Hat</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E6%84%8F-38"><span class="toc-number">6.9.1.</span> <span class="toc-text">题意</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4-39"><span class="toc-number">6.9.2.</span> <span class="toc-text">相关指令</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90git%E3%80%81linux%E3%80%91%E2%80%9CMonaco%E2%80%9D-Disappearing-Trick"><span class="toc-number">6.10.</span> <span class="toc-text">【git、linux】“Monaco”: Disappearing Trick</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E6%84%8F-39"><span class="toc-number">6.10.1.</span> <span class="toc-text">题意</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4-40"><span class="toc-number">6.10.2.</span> <span class="toc-text">相关指令</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90docker%E3%80%91%E2%80%9CFlorence%E2%80%9D-Database-Migration-Hell"><span class="toc-number">6.11.</span> <span class="toc-text">【docker】“Florence”: Database Migration Hell</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E6%84%8F-40"><span class="toc-number">6.11.1.</span> <span class="toc-text">题意</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%8C%87%E4%BB%A4-41"><span class="toc-number">6.11.2.</span> <span class="toc-text">相关指令</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">7.</span> <span class="toc-text">总结</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2024/04/25/azkaban-tools/" title="azkaban-tools 项目介绍"><img src="/img/blog_img/azkaban.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="azkaban-tools 项目介绍"/></a><div class="content"><a class="title" href="/2024/04/25/azkaban-tools/" title="azkaban-tools 项目介绍">azkaban-tools 项目介绍</a><time datetime="2024-04-24T16:00:00.000Z" title="发表于 2024-04-25 00:00:00">2024-04-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/01/17/sadserver-intro/" title="make sadservers happy again"><img src="/2024/01/17/sadserver-intro/cover.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="make sadservers happy again"/></a><div class="content"><a class="title" href="/2024/01/17/sadserver-intro/" title="make sadservers happy again">make sadservers happy again</a><time datetime="2024-01-16T16:00:00.000Z" title="发表于 2024-01-17 00:00:00">2024-01-17</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/12/06/program-100-qas/" title="互联网之100问"><img src="/2023/12/06/program-100-qas/cover.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="互联网之100问"/></a><div class="content"><a class="title" href="/2023/12/06/program-100-qas/" title="互联网之100问">互联网之100问</a><time datetime="2023-12-05T16:00:00.000Z" title="发表于 2023-12-06 00:00:00">2023-12-06</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/10/31/emr-mongo-to-hive/" title="mongodb数据同步到hive"><img src="/2023/10/31/emr-mongo-to-hive/mongo.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="mongodb数据同步到hive"/></a><div class="content"><a class="title" href="/2023/10/31/emr-mongo-to-hive/" title="mongodb数据同步到hive">mongodb数据同步到hive</a><time datetime="2023-10-30T16:00:00.000Z" title="发表于 2023-10-31 00:00:00">2023-10-31</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/10/23/golang-origin/" title="go 语言介绍"><img src="/2023/10/23/golang-origin/golang.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="go 语言介绍"/></a><div class="content"><a class="title" href="/2023/10/23/golang-origin/" title="go 语言介绍">go 语言介绍</a><time datetime="2023-10-22T16:00:00.000Z" title="发表于 2023-10-23 00:00:00">2023-10-23</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2021 - 2024 By smiecj</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>function addGitalkSource () {
  const ele = document.createElement('link')
  ele.rel = 'stylesheet'
  ele.href= 'https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css'
  document.getElementsByTagName('head')[0].appendChild(ele)
}

function loadGitalk () {
  function initGitalk () {
    var gitalk = new Gitalk(Object.assign({
      clientID: '40d352b09238233a6c88',
      clientSecret: 'db953d71dbaf0d65873a7ace2e60635fd475285a',
      repo: 'smiecj.github.io',
      owner: 'smiecj',
      admin: ['smiecj'],
      id: '2144fa0d7d99d187890071cb3acd02e8',
      updateCountCallback: commentCount
    },null))

    gitalk.render('gitalk-container')
  }

  if (typeof Gitalk === 'function') initGitalk()
  else {
    addGitalkSource()
    getScript('https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.js').then(initGitalk)
  }
}

function commentCount(n){
  let isCommentCount = document.querySelector('#post-meta .gitalk-comment-count')
  if (isCommentCount) {
    isCommentCount.innerHTML= n
  }
}

if ('Gitalk' === 'Gitalk' || !true) {
  if (true) btf.loadComment(document.getElementById('gitalk-container'), loadGitalk)
  else loadGitalk()
} else {
  function loadOtherComment () {
    loadGitalk()
  }
}</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>